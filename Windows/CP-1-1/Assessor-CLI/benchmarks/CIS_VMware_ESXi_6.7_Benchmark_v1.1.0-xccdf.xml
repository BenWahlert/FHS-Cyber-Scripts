<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_VMware_ESXi_6.7_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
  <xccdf:status date="2020-06-02">draft</xccdf:status>
  <xccdf:title xml:lang="en">CIS VMware ESXi 6.7 Benchmark</xccdf:title>
  <xccdf:description xml:lang="en">
    <xhtml:p>
This document provides prescriptive guidance for establishing a secure configuration posture for VMware ESXi 6.7. To obtain the latest version of this guide, please visit       <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>
. If you have questions, comments, or have identified ways to improve this guide, please write us at feedback@cisecurity.org.    </xhtml:p>
  </xccdf:description>
  <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
  <xccdf:version>1.1.0</xccdf:version>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_L1_-_CorporateEnterprise_Environment_general_use">
    <xccdf:title xml:lang="en">Level 1 (L1) - Corporate/Enterprise Environment (general use)</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>Items in this profile intend to:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>be the starting baseline for most organizations;</xhtml:li>
        <xhtml:li>be practical and prudent;</xhtml:li>
        <xhtml:li>provide a clear security benefit; and</xhtml:li>
        <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
      </xhtml:ul>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Ensure_ESXi_is_properly_patched" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Ensure_the_Image_Profile_VIB_acceptance_level_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Ensure_no_unauthorized_kernel_modules_are_loaded_on_the_host" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Ensure_the_default_value_of_individual_salt_per_vm_is_configured" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Ensure_NTP_time_synchronization_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Ensure_the_ESXi_host_firewall_is_configured_to_restrict_access_to_services_running_on_the_host" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Ensure_Managed_Object_Browser_MOB_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_L1_Ensure_default_self-signed_certificate_for_ESXi_communication_is_not_used" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Ensure_SNMP_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Ensure_dvfilter_API_is_not_configured_if_not_used" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Ensure_expired_and_revoked_SSL_certificates_are_removed_from_the_ESXi_server" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_L1_Ensure_vSphere_Authentication_Proxy_is_used_when_adding_hosts_to_Active_Directory" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_L1_Ensure_VDS_health_check_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Ensure_a_centralized_location_is_configured_to_collect_ESXi_host_core_dumps" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_L1_Ensure_persistent_logging_is_configured_for_all_ESXi_hosts" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_L1_Ensure_remote_logging_is_configured_for_ESXi_hosts" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_L1_Ensure_a_non-root_user_account_exists_for_local_admin_access" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_L1_Ensure_passwords_are_required_to_be_complex" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_L1_Ensure_Active_Directory_is_used_for_local_user_authentication" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_L1_Ensure_only_authorized_users_and_groups_belong_to_the_esxAdminsGroup_group" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Ensure_the_Exception_Users_list_is_properly_configured" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Ensure_account_lockout_is_set_to_15_minutes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Ensure_the_maximum_failed_login_attempts_is_set_to_3" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Ensure_the_DCUI_timeout_is_set_to_600_seconds_or_less" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Ensure_the_ESXi_shell_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_L1_Ensure_SSH_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_L1_Ensure_CIM_access_is_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_L1_Ensure_Lockdown_mode_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_L1_Ensure_idle_ESXi_shell_and_SSH_sessions_time_out_after_300_seconds_or_less" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_L1_Ensure_the_shell_services_timeout_is_set_to_1_hour_or_less" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_L1_Ensure_DCUI_has_a_trusted_users_list_for_lockdown_mode" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_L1_Ensure_bidirectional_CHAP_authentication_for_iSCSI_traffic_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_L1_Ensure_the_uniqueness_of_CHAP_authentication_secrets_for_iSCSI_traffic" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_L1_Ensure_storage_area_network_SAN_resources_are_segregated_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_L1_Ensure_the_vSwitch_Forged_Transmits_policy_is_set_to_reject" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Ensure_the_vSwitch_MAC_Address_Change_policy_is_set_to_reject" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Ensure_the_vSwitch_Promiscuous_Mode_policy_is_set_to_reject" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Ensure_port_groups_are_not_configured_to_the_value_of_the_native_VLAN" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Ensure_port_groups_are_not_configured_to_VLAN_values_reserved_by_upstream_physical_switches" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Ensure_port_groups_are_not_configured_to_VLAN_4095_except_for_Virtual_Guest_Tagging_VGT" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Ensure_Virtual_Disributed_Switch_Netflow_traffic_is_sent_to_an_authorized_collector" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Ensure_port-level_configuration_overrides_are_disabled." selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1.1_L1_Ensure_informational_messages_from_the_VM_to_the_VMX_file_are_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.1_L1_Ensure_unnecessary_floppy_devices_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.3_L1_Ensure_unnecessary_parallel_ports_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.4_L1_Ensure_unnecessary_serial_ports_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.5_L1_Ensure_unnecessary_USB_devices_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.6_L1_Ensure_unauthorized_modification_and_disconnection_of_devices_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.7_L1_Ensure_unauthorized_connection_of_devices_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.8_L1_Ensure_PCI_and_PCIe_device_passthrough_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.1_L1_Ensure_unnecessary_or_superfluous_functions_inside_VMs_are_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.2_L1_Ensure_use_of_the_VM_console_is_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.3_L1_Ensure_secure_protocols_are_used_for_virtual_serial_port_access" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.4_L1_Ensure_templates_are_used_whenever_possible_to_deploy_VMs" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.1_L1_Ensure_access_to_VMs_through_the_dvfilter_network_APIs_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.2_L1_Ensure_VMsafe_Agent_Address_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.3_L1__Ensure_VMsafe_Agent_Port_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.4_L1_Ensure_VMsafe_Agent_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.24_L1_Ensure_VM_Console_Copy_operations_are_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.25_L1_Ensure_VM_Console_Drag_and_Drop_operations_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.26_L1_Ensure_VM_Console_GUI_Options_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.27_L1_Ensure_VM_Console_Paste_operations_are_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.28_L1_Ensure_access_to_VM_console_via_VNC_protocol_is_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.6.2_L1_Ensure_virtual_disk_shrinking_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.6.3_L1_Ensure_virtual_disk_wiping_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7.2_L1_Ensure_the_number_of_VM_log_files_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7.4_L1_Ensure_VM_log_file_size_is_limited" selected="true"/>
  </xccdf:Profile>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_L2_-_High_SecuritySensitive_Data_Environment_limited_functionality">
    <xccdf:title xml:lang="en">Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This profile extends the "Level 1 (L1)" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>are intended for environments or use cases where security is more critical than manageability and usability;</xhtml:li>
        <xhtml:li>may negatively inhibit the utility or performance of the technology; and</xhtml:li>
        <xhtml:li>limit the ability of remote management/access.</xhtml:li>
      </xhtml:ul>
      <xhtml:p>
        <xhtml:strong>Note:</xhtml:strong>
 Implementation of Level 2 requires that         <xhtml:strong>both</xhtml:strong>
 Level 1 and Level 2 settings are applied.      </xhtml:p>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Ensure_ESXi_is_properly_patched" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Ensure_the_Image_Profile_VIB_acceptance_level_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Ensure_no_unauthorized_kernel_modules_are_loaded_on_the_host" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Ensure_the_default_value_of_individual_salt_per_vm_is_configured" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Ensure_NTP_time_synchronization_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Ensure_the_ESXi_host_firewall_is_configured_to_restrict_access_to_services_running_on_the_host" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Ensure_Managed_Object_Browser_MOB_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_L1_Ensure_default_self-signed_certificate_for_ESXi_communication_is_not_used" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Ensure_SNMP_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Ensure_dvfilter_API_is_not_configured_if_not_used" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Ensure_expired_and_revoked_SSL_certificates_are_removed_from_the_ESXi_server" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_L1_Ensure_vSphere_Authentication_Proxy_is_used_when_adding_hosts_to_Active_Directory" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_L1_Ensure_VDS_health_check_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Ensure_a_centralized_location_is_configured_to_collect_ESXi_host_core_dumps" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_L1_Ensure_persistent_logging_is_configured_for_all_ESXi_hosts" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_L1_Ensure_remote_logging_is_configured_for_ESXi_hosts" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_L1_Ensure_a_non-root_user_account_exists_for_local_admin_access" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_L1_Ensure_passwords_are_required_to_be_complex" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_L1_Ensure_Active_Directory_is_used_for_local_user_authentication" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_L1_Ensure_only_authorized_users_and_groups_belong_to_the_esxAdminsGroup_group" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Ensure_the_Exception_Users_list_is_properly_configured" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Ensure_account_lockout_is_set_to_15_minutes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Ensure_the_maximum_failed_login_attempts_is_set_to_3" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Ensure_the_DCUI_timeout_is_set_to_600_seconds_or_less" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_L2_Ensure_DCUI_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Ensure_the_ESXi_shell_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_L1_Ensure_SSH_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_L1_Ensure_CIM_access_is_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_L1_Ensure_Lockdown_mode_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_L2_Ensure_the_SSH_authorized_keys_file_is_empty" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_L1_Ensure_idle_ESXi_shell_and_SSH_sessions_time_out_after_300_seconds_or_less" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_L1_Ensure_the_shell_services_timeout_is_set_to_1_hour_or_less" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_L1_Ensure_DCUI_has_a_trusted_users_list_for_lockdown_mode" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_L2_Ensure_contents_of_exposed_configuration_files_have_not_been_modified" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_L1_Ensure_bidirectional_CHAP_authentication_for_iSCSI_traffic_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_L1_Ensure_the_uniqueness_of_CHAP_authentication_secrets_for_iSCSI_traffic" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_L1_Ensure_storage_area_network_SAN_resources_are_segregated_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.4_L2_Ensure_VMDK_files_are_zeroed_out_prior_to_deletion" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_L1_Ensure_the_vSwitch_Forged_Transmits_policy_is_set_to_reject" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Ensure_the_vSwitch_MAC_Address_Change_policy_is_set_to_reject" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Ensure_the_vSwitch_Promiscuous_Mode_policy_is_set_to_reject" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Ensure_port_groups_are_not_configured_to_the_value_of_the_native_VLAN" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Ensure_port_groups_are_not_configured_to_VLAN_values_reserved_by_upstream_physical_switches" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Ensure_port_groups_are_not_configured_to_VLAN_4095_except_for_Virtual_Guest_Tagging_VGT" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Ensure_Virtual_Disributed_Switch_Netflow_traffic_is_sent_to_an_authorized_collector" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Ensure_port-level_configuration_overrides_are_disabled." selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1.1_L1_Ensure_informational_messages_from_the_VM_to_the_VMX_file_are_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.1.2_L2_Ensure_only_one_remote_console_connection_is_permitted_to_a_VM_at_any_time" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.1_L1_Ensure_unnecessary_floppy_devices_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.2_L2_Ensure_unnecessary_CDDVD_devices_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.3_L1_Ensure_unnecessary_parallel_ports_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.4_L1_Ensure_unnecessary_serial_ports_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.5_L1_Ensure_unnecessary_USB_devices_are_disconnected" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.6_L1_Ensure_unauthorized_modification_and_disconnection_of_devices_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.7_L1_Ensure_unauthorized_connection_of_devices_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.2.8_L1_Ensure_PCI_and_PCIe_device_passthrough_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.1_L1_Ensure_unnecessary_or_superfluous_functions_inside_VMs_are_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.2_L1_Ensure_use_of_the_VM_console_is_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.3_L1_Ensure_secure_protocols_are_used_for_virtual_serial_port_access" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.3.4_L1_Ensure_templates_are_used_whenever_possible_to_deploy_VMs" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.1_L1_Ensure_access_to_VMs_through_the_dvfilter_network_APIs_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.2_L1_Ensure_VMsafe_Agent_Address_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.3_L1__Ensure_VMsafe_Agent_Port_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.4_L1_Ensure_VMsafe_Agent_is_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.5_L2_Ensure_Autologon_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.6_L2_Ensure_BIOS_BBS_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.7_L2_Ensure_Guest_Host_Interaction_Protocol_Handler_is_set_to_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.8_L2_Ensure_Unity_Taskbar_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.9_L2_Ensure_Unity_Active_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.10_L2_Ensure_Unity_Window_Contents_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.11_L2_Ensure_Unity_Push_Update_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.12_L2_Ensure_Drag_and_Drop_Version_Get_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.13_L2_Ensure_Drag_and_Drop_Version_Set_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.14_L2_Ensure_Shell_Action_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.15_L2_Ensure_Request_Disk_Topology_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.16_L2_Ensure_Trash_Folder_State_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.17_L2_Ensure_Guest_Host_Interaction_Tray_Icon_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.18_L2_Ensure_Unity_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.19_L2_Ensure_Unity_Interlock_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.20_L2_Ensure_GetCreds_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.21_L2_Ensure_Host_Guest_File_System_Server_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.22_L2_Ensure_Guest_Host_Interaction_Launch_Menu_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.23_L2_Ensure_memSchedFakeSampleStats_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.24_L1_Ensure_VM_Console_Copy_operations_are_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.25_L1_Ensure_VM_Console_Drag_and_Drop_operations_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.26_L1_Ensure_VM_Console_GUI_Options_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.27_L1_Ensure_VM_Console_Paste_operations_are_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.28_L1_Ensure_access_to_VM_console_via_VNC_protocol_is_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.4.29_L2_Ensure_all_but_VGA_mode_on_virtual_machines_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.5.1_L2_Ensure_VM_limits_are_configured_correctly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.5.2_L2_Ensure_hardware-based_3D_acceleration_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.6.1_L2_Ensure_nonpersistent_disks_are_limited" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.6.2_L1_Ensure_virtual_disk_shrinking_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.6.3_L1_Ensure_virtual_disk_wiping_is_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7.1_L2_Ensure_VIX_messages_from_the_VM_are_disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7.2_L1_Ensure_the_number_of_VM_log_files_is_configured_properly" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7.3_L2_Ensure_host_information_is_not_sent_to_guests" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_8.7.4_L1_Ensure_VM_log_file_size_is_limited" selected="true"/>
  </xccdf:Profile>
  <Value abstract="false" hidden="false" id="xccdf_org.cisecurity.benchmarks_value_esxi.connection" interactive="1" prohibitChanges="false" type="string">
    <title override="0">ESXi connection string</title>
    <description override="0">This value allows for user-supplied connection strings</description>
    <value selector=""/>
    <default>root/password@192.168.41.60</default>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811989_var" operator="equals" type="string">
    <title>(L1) Ensure no unauthorized kernel modules are loaded on the host</title>
    <description>This value is used in Rule: (L1) Ensure no unauthorized kernel modules are loaded on the host</description>
    <value>VMware Signed</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1031670_var" operator="equals" type="number">
    <title>(L1) Ensure the default value of individual salt per vm is configured</title>
    <description>This value is used in Rule: (L1) Ensure the default value of individual salt per vm is configured</description>
    <value>2</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_874398_var" operator="equals" type="boolean">
    <title>(L1) Ensure Managed Object Browser (MOB) is disabled</title>
    <description>This value is used in Rule: (L1) Ensure Managed Object Browser (MOB) is disabled</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811994_var" operator="pattern match" type="string">
    <title>(L1) Ensure dvfilter API is not configured if not used</title>
    <description>This value is used in Rule: (L1) Ensure dvfilter API is not configured if not used</description>
    <value>^$</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811996_var" operator="equals" type="string">
    <title>(L1) Ensure persistent logging is configured for all ESXi hosts</title>
    <description>This value is used in Rule: (L1) Ensure persistent logging is configured for all ESXi hosts</description>
    <value>scratch</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811997_var" operator="pattern match" type="string">
    <title>(L1) Ensure remote logging is configured for ESXi hosts</title>
    <description>This value is used in Rule: (L1) Ensure remote logging is configured for ESXi hosts</description>
    <value>.</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1031671_var" operator="equals" type="number">
    <title>(L1) Ensure account lockout is set to 15 minutes</title>
    <description>This value is used in Rule: (L1) Ensure account lockout is set to 15 minutes</description>
    <value>900</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1031672_var" operator="equals" type="number">
    <title>(L1) Ensure the maximum failed login attempts is set to 3</title>
    <description>This value is used in Rule: (L1) Ensure the maximum failed login attempts is set to 3</description>
    <value>3</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1031673_var" operator="less than or equal" type="number">
    <title>(L1) Ensure the DCUI timeout is set to 600 seconds or less</title>
    <description>This value is used in Rule: (L1) Ensure the DCUI timeout is set to 600 seconds or less</description>
    <value>600</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_812006_var" operator="equals" type="number">
    <title>(L1) Ensure idle ESXi shell and SSH sessions time out after 300 seconds or less</title>
    <description>This value is used in Rule: (L1) Ensure idle ESXi shell and SSH sessions time out after 300 seconds or less</description>
    <value>300</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_812007_var" operator="equals" type="number">
    <title>(L1) Ensure the shell services timeout is set to 1 hour or less</title>
    <description>This value is used in Rule: (L1) Ensure the shell services timeout is set to 1 hour or less</description>
    <value>3600</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1032120_var" operator="pattern match" type="string">
    <title>(L1) Ensure DCUI has a trusted users list for lockdown mode</title>
    <description>This value is used in Rule: (L1) Ensure DCUI has a trusted users list for lockdown mode</description>
    <value>.*</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811990_var" operator="pattern match" type="string">
    <title>(L1) Ensure NTP time synchronization is configured properly</title>
    <description>This value is used in Rule: (L1) Ensure NTP time synchronization is configured properly</description>
    <value>.</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811991_var" operator="equals" type="boolean">
    <title>(L1) Ensure the ESXi host firewall is configured to restrict access to services running on the host</title>
    <description>This value is used in Rule: (L1) Ensure the ESXi host firewall is configured to restrict access to services running on the host</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811993_var" operator="equals" type="boolean">
    <title>(L1) Ensure default self-signed certificate for ESXi communication is not used</title>
    <description>This value is used in Rule: (L1) Ensure default self-signed certificate for ESXi communication is not used</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1033292_var" operator="equals" type="string">
    <title>(L1) Ensure vSphere Authentication Proxy is used when adding hosts to Active Directory</title>
    <description>This value is used in Rule: (L1) Ensure vSphere Authentication Proxy is used when adding hosts to Active Directory</description>
    <value>Ok</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_812001_var" operator="equals" type="string">
    <title>(L1) Ensure Active Directory is used for local user authentication</title>
    <description>This value is used in Rule: (L1) Ensure Active Directory is used for local user authentication</description>
    <value>Ok</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_811995_var" operator="pattern match" type="string">
    <title>(L1) Ensure a centralized location is configured to collect ESXi host core dumps</title>
    <description>This value is used in Rule: (L1) Ensure a centralized location is configured to collect ESXi host core dumps</description>
    <value>.</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_812005_var" operator="equals" type="boolean">
    <title>(L1) Ensure Lockdown mode is enabled</title>
    <description>This value is used in Rule: (L1) Ensure Lockdown mode is enabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_812008_var" operator="equals" type="boolean">
    <title>(L1) Ensure bidirectional CHAP authentication for iSCSI traffic is enabled</title>
    <description>This value is used in Rule: (L1) Ensure bidirectional CHAP authentication for iSCSI traffic is enabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813403_var" operator="less than or equal" type="number">
    <title>(L1) Ensure informational messages from the VM to the VMX file are limited</title>
    <description>This value is used in Rule: (L1) Ensure informational messages from the VM to the VMX file are limited</description>
    <value>1048576</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813404_var" operator="equals" type="number">
    <title>(L2) Ensure only one remote console connection is permitted to a VM at any time</title>
    <description>This value is used in Rule: (L2) Ensure only one remote console connection is permitted to a VM at any time</description>
    <value>1</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813408_var" operator="equals" type="boolean">
    <title>(L1) Ensure unauthorized modification and disconnection of devices is disabled</title>
    <description>This value is used in Rule: (L1) Ensure unauthorized modification and disconnection of devices is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813409_var" operator="equals" type="boolean">
    <title>(L1) Ensure unauthorized connection of devices is disabled</title>
    <description>This value is used in Rule: (L1) Ensure unauthorized connection of devices is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1033295_var" operator="equals" type="boolean">
    <title>(L1) Ensure PCI and PCIe device passthrough is disabled</title>
    <description>This value is used in Rule: (L1) Ensure PCI and PCIe device passthrough is disabled</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_555573_var" operator="equals" type="boolean">
    <title>(L1) Ensure VMsafe Agent is configured correctly</title>
    <description>This value is used in Rule: (L1) Ensure VMsafe Agent is configured correctly</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813410_var" operator="equals" type="boolean">
    <title>(L2) Ensure Autologon is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Autologon is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813413_var" operator="equals" type="boolean">
    <title>(L2) Ensure BIOS BBS is disabled</title>
    <description>This value is used in Rule: (L2) Ensure BIOS BBS is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813416_var" operator="equals" type="boolean">
    <title>(L2) Ensure Guest Host Interaction Protocol Handler is set to disabled</title>
    <description>This value is used in Rule: (L2) Ensure Guest Host Interaction Protocol Handler is set to disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813417_var" operator="equals" type="boolean">
    <title>(L2) Ensure Unity Taskbar is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Unity Taskbar is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813418_var" operator="equals" type="boolean">
    <title>(L2) Ensure Unity Active is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Unity Active is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813419_var" operator="equals" type="boolean">
    <title>(L2) Ensure Unity Window Contents is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Unity Window Contents is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813420_var" operator="equals" type="boolean">
    <title>(L2) Ensure Unity Push Update is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Unity Push Update is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813421_var" operator="equals" type="boolean">
    <title>(L2) Ensure Drag and Drop Version Get is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Drag and Drop Version Get is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813422_var" operator="equals" type="boolean">
    <title>(L2) Ensure Drag and Drop Version Set is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Drag and Drop Version Set is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813423_var" operator="equals" type="boolean">
    <title>(L2) Ensure Shell Action is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Shell Action is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813424_var" operator="equals" type="boolean">
    <title>(L2) Ensure Request Disk Topology is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Request Disk Topology is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813425_var" operator="equals" type="boolean">
    <title>(L2) Ensure Trash Folder State is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Trash Folder State is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813426_var" operator="equals" type="boolean">
    <title>(L2) Ensure Guest Host Interaction Tray Icon is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Guest Host Interaction Tray Icon is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813427_var" operator="equals" type="boolean">
    <title>(L2) Ensure Unity is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Unity is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816959_var" operator="equals" type="boolean">
    <title>(L2) Ensure Unity Interlock is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Unity Interlock is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816960_var" operator="equals" type="boolean">
    <title>(L2) Ensure GetCreds is disabled</title>
    <description>This value is used in Rule: (L2) Ensure GetCreds is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816961_var" operator="equals" type="boolean">
    <title>(L2) Ensure Host Guest File System Server is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Host Guest File System Server is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816962_var" operator="equals" type="boolean">
    <title>(L2) Ensure Guest Host Interaction Launch Menu is disabled</title>
    <description>This value is used in Rule: (L2) Ensure Guest Host Interaction Launch Menu is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816963_var" operator="equals" type="boolean">
    <title>(L2) Ensure memSchedFakeSampleStats is disabled</title>
    <description>This value is used in Rule: (L2) Ensure memSchedFakeSampleStats is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816964_var" operator="equals" type="boolean">
    <title>(L1) Ensure VM Console Copy operations are disabled</title>
    <description>This value is used in Rule: (L1) Ensure VM Console Copy operations are disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816965_var" operator="equals" type="boolean">
    <title>(L1) Ensure VM Console Drag and Drop operations is disabled</title>
    <description>This value is used in Rule: (L1) Ensure VM Console Drag and Drop operations is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_555574_var" operator="equals" type="boolean">
    <title>(L1) Ensure VM Console GUI Options is disabled</title>
    <description>This value is used in Rule: (L1) Ensure VM Console GUI Options is disabled</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816966_var" operator="equals" type="boolean">
    <title>(L1) Ensure VM Console Paste operations are disabled</title>
    <description>This value is used in Rule: (L1) Ensure VM Console Paste operations are disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816967_var" operator="equals" type="boolean">
    <title>(L1) Ensure access to VM console via VNC protocol is limited</title>
    <description>This value is used in Rule: (L1) Ensure access to VM console via VNC protocol is limited</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1033296_var" operator="equals" type="boolean">
    <title>(L2) Ensure hardware-based 3D acceleration is disabled</title>
    <description>This value is used in Rule: (L2) Ensure hardware-based 3D acceleration is disabled</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816970_var" operator="equals" type="boolean">
    <title>(L1) Ensure virtual disk shrinking is disabled</title>
    <description>This value is used in Rule: (L1) Ensure virtual disk shrinking is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816971_var" operator="equals" type="boolean">
    <title>(L1) Ensure virtual disk wiping is disabled</title>
    <description>This value is used in Rule: (L1) Ensure virtual disk wiping is disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816972_var" operator="equals" type="boolean">
    <title>(L2) Ensure VIX messages from the VM are disabled</title>
    <description>This value is used in Rule: (L2) Ensure VIX messages from the VM are disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_555575_var" operator="less than or equal" type="number">
    <title>(L1) Ensure the number of VM log files is configured properly</title>
    <description>This value is used in Rule: (L1) Ensure the number of VM log files is configured properly</description>
    <value>10</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816973_var" operator="equals" type="boolean">
    <title>(L2) Ensure host information is not sent to guests</title>
    <description>This value is used in Rule: (L2) Ensure host information is not sent to guests</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816974_var" operator="equals" type="number">
    <title>(L1) Ensure VM log file size is limited</title>
    <description>This value is used in Rule: (L1) Ensure VM log file size is limited</description>
    <value>1024000</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813405_var" operator="equals" type="number">
    <title>(L1) Ensure unnecessary floppy devices are disconnected</title>
    <description>This value is used in Rule: (L1) Ensure unnecessary floppy devices are disconnected</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813406_var" operator="equals" type="number">
    <title>(L2) Ensure unnecessary CD/DVD devices are disconnected</title>
    <description>This value is used in Rule: (L2) Ensure unnecessary CD/DVD devices are disconnected</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_555571_var" operator="equals" type="number">
    <title>(L1) Ensure unnecessary parallel ports are disconnected</title>
    <description>This value is used in Rule: (L1) Ensure unnecessary parallel ports are disconnected</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_555572_var" operator="equals" type="number">
    <title>(L1) Ensure unnecessary serial ports are disconnected</title>
    <description>This value is used in Rule: (L1) Ensure unnecessary serial ports are disconnected</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_813407_var" operator="equals" type="number">
    <title>(L1) Ensure unnecessary USB devices are disconnected</title>
    <description>This value is used in Rule: (L1) Ensure unnecessary USB devices are disconnected</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816968_var" operator="not equal" type="string">
    <title>(L2) Ensure nonpersistent disks are limited</title>
    <description>This value is used in Rule: (L2) Ensure nonpersistent disks are limited</description>
    <value>NonPersistent</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_816969_var" operator="not equal" type="string">
    <title>(L2) Ensure nonpersistent disks are limited</title>
    <description>This value is used in Rule: (L2) Ensure nonpersistent disks are limited</description>
    <value>IndependentNonPersistent</value>
  </Value>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Install">
    <xccdf:title xml:lang="en">Install</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations for base ESXi install.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Ensure_ESXi_is_properly_patched" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure ESXi is properly patched</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>VMware Update Manager is a tool used to automate patch management for vSphere hosts and virtual machines. Creating a baseline for patches is a good way to ensure all hosts are at the same patch level. VMware also publishes advisories on security patches and offers a way to subscribe to email alerts for them.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>By staying up to date on ESXi patches, vulnerabilities in the hypervisor can be mitigated. An educated attacker can exploit known vulnerabilities when attempting to attain access or elevate privileges on an ESXi host.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.update_manager.doc/GUID-EF6BEE4C-4583-4A8C-81B9-5B074CA2E272.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Employ a process to keep ESXi hosts up to date with patches in accordance with industry standards and internal guidelines. Leverage the VMware Update Manager to test and apply patches as they become available.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>ESXi servers must be in Maintenance Mode to apply patches. This implies all VMs must be moved or powered off on the ESXi server, so the patching process may necessitate having brief outages.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Ensure_the_Image_Profile_VIB_acceptance_level_is_configured_properly" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the Image Profile VIB acceptance level is configured properly</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>A VIB (vSphere Installation Bundle) is a collection of files that are packaged into an archive. The VIB contains a signature file that is used to verify the level of trust. The ESXi Image Profile supports four VIB acceptance levels:</xhtml:p>
        <xhtml:ol>
          <xhtml:li>VMware Certified - VIBs created, tested, and signed by VMware</xhtml:li>
          <xhtml:li>VMware Accepted - VIBs created by a VMware partner but tested and signed by VMware</xhtml:li>
          <xhtml:li>Partner Supported - VIBs created, tested, and signed by a certified VMware partner</xhtml:li>
          <xhtml:li>Community Supported - VIBs that have not been tested by VMware or a VMware partner</xhtml:li>
        </xhtml:ol>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>The ESXi Image Profile should only allow signed VIBs because an unsigned VIB represents untested code installed on an ESXi host. Also, use of unsigned VIBs will cause hypervisor Secure Boot to fail to configure. Community Supported VIBs do not have digital signatures. To protect the security and integrity of your ESXi hosts, do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command (in the example code, the level is Partner Supported):</xhtml:p>
            <xhtml:code class="code_block">
# Set the Software AcceptanceLevel for each host&lt;span&gt;              <br/>
Foreach ($VMHost in Get-VMHost ) {              <br/>
 $ESXCli = Get-EsxCli -VMHost $VMHost              <br/>
 $ESXCli.software.acceptance.Set("PartnerSupported")              <br/>
}
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811408"/>
        </check>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811409"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Ensure_no_unauthorized_kernel_modules_are_loaded_on_the_host" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure no unauthorized kernel modules are loaded on the host</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>ESXi hosts by default do not permit the loading of kernel modules that lack valid digital signatures. This feature can be overridden, which would allow unauthorized kernel modules to be loaded.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>VMware provides digital signatures for kernel modules. Untested or malicious kernel modules loaded on the ESXi host can put the host at risk for instability and/or exploitation.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60-DEE2AE1A405A.html</xccdf:ident>
      <xccdf:ident system="URL">http://kb.vmware.com/kb/2042473</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Secure the host by disabling unsigned modules and removing the offending VIBs from the host.</xhtml:p>
            <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# To disable a module:              <br/>
$ESXCli = Get-EsxCli -VMHost "MyHostName_or_IPaddress"              <br/>
$ESXCli.system.module.set($false, $false, "MyModuleName")
            </xhtml:code>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 evacuate VMs and place the host into maintenance mode before disabling kernel modules.            </xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811989" value-id="xccdf_org.cisecurity.benchmarks_value_811989_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811989"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Ensure_the_default_value_of_individual_salt_per_vm_is_configured" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the default value of individual salt per vm is configured</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The concept of salting has been introduced to help address concerns system administrators may have over the security implications of TPS.  As per the original TPS implementation, multiple virtual machines could share pages when the contents of the pages were same. With the new salting settings, the virtual machines can share pages only if the salt value and contents of the pages are identical. A new host config option Mem.ShareForceSalting is introduced to enable or disable salting.</xhtml:p>
        <xhtml:p>By default, salting is enabled (Mem.ShareForceSalting=2) and each virtual machine has a different salt. This means page sharing does not occur across the virtual machines (inter-VM TPS) and only happens inside a virtual machine (intra VM).</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Intra-VM means that TPS will de-duplicate identical pages of memory within a virtual machine, but will not share the pages with any other virtual machines.  Ensuring the default setting is in place so that page sharing only occurs inside a virtual machine is the best option here.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://kb.vmware.com/s/article/2097593</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>From vSphere Web Client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select a host</xhtml:li>
              <xhtml:li>Click "Configure" -&gt; "Settings" -&gt; "System" -&gt; "Advanced System settings"</xhtml:li>
              <xhtml:li>Filter for Mem.ShareForceSalting.</xhtml:li>
              <xhtml:li>Click edit</xhtml:li>
              <xhtml:li>Set it to 2.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Additionally, the following PowerCLI command can be used:</xhtml:p>
            <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting | Set-AdvancedSetting -Value 2
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1031670" value-id="xccdf_org.cisecurity.benchmarks_value_1031670_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1031670"/>
      </check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Communication">
    <xccdf:title xml:lang="en">Communication</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations related to ESXi communication.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Ensure_NTP_time_synchronization_is_configured_properly" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure NTP time synchronization is configured properly</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Network Time Protocol (NTP) synchronization should be configured correctly and enabled on each VMware ESXi host to ensure accurate time for system event logs. The time sources used by the ESXi hosts should be in sync with an agreed-upon time standard such as Coordinated Universal Time (UTC). There should be at minimum two NTP sources in place, and they should sync whenever possible.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:strong>Notes:</xhtml:strong>
 verify the NTP firewall ports are open. It is recommended to synchronize the ESXi clock with a time server that is located on the management network rather than directly with a time server on a public network. This time server can then synchronize with a public source through a strictly controlled network connection with a firewall.          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard, it is simpler to track and correlate an intruder's actions when reviewing the relevant log files. Incorrect time settings can also make auditing inaccurate.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79-B9FC-A6CECA52F6CC.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To enable and properly configure NTP synchronization, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host.</xhtml:li>
              <xhtml:li>Click "Configure" -&gt; "System" -&gt; "Time Configuration".</xhtml:li>
              <xhtml:li>Click the "Edit..." button.</xhtml:li>
              <xhtml:li>Click on "Use Network Time Protocol".</xhtml:li>
              <xhtml:li>Provide the names or IP addresses of your NTP servers. Separate servers with commas.</xhtml:li>
              <xhtml:li>If the NTP Service Status is "Stopped", click on "Start".</xhtml:li>
              <xhtml:li>Change the startup policy to "Start and stop with host".</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set the NTP Settings for all hosts              <br/>
# If an internal NTP server is used, replace pool.ntp.org with               <br/>
# the IP address or the Fully Qualified Domain Name (FQDN) of the internal NTP server              <br/>
$NTPServers = "pool.ntp.org", "pool2.ntp.org"              <br/>
Get-VMHost | Add-VmHostNtpServer $NTPServers
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811990" value-id="xccdf_org.cisecurity.benchmarks_value_811990_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811990"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Ensure_the_ESXi_host_firewall_is_configured_to_restrict_access_to_services_running_on_the_host" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the ESXi host firewall is configured to restrict access to services running on the host</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The ESXi firewall is enabled by default and allows ping (ICMP) and communication with DHCP/DNS clients. Access to services should only be allowed by authorized IP addresses/networks.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access. Reduce the risk by configuring the ESXi firewall to only allow access from authorized IP addresses and networks.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-8912DD42-C6EA-4299-9B10-5F3AEA52C605.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To properly restrict access to services running on an ESXi host, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host.</xhtml:li>
              <xhtml:li>Go to "Configure" -&gt; "System" -&gt; "Security Profile".</xhtml:li>
              <xhtml:li>In the "Firewall" section, select "Edit...".</xhtml:li>
              <xhtml:li>For each enabled service, (e.g., ssh, vSphere Web Access, http client) provide the range of allowed IP addresses.</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811991" value-id="xccdf_org.cisecurity.benchmarks_value_811991_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811991"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Ensure_Managed_Object_Browser_MOB_is_disabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure Managed Object Browser (MOB) is disabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The Managed Object Browser (MOB) is a web-based server application that lets you examine objects that exist on the server side, explore the object model used by the VM kernel to manage the host, and change configurations. It is installed and started automatically when vCenter is installed.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>Some third-party tools use the MOB to gather information. Use the following command to re-enable the MOB temporarily for third-party tool usage:</xhtml:p>
          <xhtml:code class="code_block">vim-cmd proxysvc/add_np_service "/mob" httpsWithRedirect /var/run/vmware/proxy-mob 
</xhtml:code>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>The MOB is meant to be used primarily for debugging the vSphere SDK. Because there are no access controls, the MOB could also be used as a method to obtain information about a host being targeted for unauthorized access.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B-B697-04BDC9173EA3.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To disable the MOB, run the following ESXi shell command:</xhtml:p>
            <xhtml:code class="code_block">vim-cmd proxysvc/remove_service "/mob" "httpsWithRedirect"
</xhtml:code>
            <xhtml:p>Additionally, the following PowerCLI command may be used:</xhtml:p>
            <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob |Set-AdvancedSetting -value "false"
</xhtml:code>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 You cannot disable the MOB while a host is in lockdown mode.            </xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:874398" value-id="xccdf_org.cisecurity.benchmarks_value_874398_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:874398"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4_L1_Ensure_default_self-signed_certificate_for_ESXi_communication_is_not_used" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure default self-signed certificate for ESXi communication is not used</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The default certificate is self-signed, not signed by a trusted certificate authority (CA). It should be replaced with a valid certificate issued by a trusted CA.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Using the default self-signed certificate may increase risk related to man-in-the-middle (MITM) attacks.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://kb.vmware.com/s/article/2111219</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A-463031BA5FE7.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Backup and replace the details of the SSL certificate presented by the ESXi host and determine if it is issued by a trusted CA:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Log in to the ESXi Shell, either directly from the DCUI or from an SSH client, as a user with administrator privileges.</xhtml:li>
              <xhtml:li>In the directory /etc/vmware/ssl, rename the existing certificates using the following commands:</xhtml:li>
            </xhtml:ol>
            <xhtml:code class="code_block">
mv rui.crt orig.rui.crt              <br/>
mv rui.key orig.rui.key
            </xhtml:code>
            <xhtml:ol start="3">
              <xhtml:li>Copy the certificates you want to use to /etc/vmware/ssl.</xhtml:li>
              <xhtml:li>Rename the new certificate and key to rui.crt and rui.key.</xhtml:li>
              <xhtml:li>Restart the host after you install the new certificate.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternatively, you can put the host into maintenance mode, install the new certificate, use the Direct Console User Interface (DCUI) to restart the management agents, and set the host to exit maintenance mode.</xhtml:p>
            <xhtml:code class="code_block">Leverage VMware's SSL Certificate Automation Tool to install CA-signed SSL certificates. For more information on this tool, please see [http://kb.vmware.com/kb/2057340](http://kb.vmware.com/kb/2057340).
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Replacing the default certificate might cause vCenter Server to stop managing the host. Disconnect and reconnect the host if vCenter Server cannot verify the new certificate.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811993" value-id="xccdf_org.cisecurity.benchmarks_value_811993_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811993"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Ensure_SNMP_is_configured_properly" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure SNMP is configured properly</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Simple Network Management Protocol (SNMP) can be used to help manage hosts. Many organizations have other means in place of managing hosts and do not need SNMP enabled. If SNMP is needed, it should be configured properly to reduce the risk of misuse or compromise. For example, ESXi supports SNMPv3, which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption. It is also important to configure the destination for SNMP traps.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If SNMP is not properly configured, monitoring data containing sensitive information can be sent to a malicious host and used to help exploit the host.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74-B1AA-4A9D18AB6250.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To correct the SNMP configuration, perform the following from the ESXi Shell or vCLI:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>If SNMP is not needed, disable it by running:</xhtml:li>
            </xhtml:ol>
            <xhtml:code class="code_block">esxcli system snmp set --enable false
</xhtml:code>
            <xhtml:ol start="2">
              <xhtml:li>If SNMP is needed, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to configure it.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Additionally, the following PowerCLI command may be used to implement the configuration:</xhtml:p>
            <xhtml:code class="code_block">
# Update the host SNMP Configuration (single host connection required)              <br/>
Get-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity '&lt;secret&gt;'
            </xhtml:code>
            <xhtml:p>
              <xhtml:strong>Notes:</xhtml:strong>
            </xhtml:p>
            <xhtml:ul>
              <xhtml:li>SNMP must be configured on each ESXi host</xhtml:li>
              <xhtml:li>SNMP settings can be configured using Host Profiles</xhtml:li>
            </xhtml:ul>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Ensure_dvfilter_API_is_not_configured_if_not_used" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure dvfilter API is not configured if not used</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The dvfilter network API is used by some products (e.g., VMSafe). If it is not in use, it should not be configured to send network information to a VM.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If the dvfilter network API is enabled in the future and it is already configured, an attacker might attempt to connect a VM to it, thereby potentially providing access to the network of other VMs on the host.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821-ED17A77B0206.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To remove the configuration for the dvfilter network API, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host and click "Configure" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>
Enter                 <xhtml:span class="inline_block">Net.DVFilterBindIpAddress</xhtml:span>
 in the filter.              </xhtml:li>
              <xhtml:li>
Set                 <xhtml:span class="inline_block">Net.DVFilterBindIpAddress</xhtml:span>
 to an empty value.              </xhtml:li>
              <xhtml:li>If an appliance is being used, make sure the value of this parameter is set to the proper IP address.</xhtml:li>
              <xhtml:li>Make sure the attribute is highlighted, then click the pencil icon.</xhtml:li>
              <xhtml:li>Enter the proper IP address.</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set Net.DVFilterBindIpAddress to null on all hosts              <br/>
Get-VMHost HOST1 | Foreach { Set-AdvancedSetting -VMHost $_ -Name Net.DVFilterBindIpAddress -IPValue "" }
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>This will prevent a dvfilter-based network security appliance such as a firewall from functioning if not configured correctly.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811994" value-id="xccdf_org.cisecurity.benchmarks_value_811994_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811994"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Ensure_expired_and_revoked_SSL_certificates_are_removed_from_the_ESXi_server" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure expired and revoked SSL certificates are removed from the ESXi server</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>By default, ESXi hosts do not have Certificate Revocation List (CRL) checking available, so expired and revoked SSL certificates must be checked and removed manually.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Leaving expired and revoked certificates on your vCenter Server system can compromise your environment. Replacing certificates will avoid having users get used to clicking through browser warnings. The warning might be an indication of a man-in-the-middle attack, and only inspection of the certificate and thumbprint can guard against such attacks.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A-463031BA5FE7.html</xccdf:ident>
      <xccdf:ident system="URL">http://en-us.sysadmins.lv/Lists/Posts/Post.aspx?List=332991f0-bfed-4143-9eea-f521167d287c&amp;ID=60</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Replace expired and revoked certificates with certificates from a trusted CA. Certificates can be replaced in a number of ways:</xhtml:p>
            <xhtml:p>
              <xhtml:strong>Replace a Default ESXi Certificate and Key from the ESXi Shell</xhtml:strong>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Log in to the ESXi Shell, either directly from the DCUI or from an SSH client, as a user with administrator privileges.</xhtml:li>
              <xhtml:li>In the directory /etc/vmware/ssl, rename the existing certificates using the following commands:</xhtml:li>
            </xhtml:ol>
            <xhtml:code class="code_block">
mv rui.crt orig.rui.crt                   <br/>
mv rui.key orig.rui.key 
            </xhtml:code>
            <xhtml:ol start="3">
              <xhtml:li>Copy the certificates that you want to use to /etc/vmware/ssl.</xhtml:li>
              <xhtml:li>Rename the new certificate and key to rui.crt and rui.key.</xhtml:li>
              <xhtml:li>Restart the host after you install the new certificate.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternatively, you can put the host into maintenance mode, install the new certificate, use the Direct Console User Interface (DCUI) to restart the management agents, and set the host to exit maintenance mode.</xhtml:p>
            <xhtml:p>
              <xhtml:strong>Replace a Default ESI Certificate and Key by Using the vifs Command</xhtml:strong>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Back up the existing certificates.</xhtml:li>
              <xhtml:li>Generate a certificate request following the instructions from the certificate authority.</xhtml:li>
              <xhtml:li>At the command line, use the vifs command to upload the certificate to the appropriate location on the host.</xhtml:li>
            </xhtml:ol>
            <xhtml:code class="code_block">
vifs --server hostname --username username --put rui.crt /host/ssl_cert              <br/>
vifs --server hostname --username username --put rui.key /host/ssl_key
            </xhtml:code>
            <xhtml:ol start="4">
              <xhtml:li>Restart the host.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternatively, you can put the host into maintenance mode, install the new certificate, and then use the Direct Console User Interface (DCUI) to restart the management agents.</xhtml:p>
            <xhtml:p>
              <xhtml:strong>Replace A Default ESI Certificate and Key Using HTTP PUT</xhtml:strong>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Back up the existing certificates.</xhtml:li>
              <xhtml:li>In your upload application, process each file as follows:</xhtml:li>
              <xhtml:li>Open the file.</xhtml:li>
              <xhtml:li>Publish the file to one of these locations:</xhtml:li>
            </xhtml:ol>
            <xhtml:code class="code_block">
Certificates   https://hostname/host/ssl_cert              <br/>
Keys   https://hostname/host/ssl_key     
            </xhtml:code>
            <xhtml:ol start="3">
              <xhtml:li>The locations /host/ssl_cert and host/ssl_key link to the certificate files in /etc/vmware/ssl.</xhtml:li>
              <xhtml:li>Restart the host.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8_L1_Ensure_vSphere_Authentication_Proxy_is_used_when_adding_hosts_to_Active_Directory" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure vSphere Authentication Proxy is used when adding hosts to Active Directory</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>vSphere Authentication Proxy enables ESXi hosts to join a domain without using Active Directory credentials. vSphere Authentication Proxy enhances security for PXE-booted hosts and hosts that are provisioned using Auto Deploy and Host profiles, by removing the need to store Active Directory credentials in the host configuration.</xhtml:p>
        <xhtml:p>The vSphere Authentication Proxy service binds to an IPv4 address for communication with vCenter Server, and does not support IPv6. The vCenter Server can be on a host machine in an IPv4-only, IPv4/IPv6 mixed-mode, or IPv6-only network environment, but the machine that connects to the vCenter Server through the vSphere Client must have an IPv4 address for the vSphere Authentication Proxy service to work.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>You can install vSphere Authentication Proxy on the same machine as the associated vCenter Server, or on a different machine that has network connection to the vCenter Server. The vSphere Authentication Proxy is not supported with vCenter Server versions earlier than version 5.0.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If you configure your host to join an Active Directory domain using Host Profiles the Active Directory credentials are saved in the host profile and are transmitted over the network.  To avoid having to save Active Directory credentials in the Host Profile and to avoid transmitting Active Directory credentials over the network  use the vSphere Authentication Proxy.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-084B74BD-40A5-4A4B-A82C-0C9912D580DC.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To properly set the vSphere Authentication Proxy from Web Client directly:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host</xhtml:li>
              <xhtml:li>Click on "Configure" -&gt; "Settings" -&gt; "Authentication Services"</xhtml:li>
              <xhtml:li>Click on "Join Domain"</xhtml:li>
              <xhtml:li>Select "Using Proxy Server" radio button.</xhtml:li>
              <xhtml:li>Provide proxy server IP address.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>To properly set the vSphere Authentication Proxy via Host Profiles:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Install and configure the Authentication proxy</xhtml:li>
              <xhtml:li>From the vSphere web client, navigate to "Host Profiles"</xhtml:li>
              <xhtml:li>Select the host profile</xhtml:li>
              <xhtml:li>Select "Configure" -&gt; "Edit Host profile"</xhtml:li>
              <xhtml:li>Expand "Security and Services" -&gt; "Security Settings" -&gt; "Authentication Configuration"</xhtml:li>
              <xhtml:li>Select "Active Directory configuration"</xhtml:li>
              <xhtml:li>Set the "Join Domain Method" to "Use vSphere Authentication Proxy to add the host do domain"</xhtml:li>
              <xhtml:li>Provide the IP address of the authentication proxy</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1033292" value-id="xccdf_org.cisecurity.benchmarks_value_1033292_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1033292"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.9_L1_Ensure_VDS_health_check_is_disabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure VDS health check is disabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The health check support in VDS helps you identify and troubleshoot configuration errors in a vSphere Distributed Switch.  It is recommended that health check be turned off by default and confirmed that it is turned off when troubleshooting is finished.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>vSphere Distributed  switch health check once enabled, collects packets that contain information on host#, vds# port#, which an attacker would find useful.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.networking.doc/GUID-4A6C1E1C-8577-4AE6-8459-EEB942779A82.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Using the vSphere Web Client for each VDS:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select a VDS</xhtml:li>
              <xhtml:li>Go to "Configure" -&gt; "Settings" -&gt; Health check".</xhtml:li>
              <xhtml:li>Click "Edit"</xhtml:li>
              <xhtml:li>Set "VLAN and MTU Check" to "Disabled".</xhtml:li>
              <xhtml:li>Set "Teaming and Failover Check" to "Disabled".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Additionally, the following PowerCLI command can be used:</xhtml:p>
            <xhtml:code class="code_block">Get-View -ViewType DistributedVirtualSwitch | ?{($_.config.HealthCheckConfig | ?{$_.enable -notmatch "False"})}| %{$_.UpdateDVSHealthCheckConfig(@((New-Object Vmware.Vim.VMwareDVSVlanMtuHealthCheckConfig -property @{enable=0}),(New-Object Vmware.Vim.VMwareDVSTeamingHealthCheckConfig -property @{enable=0})))}
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:878009"/>
        </check>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:878010"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Logging">
    <xccdf:title xml:lang="en">Logging</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations related to ESXi's logging capabilities.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Ensure_a_centralized_location_is_configured_to_collect_ESXi_host_core_dumps" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure a centralized location is configured to collect ESXi host core dumps</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The VMware vSphere Network Dump Collector service allows for collecting diagnostic information from a host that experiences a critical fault. This service provides a centralized location for collecting ESXi host core dumps.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>When a host crashes, an analysis of the resultant core dump is essential to being able to identify the cause of the crash and determine a resolution. Installing a centralized dump collector helps ensure that core files are successfully saved and made available in the event an ESXi host should ever panic.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">http://kb.vmware.com/kb/1032051</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To implement the recommended configuration state, run the following ESXi shell commands:</xhtml:p>
            <xhtml:code class="code_block">
# Configure remote Dump Collector Server              <br/>
esxcli system coredump network set -v [VMK#] -i [DUMP_SERVER] -o [PORT]              <br/>
# Enable remote Dump Collector              <br/>
esxcli system coredump network set -e true
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811995" value-id="xccdf_org.cisecurity.benchmarks_value_811995_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811995"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_L1_Ensure_persistent_logging_is_configured_for_all_ESXi_hosts" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure persistent logging is configured for all ESXi hosts</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
ESXi can be configured to store log files on an in-memory file system. This occurs when the host's           <xhtml:span class="inline_block">Syslog.global.LogDir</xhtml:span>
 property is set to a non-persistent location, such as           <xhtml:span class="inline_block">/scratch.</xhtml:span>
 When this is done, only a single day's worth of logs are stored at any time. Additionally, log files will be reinitialized upon each reboot.        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
            <xhtml:span class="inline_block">Syslog.global.LogDir</xhtml:span>
 must be set for each host. The host syslog parameters can also be configured using the vCLI or PowerCLI, or using an API client.          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Non-persistent logging presents a security risk because user activity logged on the host is only stored temporarily and will not be preserved across reboots. This can also complicate auditing and make it harder to monitor events and diagnose issues. ESXi host logging should always be configured to a persistent datastore.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8-DAE8D95976E7.html</xccdf:ident>
      <xccdf:ident system="URL">http://kb.vmware.com/kb/1033696</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To configure persistent logging properly, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host and go to "Configure" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>
Enter                 <xhtml:span class="inline_block">Syslog.global.LogDir</xhtml:span>
 in the filter.              </xhtml:li>
              <xhtml:li>
Set the                 <xhtml:span class="inline_block">Syslog.global.LogDir</xhtml:span>
 to a persistent location specified as [datastorename] path_to_file where the path is relative to the datastore. For example, [datastore1] /systemlogs.              </xhtml:li>
              <xhtml:li>Make sure the attribute is highlighted, then click the pencil icon.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternatively, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set Syslog.global.logDir for each host              <br/>
Get-VMHost | Foreach { Set-AdvancedConfiguration -VMHost $_ -Name Syslog.global.logDir -Value "&lt;NewLocation&gt;" }
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811996" value-id="xccdf_org.cisecurity.benchmarks_value_811996_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811996"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_L1_Ensure_remote_logging_is_configured_for_ESXi_hosts" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure remote logging is configured for ESXi hosts</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>By default, ESXI logs are stored on a local scratch volume or ramdisk. To preserve logs, also configure remote logging to a central log host for the ESXI hosts.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Remote logging to a central log host provides a secure, centralized store for ESXi logs. You can more easily monitor all hosts with a single tool. You can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server helps prevent log tampering and provides a long-term audit record.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8-DAE8D95976E7.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To configure remote logging properly, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host and click "Configure" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>
Enter                 <xhtml:span class="inline_block">Syslog.global.logHost</xhtml:span>
 in the filter.              </xhtml:li>
              <xhtml:li>
Make sure                 <xhtml:span class="inline_block">Syslog.global.logHost</xhtml:span>
 is highlighted, then click the pencil icon.              </xhtml:li>
              <xhtml:li>
Set                 <xhtml:span class="inline_block">Syslog.global.logHost</xhtml:span>
 to the hostname or IP address of the central log server.              </xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set Syslog.global.logHost for each host              <br/>
Get-VMHost | Foreach { Set-&lt;span&gt;AdvancedSetting &lt;/span&gt;&lt;span&gt;-VMHost $_ -Name Syslog.global.logHost -Value "&lt;NewLocation&gt;" }&lt;/span&gt;
            </xhtml:code>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 When setting a remote log host, it is also recommended to set the "Syslog.global.logDirUnique" to true. You must configure the syslog settings for each host.            </xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:811997" value-id="xccdf_org.cisecurity.benchmarks_value_811997_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:811997"/>
      </check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Access">
    <xccdf:title xml:lang="en">Access</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations related to ESXi access management.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_L1_Ensure_a_non-root_user_account_exists_for_local_admin_access" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure a non-root user account exists for local admin access</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>By default, each ESXi host has a single "root" admin account that is used for local administration and to connect the host to vCenter Server. Use of this shared account should be limited, and named (non-root) user accounts with admin privileges should be used instead.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>To avoid sharing a common root account, it is recommended on each host to create at least one named user account and assign it full admin privileges, and to use this account in lieu of a shared "root" account. Limit the use of "root", including setting a highly complex password for the account, but do not remove the "root" account.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.html.hostclient.doc/GUID-0898677F-CE98-41FB-A488-29DF6210CF5D.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To create one or more named user accounts (local ESXi user accounts), perform the following using the vSphere client (not the vSphere web client) for each ESXi host:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Connect directly to the ESXi host using the vSphere Client.</xhtml:li>
              <xhtml:li>Login as root.</xhtml:li>
              <xhtml:li>Select Manage, then select the Security &amp; Users tab.</xhtml:li>
              <xhtml:li>Select User and view the local users.</xhtml:li>
              <xhtml:li>Add a local user and grant shell access to this user.</xhtml:li>
              <xhtml:li>Select the Host, then select "Actions" and "Permissions".</xhtml:li>
              <xhtml:li>Assign the "Administrator" role to the user.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:strong>Notes:</xhtml:strong>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Even if you add your ESXi host to an Active Directory domain, it is still recommended to add at least one local user account to ensure admins can still login in the event the host ever becomes isolated and unable to access Active Directory.</xhtml:li>
              <xhtml:li>Adding local user accounts can be automated using Host Profiles.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812000"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_L1_Ensure_passwords_are_required_to_be_complex" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure passwords are required to be complex</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
ESXi uses the           <xhtml:span class="inline_block">pam_passwdqc.so</xhtml:span>
 plug-in to set password strength and complexity. Options include setting minimum password length, requiring password characters to come from particular character sets, and restricting the number of consecutive failed logon attempts permitted. The settings should enforce the organization's password policies.        </xhtml:p>
        <xhtml:p>Note that an uppercase character that begins a password does not count toward the number of character classes used, and neither does a number that ends a password.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>All passwords for ESXi hosts should be hard to guess to reduce the risk of unauthorized access.</xhtml:p>
        <xhtml:p>
          <xhtml:strong>Note:</xhtml:strong>
 ESXi imposes no restrictions on the root password. Password strength and complexity rules only apply to non-root users.        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">http://www.openwall.com/passwdqc/README.shtml</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC-8C73-05ACDAE6BE43.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the password complexity requirements, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Login to the ESXi shell as a user with administrator privileges.</xhtml:li>
              <xhtml:li>
Open                 <xhtml:span class="inline_block">/etc./pam.d/passwd</xhtml:span>
.              </xhtml:li>
              <xhtml:li>Locate the following line:</xhtml:li>
            </xhtml:ol>
            <xhtml:code class="code_block">  password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4
</xhtml:code>
            <xhtml:ol start="4">
              <xhtml:li>Set N to less than or equal to 5.</xhtml:li>
              <xhtml:li>
Set N0 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
              <xhtml:li>
Set N1 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
              <xhtml:li>
Set N2 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
              <xhtml:li>
Set N3 to                 <xhtml:span class="inline_block">disabled</xhtml:span>
.              </xhtml:li>
              <xhtml:li>
Set N4 to                 <xhtml:span class="inline_block">14</xhtml:span>
 or greater.              </xhtml:li>
            </xhtml:ol>
            <xhtml:p>The above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. Additionally, a maximum of 5 consecutive failed login attempts are permitted.</xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_L1_Ensure_Active_Directory_is_used_for_local_user_authentication" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure Active Directory is used for local user authentication</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>ESXi can be configured to use a directory service such as Active Directory to manage users and groups. It is recommended that a directory service be used.</xhtml:p>
        <xhtml:p>
          <xhtml:strong>Note:</xhtml:strong>
 If the AD group "ESX Admins" (default) is created, all users and groups that are members of this group will have full administrative access to all ESXi hosts in the domain.        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Joining ESXi hosts to an Active Directory (AD) domain eliminates the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced, and reduces the risk of security breaches and unauthorized access.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-63D22519-38CC-4A9F-AE85-97A53CB0948A.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To use AD for local user authentication, perform the following from the vSphere Web Client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host and go to "Manage" -&gt; "Security &amp; Users" -&gt; "Authentication".</xhtml:li>
              <xhtml:li>Click the "Join Domain" button.</xhtml:li>
              <xhtml:li>Provide the domain name along with the user credentials for an AD user that has the rights to join computers to the domain.</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Join the ESXI Host to the Domain              <br/>
Get-VMHost HOST1 | Get-VMHostAuthentication | Set-VMHostAuthentication -Domain domain.local -User Administrator -Password Passw0rd -JoinDomain    
            </xhtml:code>
            <xhtml:p>
              <xhtml:strong>Notes</xhtml:strong>
:            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Host Profiles can be used to automate adding hosts to an AD domain.</xhtml:li>
              <xhtml:li>Consider using the vSphere Authentication proxy to avoid transmitting AD credentials over the network.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:812001" value-id="xccdf_org.cisecurity.benchmarks_value_812001_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812001"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4_L1_Ensure_only_authorized_users_and_groups_belong_to_the_esxAdminsGroup_group" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure only authorized users and groups belong to the esxAdminsGroup group</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
The AD group used by vSphere is defined by the           <xhtml:span class="inline_block">esxAdminsGroup</xhtml:span>
 attribute. By default, this attribute is set to "ESX Admins". All members of the group are granted full administrative access to all ESXi hosts in the domain. Monitor AD for the creation of this group, and limit membership to highly trusted users and groups.        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>
An unauthorized user or group having membership in the           <xhtml:span class="inline_block">esxAdminsGroup</xhtml:span>
 group will have full administrative access to all ESXi hosts. Such users may compromise the confidentiality, availability, and integrity of the all ESXi hosts and the respective data and processes they influence.        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>
To remove unauthorized users and groups belonging to               <xhtml:span class="inline_block">esxAdminsGroup</xhtml:span>
, perform the following steps after coordination between vSphere admins and Active Directory admins:            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>
Verify the setting of the                 <xhtml:span class="inline_block">esxAdminsGroup</xhtml:span>
 attribute.              </xhtml:li>
              <xhtml:li>View the list of members for that Microsoft Active Directory group.</xhtml:li>
              <xhtml:li>Remove all unauthorized users and groups from that group.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
If full admin access for the AD ESX admins group is not desired, you can disable this behavior using the advanced host setting: "              <xhtml:span class="inline_block">Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd</xhtml:span>
".            </xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Ensure_the_Exception_Users_list_is_properly_configured" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure the Exception Users list is properly configured</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Users who are added to the "Exception Users" list do not lose their permissions when the host enters lockdown mode. Usually you may want to add some service accounts, such as a backup agent, to the Exception Users list.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Users who do not require special permissions should not be exempted from lockdown mode because this increases the risk of unauthorized actions being performed, especially if a user account is compromised.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To correct the membership of the "Exception Users" list, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere web client, select host.</xhtml:li>
              <xhtml:li>Click on "Configure" -&gt; "Settings" -&gt; "System" -&gt; "Security Profile".</xhtml:li>
              <xhtml:li>Scroll down to "Lockdown Mode".</xhtml:li>
              <xhtml:li>Click "Edit", then click on "Exception Users".</xhtml:li>
              <xhtml:li>Add or delete users as per your organization's requirements.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Ensure_account_lockout_is_set_to_15_minutes" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure account lockout is set to 15 minutes</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>An account is automatically locked after the maximum number of failed consecutive login attempts is reached. The account should be automatically unlocked after 15 minutes, otherwise administrators will need to manually unlock accounts on request by authorized users.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>This setting reduces the inconvenience for benign users and the overhead on administrators, while also severely slowing down any brute force password guessing attacks.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://code.vmware.com/apis/196/vsphere#https://vdc-repo.vmware.com/vmwb-repository/dcr-public/6b586ed2-655c-49d9-9029-bc416323cb22/fa0b429a-a695-4c11-b7d2-2cbc284049dc/doc/vim.option.OptionManager.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the account lockout to 15 minutes, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
              <xhtml:li>Click "Configure" -&gt; "Settings" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>Enter "Security.AccountUnlockTime" in the filter.</xhtml:li>
              <xhtml:li>Click "Edit".</xhtml:li>
              <xhtml:li>Set the value for this parameter to 900.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime | Set-AdvancedSetting -Value 900
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1031671" value-id="xccdf_org.cisecurity.benchmarks_value_1031671_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1031671"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Ensure_the_maximum_failed_login_attempts_is_set_to_3" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the maximum failed login attempts is set to 3</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Authentication should be configured so there is a maximum number of consecutive failed login attempts for each account, at which point the account at risk will be locked out.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Multiple account login failures for the same account could possibly be an attacker trying to brute force guess the password.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://code.vmware.com/apis/196/vsphere#https://vdc-repo.vmware.com/vmwb-repository/dcr-public/6b586ed2-655c-49d9-9029-bc416323cb22/fa0b429a-a695-4c11-b7d2-2cbc284049dc/doc/vim.option.OptionManager.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the maximum failed login attempts correctly, perform the following steps:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
              <xhtml:li>Click "Configure" -&gt; "Settings" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>Enter "Security.AccountLockFailures" in the filter.</xhtml:li>
              <xhtml:li>Click "Edit".</xhtml:li>
              <xhtml:li>Set the value for this parameter to 3.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures | Set-AdvancedSetting -Value 3
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1031672" value-id="xccdf_org.cisecurity.benchmarks_value_1031672_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1031672"/>
      </check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Console">
    <xccdf:title xml:lang="en">Console</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations related to ESXi consoles.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Ensure_the_DCUI_timeout_is_set_to_600_seconds_or_less" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the DCUI timeout is set to 600 seconds or less</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The Direct Console User Interface (DCUI) is used for directly logging into an ESXi host and carrying out host management tasks. This setting terminates an idle DCUI session after the specified number of seconds has elapsed.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Terminating idle DCUI sessions helps avoid unauthorized usage of the DCUI originating from leftover login sessions.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To correct the DCUI timeout setting, perform the following steps:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere Web Client, select the host.</xhtml:li>
              <xhtml:li>Click "Configure" -&gt; "Settings" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>Enter "UserVars.DcuiTimeOut" in the filter.</xhtml:li>
              <xhtml:li>Click "Edit".</xhtml:li>
              <xhtml:li>Set the value for this parameter to 600 seconds or less.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">Get-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut | Set-AdvancedSetting -Value 600
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1031673" value-id="xccdf_org.cisecurity.benchmarks_value_1031673_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1031673"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2_L2_Ensure_DCUI_is_disabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L2) Ensure DCUI is disabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The Direct Console User Interface (DCUI) allows for low-level host configuration such as configuring IP address, hostname, and root password as well as diagnostic capabilities such as enabling the ESXi shell, viewing log files, restarting agents, and resetting configurations. The DCUI can be disabled to prevent any local administration from the host. Once the DCUI is disabled, any administration of the ESXi host must be done through vCenter.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Actions performed from the DCUI are not tracked by vCenter Server. Even if Lockdown Mode is enabled, users who are members of the DCUI.Access list can perform administrative tasks in the DCUI, bypassing role-based access control and auditing controls provided through vCenter. Disabling DCUI prevents all local activity, and thus forces actions to be performed in vCenter Server, where they can be centrally audited and monitored.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116-A8353D19FF56.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To disable DCUI, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere web client, select the host.</xhtml:li>
              <xhtml:li>Select "Configure" -&gt; "System" -&gt; "Security Profile".</xhtml:li>
              <xhtml:li>Scroll down to "Services".</xhtml:li>
              <xhtml:li>Click "Edit...".</xhtml:li>
              <xhtml:li>Select "Direct Console UI".</xhtml:li>
              <xhtml:li>Click "Stop".</xhtml:li>
              <xhtml:li>Change the Startup Policy to "Start and Stop Manually".</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set DCUI to start manually rather than automatically for all hosts              <br/>
Get-VMHost | Get-VMHostService | Where { $_.key -eq "DCUI" } | Set-VMHostService -Policy Off
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Disabling the DCUI can create a potential "lockout" situation, should the host become isolated from vCenter Server. Recovering from a "lockout" scenario requires reinstalling ESXi. Consider leaving DCUI enabled, and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812002"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Ensure_the_ESXi_shell_is_disabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the ESXi shell is disabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The ESXi shell is an interactive command line environment available from the Direct Console User Interface (DCUI) or remotely via SSH. The ESXi shell should only be enabled on a host when running diagnostics or troubleshooting.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Activities performed from the ESXi shell bypass vCenter RBAC and audit controls, so the ESXi shell should only be enabled when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere web client or vCLI/PowerCLI.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D-8F5D-0D5621D65DAE.html</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D-860F-96C0819570A8.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To disable the ESXi shell, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere web client, select the host.</xhtml:li>
              <xhtml:li>Select "Configure" -&gt; "System" -&gt; "Security Profile".</xhtml:li>
              <xhtml:li>Scroll down to "Services".</xhtml:li>
              <xhtml:li>Click "Edit...".</xhtml:li>
              <xhtml:li>Select "ESXi Shell".</xhtml:li>
              <xhtml:li>Click "Stop".</xhtml:li>
              <xhtml:li>Change the Startup Policy to "Start and Stop Manually".</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set the ESXi shell to start manually rather than automatically for all hosts              <br/>
Get-VMHost | Get-VMHostService | Where { $_.key -eq "TSM" } | Set-VMHostService -Policy Off
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812003"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_L1_Ensure_SSH_is_disabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure SSH is disabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The ESXi shell, when enabled, can be accessed directly from the host console through the DCUI or remotely using SSH. Disable Secure Shell (SSH) for each ESXi host to prevent remote access to the ESXi shell, and only enable SSH when needed for troubleshooting or diagnostics.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Remote access to the host should be limited to the vSphere Client, remote command-line tools (vCLI/PowerCLI), and through the published APIs. Under normal circumstances, remote access to the host using SSH should be disabled.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769-DA76C2BC9FFE.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To disable SSH, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere web client, select the host.</xhtml:li>
              <xhtml:li>Select "Configure" -&gt; "System" -&gt; "Security Profile".</xhtml:li>
              <xhtml:li>Scroll down to "Services".</xhtml:li>
              <xhtml:li>Click "Edit...".</xhtml:li>
              <xhtml:li>Select "SSH".</xhtml:li>
              <xhtml:li>Click "Stop".</xhtml:li>
              <xhtml:li>Change the Startup Policy to "to Start and Stop Manually".</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set SSH to start manually rather than automatically for all hosts              <br/>
Get-VMHost | Get-VMHostService | Where { $_.key -eq "TSM-SSH" } | Set-VMHostService -Policy Off
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812004"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_L1_Ensure_CIM_access_is_limited" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure CIM access is limited</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The Common Information Model (CIM) system provides an interface that enables hardware-level management from remote applications using a set of standard APIs. Provide only the minimum access necessary to applications. Do not provision CIM-based hardware monitoring tools and other third-party applications to run as root or as another administrator account. Instead, create a dedicated service account specific to each CIM application with the minimal access and privileges needed for that application.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If CIM-based hardware monitoring tools or other third-party applications are granted unneeded administrator level access, they could potentially be used to compromise the security of the host.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7-BE77-224EF963D145.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To limit CIM access, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Create a limited-privileged service account for CIM and other third-party applications.</xhtml:li>
              <xhtml:li>This account should access the system via vCenter.</xhtml:li>
              <xhtml:li>Give the account the "CIM Interaction" privilege only. This will enable the account to obtain a CIM ticket, which can then be used to perform both read and write CIM operations on the target host. If an account must connect to the host directly, this account must be granted the full "Administrator" role on the host. This is not recommended unless required by the monitoring software being used.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Create a new host user account -Host Local connection required-              <br/>
New-VMHostAccount -ID ServiceUser -Password &lt;password&gt; -UserAccount
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_L1_Ensure_Lockdown_mode_is_enabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure Lockdown mode is enabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Enabling lockdown mode disables direct local access to an ESXi host, requiring the host be managed remotely from vCenter Server.</xhtml:p>
        <xhtml:p>There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases, lockdown mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed.</xhtml:p>
        <xhtml:p>Note: Lockdown mode does not apply to users who log in using authorized keys. Also, users in the DCUI.Access list for each host are allowed to override lockdown mode and log in to the DCUI. By default, the "root" user is the only user listed in the DCUI.Access list.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Lockdown mode limits ESXi host access to the vCenter server to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly. By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838-225F5FF480FF.html</xccdf:ident>
      <xccdf:ident system="URL">http://kb.vmware.com/kb/1008077</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To enable lockdown mode, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host.</xhtml:li>
              <xhtml:li>Select "Configure" -&gt; "System" -&gt; "Security Profile".</xhtml:li>
              <xhtml:li>Scroll down to "Lockdown Mode".</xhtml:li>
              <xhtml:li>Click "Edit...".</xhtml:li>
              <xhtml:li>Select the "Enable Lockdown Mode" checkbox.</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Enable lockdown mode for each host              <br/>
Get-VMHost | Foreach { $_.EnterLockdownMode() }
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:812005" value-id="xccdf_org.cisecurity.benchmarks_value_812005_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812005"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_L2_Ensure_the_SSH_authorized_keys_file_is_empty" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L2) Ensure the SSH authorized_keys file is empty</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
ESXi hosts come with Secure Shell (SSH), which can be configured to authenticate remote users using public key authentication. For day-to-day operations, the ESXi host should be in lockdown mode with the SSH service disabled. Lockdown mode does not prevent root users from logging in using keys. The presence of a remote user's public key in the           <xhtml:span class="inline_block">/etc/ssh/keys-root/authorized_keys</xhtml:span>
 file on an ESXi host identifies the user as trusted, meaning the user is granted access to the host without providing a password.        </xhtml:p>
        <xhtml:p>
Disabling           <xhtml:span class="inline_block">authorized_keys</xhtml:span>
 access may limit your ability to run unattended remote scripts.        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Keeping the authorized_keys file empty prevents users from circumventing the intended restrictions of lockdown mode.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-392ADDE9-FD3B-49A2-BF64-4ACBB60EB149.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To remove all keys from the authorized_keys file, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Logon to the ESXi shell as root or another admin user.</xhtml:li>
              <xhtml:li>
Edit the                 <xhtml:span class="inline_block">/etc/ssh/keys-root/authorized_keys</xhtml:span>
 file.              </xhtml:li>
              <xhtml:li>Remove all keys from the file and save the file.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_L1_Ensure_idle_ESXi_shell_and_SSH_sessions_time_out_after_300_seconds_or_less" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure idle ESXi shell and SSH sessions time out after 300 seconds or less</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
The           <xhtml:span class="inline_block">ESXiShellInteractiveTimeOut</xhtml:span>
 allows you to automatically terminate idle ESXi shell and SSH sessions. The permitted idle time should be 300 seconds or less.        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
It is recommended to set the             <xhtml:span class="inline_block">ESXiShellTimeOut</xhtml:span>
 together with             <xhtml:span class="inline_block">ESXiShellInteractiveTimeOut</xhtml:span>
.          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If a user forgets to log out of an ESXi shell or SSH session, the idle session will exist indefinitely, increasing the potential for someone to gain unauthorized privileged access to the host, unless a timeout is set.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">http://kb.vmware.com/kb/2004746</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/index.html#com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027-0280B9ED1009.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the timeout to the desired value, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host.</xhtml:li>
              <xhtml:li>Click "Configure" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>
Type                 <xhtml:span class="inline_block">ESXiShellInteractiveTimeOut</xhtml:span>
 in the filter.              </xhtml:li>
              <xhtml:li>Click on the attribute to highlight it.</xhtml:li>
              <xhtml:li>Click the pencil icon to edit.</xhtml:li>
              <xhtml:li>
Set the attribute to the desired value (                <xhtml:span class="inline_block">300</xhtml:span>
 seconds or less).              </xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 A value of 0 disables the ESXi ShellInteractiveTimeOut.            </xhtml:p>
            <xhtml:p>Alternately, use the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set Remove UserVars.ESXiShellInteractiveTimeOut to 300 on all hosts              <br/>
Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellInteractiveTimeOut' | Set-AdvancedSetting -Value "300"
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:812006" value-id="xccdf_org.cisecurity.benchmarks_value_812006_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812006"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_L1_Ensure_the_shell_services_timeout_is_set_to_1_hour_or_less" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the shell services timeout is set to 1 hour or less</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
When the ESXi shell or SSH services are enabled on a host, they will run indefinitely. To avoid this, set the           <xhtml:span class="inline_block">ESXiShellTimeOut</xhtml:span>
, which defines a window of time after which the ESXi shell and SSH services will automatically be terminated.        </xhtml:p>
        <xhtml:p>
It is recommended to set the           <xhtml:span class="inline_block">ESXiShellInteractiveTimeOut</xhtml:span>
 together with           <xhtml:span class="inline_block">ESXiShellTimeOut</xhtml:span>
.        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>This value can be set in minutes via the DCUI. When using the vCenter GUI or PowerShell API, the value is set in seconds.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>This reduces the risk of an inactive ESXi shell or SSH service being misused by an unauthorized party to compromise a host.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42-B40B-71E4C83DEEFB.html</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68-8096-F009B87ACB33.html</xccdf:ident>
      <xccdf:ident system="URL">http://kb.vmware.com/kb/2004746</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027-0280B9ED1009.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the timeout to the desired value, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host and click "Configure" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>
Type                 <xhtml:span class="inline_block">ESXiShellTimeOut</xhtml:span>
 in the filter.              </xhtml:li>
              <xhtml:li>Click on the attribute to highlight it.</xhtml:li>
              <xhtml:li>Click the pencil icon to edit.</xhtml:li>
              <xhtml:li>Set the attribute to 3600 seconds (1 hour) or less.</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 A value of 0 disables the ESXiShellTimeOut.            </xhtml:p>
            <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set UserVars.ESXiShellTimeOut to 3600 on all hosts              <br/>
Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellTimeOut' | Set-AdvancedSetting -Value "3600"
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:812007" value-id="xccdf_org.cisecurity.benchmarks_value_812007_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812007"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_L1_Ensure_DCUI_has_a_trusted_users_list_for_lockdown_mode" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure DCUI has a trusted users list for lockdown mode</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Lockdown mode disables direct host access, requiring admins to manage hosts from vCenter. Set DCUI.Access to a list of highly trusted users who would be able to override lockdown mode and access the DCUI in the event an ESXi host became isolated from vCenter.</xhtml:p>
        <xhtml:p>
          <xhtml:strong>NOTE:</xhtml:strong>
 If you disable lockdown mode using the DCUI, all users with the DCUI.Access privilege will be granted the Administrator role on the host.        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
 By default only the "root" user is a member of the DCUI.Access list. It is not recommended to remove root from the DCUI.Access list, as this will revoke the root user's admin privileges on the host.          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>The list prevents all admins from becoming locked out and no longer being able to manage the host.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116-A8353D19FF56.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set a trusted users list for DCUI, perform the following from the vSphere web client:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Select the host.</xhtml:li>
              <xhtml:li>Select "Configure" -&gt; "System" -&gt; "Advanced System Settings".</xhtml:li>
              <xhtml:li>
Type                 <xhtml:span class="inline_block">DCUI.Access</xhtml:span>
 in the filter.              </xhtml:li>
              <xhtml:li>Click on the attribute to highlight it.</xhtml:li>
              <xhtml:li>Click edit.</xhtml:li>
              <xhtml:li>
Set the                 <xhtml:span class="inline_block">DCUI.Access</xhtml:span>
 attribute to a comma-separated list of the users who are allowed to override lockdown mode.              </xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1032120" value-id="xccdf_org.cisecurity.benchmarks_value_1032120_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1032120"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.11_L2_Ensure_contents_of_exposed_configuration_files_have_not_been_modified" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L2) Ensure contents of exposed configuration files have not been modified</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Although most configurations on ESXi are controlled via an API, there are a limited set of configuration files that are used directly to govern host behavior. These files are exposed via the vSphere HTTPS-based file transfer API. These files should be monitored for modifications.</xhtml:p>
        <xhtml:p>
          <xhtml:strong>WARNING:</xhtml:strong>
 Do not attempt to monitor files that are NOT exposed via this file transfer API, since this can result in a destabilized system.        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>During a configuration backup, the serial number is backed up with the configuration. The number is restored when you restore the configuration. The number is not preserved when you run the Recovery CD (ESXi Embedded) or perform a repair operation (ESXi Installable). You can back up and restore configuration information as follows:</xhtml:p>
          <xhtml:ol>
            <xhtml:li>Back up the configuration by using the vicfg-cfgbackup command.</xhtml:li>
            <xhtml:li>Run the Recovery CD or repair operation</xhtml:li>
            <xhtml:li>Restore the configuration by using the vicfg-cfgbackup command.</xhtml:li>
          </xhtml:ol>
          <xhtml:p>When you restore a configuration, you must make sure that all virtual machines on the host are stopped.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Any changes to these files should be correlated with an approved administrative action, such as an authorized configuration change. Tampering with these files could enable unauthorized access to the host configuration and virtual machines.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Restore all modified configuration files to a known good state by restoring backups or using other means.</xhtml:p>
            <xhtml:p>To help prevent future occurrences, you can back up the host configuration data after configuring or reconfiguring an ESXi host. The vicfg-cfgbackup command is available only for ESXi hosts; it is not available through a vCenter Server system connection. No equivalent ESXCLI command is supported.</xhtml:p>
            <xhtml:p>To help identify future occurrences more quickly, implement a procedure to monitor the files and their contents over time to ensure they are not improperly modified. Be sure not to monitor log files and other files whose content is expected to change regularly due to system activity. Also, account for configuration file changes that are due to authorized administrative activity.</xhtml:p>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 Host Profiles may also be used to track configuration changes on the host; however, Host Profiles do not track all configuration changes.            </xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_Storage">
    <xccdf:title xml:lang="en">Storage</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations related to ESXi disk and other storage-related settings.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1_L1_Ensure_bidirectional_CHAP_authentication_for_iSCSI_traffic_is_enabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure bidirectional CHAP authentication for iSCSI traffic is enabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>vSphere allows for the use of bidirectional authentication of both the iSCSI target and host. Bidirectional Challenge-Handshake Authentication Protocol (CHAP), also known as Mutual CHAP, should be enabled to provide bidirectional authentication.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:strong>Prerequisites</xhtml:strong>
- Before setting up CHAP parameters for software or dependent hardware iSCSI, determine whether to configure unidirectional or bidirectional CHAP. Independent hardware iSCSI adapters do not support bidirectional CHAP.          </xhtml:p>
          <xhtml:ul>
            <xhtml:li>Verify CHAP parameters configured on the storage side. Parameters that you configure must match the ones on the storage side.</xhtml:li>
            <xhtml:li>
Required privilege:               <xhtml:span class="inline_block">Host.Configuration.Storage Partition Configuration</xhtml:span>
            </xhtml:li>
          </xhtml:ul>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>By not authenticating both the iSCSI target and host, there is a potential for a man-in-the-middle attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication can mitigate this risk.</xhtml:p>
        <xhtml:p>
          <xhtml:strong>Note:</xhtml:strong>
 Choosing not to enforce bidirectional authentication can make sense if you create a dedicated network or VLAN to service all your iSCSI devices. If the iSCSI facility is isolated from general network traffic, it is less vulnerable to exploitation.        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD-49B433E2F266.html</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083-8E65FE380899.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To enable bidirectional CHAP authentication for iSCSI traffic, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere Web Client, navigate to "Hosts and Clusters".</xhtml:li>
              <xhtml:li>Click on a host.</xhtml:li>
              <xhtml:li>Click on "Configure" -&gt; "Storage" -&gt; "Storage Adapters".</xhtml:li>
              <xhtml:li>Select the iSCSI adapter to configure OR click the green plus symbol to create a new adapter.</xhtml:li>
              <xhtml:li>Under Adapter Details, click the Properties tab and click "Edit" in the Authentication panel.</xhtml:li>
              <xhtml:li>Specify authentication method: "Use bidirectional CHAP".</xhtml:li>
              <xhtml:li>Specify the outgoing CHAP name.</xhtml:li>
            </xhtml:ol>
            <xhtml:ul>
              <xhtml:li>
Make sure that the name you specify matches the name configured on the storage side.
                <xhtml:ul>
                  <xhtml:li>To set the CHAP name to the iSCSI adapter name, select "Use initiator name".</xhtml:li>
                  <xhtml:li>To set the CHAP name to anything other than the iSCSI initiator name, deselect "Use initiator name" and type a name in the Name text box.</xhtml:li>
                </xhtml:ul>
              </xhtml:li>
            </xhtml:ul>
            <xhtml:ol start="8">
              <xhtml:li>Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret.</xhtml:li>
              <xhtml:li>Specify incoming CHAP credentials. Make sure your outgoing and incoming secrets do not match.</xhtml:li>
              <xhtml:li>Click OK.</xhtml:li>
              <xhtml:li>Click the second to last symbol to rescan the iSCSI adapter.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, run the following PowerCLI command:</xhtml:p>
            <xhtml:code class="code_block">
# Set the Chap settings for the Iscsi Adapter              <br/>
Get-VMHost | Get-VMHostHba | Where {$_.Type -eq "Iscsi"} | Set-VMHostHba # Use desired parameters here
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:812008" value-id="xccdf_org.cisecurity.benchmarks_value_812008_var"/>
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812008"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_L1_Ensure_the_uniqueness_of_CHAP_authentication_secrets_for_iSCSI_traffic" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure the uniqueness of CHAP authentication secrets for iSCSI traffic</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Challenge-Handshake Authentication Protocol (CHAP) requires both client and host to know the secret (password) to establish a connection. Each mutual authentication secret should be unique.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>If you change the CHAP parameters, they are used for new iSCSI sessions. For existing sessions, new settings are not used until you log out and log in again.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If all mutual authentication secrets are unique, compromise of one secret does not allow an attacker to authenticate to other hosts or clients using that same secret.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD-49B433E2F266.html</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083-8E65FE380899.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To change the values of CHAP secrets so they are unique, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere Web Client, navigate to "Hosts".</xhtml:li>
              <xhtml:li>Click on a host.</xhtml:li>
              <xhtml:li>Click on "Configure" -&gt; "Storage" -&gt; "Storage Adapters".</xhtml:li>
              <xhtml:li>Select the iSCSI adapter to configure OR click the green plus symbol to create a new adapter.</xhtml:li>
              <xhtml:li>Under Adapter Details, click the Properties tab and click "Edit" in the Authentication panel.</xhtml:li>
              <xhtml:li>
Specify the authentication method.
                <xhtml:ul>
                  <xhtml:li>None</xhtml:li>
                  <xhtml:li>Use unidirectional CHAP if required by target</xhtml:li>
                  <xhtml:li>Use unidirectional CHAP unless prohibited by target</xhtml:li>
                  <xhtml:li>Use unidirectional CHAP</xhtml:li>
                  <xhtml:li>Use bidirectional CHAP</xhtml:li>
                </xhtml:ul>
              </xhtml:li>
              <xhtml:li>Specify the outgoing CHAP name.</xhtml:li>
            </xhtml:ol>
            <xhtml:ul>
              <xhtml:li>
Make sure that the name you specify matches the name configured on the storage side.
                <xhtml:ul>
                  <xhtml:li>To set the CHAP name to the iSCSI adapter name, select "Use initiator name".</xhtml:li>
                  <xhtml:li>To set the CHAP name to anything other than the iSCSI initiator name, deselect "Use initiator name" and type a name in the Name text box.</xhtml:li>
                </xhtml:ul>
              </xhtml:li>
            </xhtml:ul>
            <xhtml:ol start="8">
              <xhtml:li>Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret.</xhtml:li>
              <xhtml:li>If configuring with bidirectional CHAP, specify incoming CHAP credentials.</xhtml:li>
            </xhtml:ol>
            <xhtml:ul>
              <xhtml:li>Make sure your outgoing and incoming secrets do not match.</xhtml:li>
            </xhtml:ul>
            <xhtml:ol start="10">
              <xhtml:li>Click OK.</xhtml:li>
              <xhtml:li>Click the second to last symbol to rescan the iSCSI adapter.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.3_L1_Ensure_storage_area_network_SAN_resources_are_segregated_properly" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure storage area network (SAN) resources are segregated properly</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Use zoning and logical unit number (LUN) masking to segregate storage area network (SAN) activity.</xhtml:p>
        <xhtml:p>Zoning provides access control in the SAN topology. Zoning defines which host bus adapters (HBAs) can connect to which targets. The devices outside a zone are not visible to the devices inside the zone when SAN zoning is configured. For example, zones defined for testing should be managed independently within the SAN so they do not interfere with activity in the production zones. Similarly, you can set up different zones for different departments. Zoning must take into account any host groups that have been set up on the SAN device.</xhtml:p>
        <xhtml:p>LUN masking is a process that makes a LUN available to some hosts and unavailable to other hosts.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Segregating SAN activity can reduce the attack surface for the SAN, prevent non-ESXi systems from accessing SANs, and
separate environments, for example, test and production environments.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143-9BB0-16ABB3CA0FE3.html</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026-809A-ED8F9D8FDACE.html</xccdf:ident>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6-BEDF-FAB1528C070D.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>The remediation procedures to properly segregate SAN activity are SAN vendor or product-specific.</xhtml:p>
            <xhtml:p>In general, with ESXi hosts, use a single-initiator zoning or a single-initiator-single-target zoning. The latter is a preferred zoning practice. Using the more restrictive zoning prevents problems and misconfigurations that can occur on the SAN.</xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.4_L2_Ensure_VMDK_files_are_zeroed_out_prior_to_deletion" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L2) Ensure VMDK files are zeroed out prior to deletion</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The CLI command 'vmkfstools --writezeroes' can be used to write zeros to the entire contents of a virtual machine disk (VMDK) file prior to its deletion.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Zeroing out a VMDK file before deleting the file can help prevent users from reconstructing the original contents of the file from the physical storage media.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-050C0FEE-2C75-4356-B9E0-CC802333FF41.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>When deleting a VMDK file with sensitive data:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Shut down or stop the virtual machine.</xhtml:li>
              <xhtml:li>Issue the CLI command 'vmkfstools --writezeroes' on that file prior to deleting it from the datastore.</xhtml:li>
            </xhtml:ol>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>When you use this command, you lose any existing data on the virtual disk.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_vNetwork">
    <xccdf:title xml:lang="en">vNetwork</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations related to configuring vNetwork.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_L1_Ensure_the_vSwitch_Forged_Transmits_policy_is_set_to_reject" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the vSwitch Forged Transmits policy is set to reject</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Set the vSwitch Forged Transmits policy to reject for each vSwitch. Reject Forged Transmit can be set at the vSwitch and/or the Portgroup level. You can override switch-level settings at the Portgroup level.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>This will prevent VMs from changing their effective MAC address. This will affect applications that require this functionality, such as Microsoft Clustering, which requires systems to effectively share a MAC address. This will affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Setting forged transmissions to accept means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the policy to reject forged transmissions, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>In the vSphere Web Client, navigate to the host.</xhtml:li>
              <xhtml:li>Go to "Hosts and Clusters" -&gt; "vCenter" -&gt; host.</xhtml:li>
              <xhtml:li>On the Configure tab, click Networking, and select Virtual switches.</xhtml:li>
              <xhtml:li>Select a standard switch from the list and click the pencil icon to edit settings.</xhtml:li>
              <xhtml:li>Select Security.</xhtml:li>
              <xhtml:li>Set Forged transmits to "Reject".</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, the following ESXi shell command may be used:</xhtml:p>
            <xhtml:code class="code_block"># esxcli network vswitch standard policy security set -v vSwitch2 -f false
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812009"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Ensure_the_vSwitch_MAC_Address_Change_policy_is_set_to_reject" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the vSwitch MAC Address Change policy is set to reject</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Ensure the MAC Address Change policy within the vSwitch is set to reject. Reject MAC Changes can be set at the vSwitch and/or the Portgroup level. You can override switch-level settings at the Portgroup level.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality, such as Microsoft Clustering, which requires systems to effectively share a MAC address. This will affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the policy to reject, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>In the vSphere Web Client, navigate to the host.</xhtml:li>
              <xhtml:li>Go to "Hosts and Clusters" -&gt; "vCenter" -&gt; host.</xhtml:li>
              <xhtml:li>On the Configure tab, click Networking, and select Virtual switches.</xhtml:li>
              <xhtml:li>Select a standard switch from the list and click the pencil icon to edit settings.</xhtml:li>
              <xhtml:li>Select Security.</xhtml:li>
              <xhtml:li>Set MAC Address Changes to "Reject".</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, perform the following using the ESXi shell:</xhtml:p>
            <xhtml:code class="code_block"># esxcli network vswitch standard policy security set -v vSwitch2 -m false
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812010"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Ensure_the_vSwitch_Promiscuous_Mode_policy_is_set_to_reject" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure the vSwitch Promiscuous Mode policy is set to reject</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Ensure the Promiscuous Mode Policy within the vSwitch is set to reject. Promiscuous mode can be set at the vSwitch and/or the Portgroup level. You can override switch-level settings at the Portgroup level.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>There might be a legitimate reason to enable promiscuous mode for debugging, monitoring, or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch. An exception should be made for the dvPortgroups that these applications are connected to in order to allow for full-time visibility to the traffic on that dvPortgroup.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the dvPortgroup have the potential of reading all packets crossing that network. This could enable unauthorized access to the contents of those packets.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1-9B50-7717C3443DD7.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set the policy to reject, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>In the vSphere Web Client, navigate to the host.</xhtml:li>
              <xhtml:li>Go to "Hosts and Clusters" -&gt; "vCenter" -&gt; host.</xhtml:li>
              <xhtml:li>On the Configure tab, click Networking, and select Virtual switches.</xhtml:li>
              <xhtml:li>Select a standard switch from the list and click the pencil icon to edit settings.</xhtml:li>
              <xhtml:li>Select Security.</xhtml:li>
              <xhtml:li>Set Promiscuous Mode to "Reject".</xhtml:li>
              <xhtml:li>Click "OK".</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Alternately, perform the following via the ESXi shell:</xhtml:p>
            <xhtml:code class="code_block"># esxcli network vswitch standard policy security set -v vSwitch2 -p false
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812011"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Ensure_port_groups_are_not_configured_to_the_value_of_the_native_VLAN" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure port groups are not configured to the value of the native VLAN</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>ESXi does not use the concept of native VLAN, so do not configure port groups to use the native VLAN ID. If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Frames with VLAN specified in the port group will have a tag, but frames without a VLAN specified in the port group are not tagged and therefore will end up as belonging to the native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a “1”; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a “1” instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81-9D2E-A2F9F2D01180.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To stop using the native VLAN ID for port groups, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere web client, select the host.</xhtml:li>
              <xhtml:li>On the Configure tab, click Networking, and select Virtual switches.</xhtml:li>
              <xhtml:li>Select a standard switch from the list.</xhtml:li>
              <xhtml:li>View the topology diagram of the switch, which shows the various port groups associated with that switch.</xhtml:li>
              <xhtml:li>For each port group on the vSwitch, verify and record the VLAN IDs used.</xhtml:li>
              <xhtml:li>If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch.</xhtml:li>
              <xhtml:li>Click the "Edit settings" pencil icon under the topology diagram title.</xhtml:li>
              <xhtml:li>In the Properties section, name the port group in the Network Label text field.</xhtml:li>
              <xhtml:li>Choose an existing VLAN ID drop-down menu or type in a new one.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:812012"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Ensure_port_groups_are_not_configured_to_VLAN_values_reserved_by_upstream_physical_switches" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure port groups are not configured to VLAN values reserved by upstream physical switches</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Ensure that port groups are not configured to VLAN values reserved by upstream physical switches. Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001 through 1024 and 4094, while Nexus switches typically reserve 3968 through 4047 and 4094. Check the documentation for your specific switch.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Using a reserved VLAN might result in a denial of service on the network.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12-2/20ew/configuration/guide/config/vlans.html#wp1038758</xccdf:ident>
      <xccdf:ident system="URL">http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/layer2/7x/b_5500_Layer2_Config_7x/b_5500_Layer2_Config_7x_chapter_010.html#con_1143823</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To change the VLAN values for port groups to non-reserved values, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere web client, select the host.</xhtml:li>
              <xhtml:li>On the Configure tab, click Networking, and select Virtual switches.</xhtml:li>
              <xhtml:li>Select a standard switch from the list.</xhtml:li>
              <xhtml:li>View the topology diagram of the switch, which shows the various port groups associated with that switch.</xhtml:li>
              <xhtml:li>For each port group on the vSwitch, verify and record the VLAN IDs used.</xhtml:li>
              <xhtml:li>If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch.</xhtml:li>
              <xhtml:li>Click the "Edit settings" pencil icon under the topology diagram title.</xhtml:li>
              <xhtml:li>In the Properties section, name the port group in the Network Label text field.</xhtml:li>
              <xhtml:li>Choose an existing VLAN ID drop-down menu or type in a new one.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Ensure_port_groups_are_not_configured_to_VLAN_4095_except_for_Virtual_Guest_Tagging_VGT" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure port groups are not configured to VLAN 4095 except for Virtual Guest Tagging (VGT)</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Port groups should not be configured to VLAN 4095 except for Virtual Guest Tagging (VGT). When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest virtual machine without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If VGT is enabled inappropriately, it might cause a denial of service or allow a guest virtual machine to interact with traffic on an unauthorized VLAN.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12-2/20ew/configuration/guide/config/vlans.html#wp1038758</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To set port groups to values other than 4095 unless VGT is required, perform the following:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>From the vSphere web client, select the host.</xhtml:li>
              <xhtml:li>On the Configure tab, click Networking, and select Virtual switches.</xhtml:li>
              <xhtml:li>Select a standard switch from the list.</xhtml:li>
              <xhtml:li>View the topology diagram of the switch, which shows the various port groups associated with that switch.</xhtml:li>
              <xhtml:li>For each port group on the vSwitch, verify and record the VLAN IDs used.</xhtml:li>
              <xhtml:li>If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch.</xhtml:li>
              <xhtml:li>Click the "Edit settings" pencil icon under the topology diagram title.</xhtml:li>
              <xhtml:li>In the Properties section, name the port group in the Network Label text field.</xhtml:li>
              <xhtml:li>Choose an existing VLAN ID drop-down menu or type in a new one.</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:555570"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Ensure_Virtual_Disributed_Switch_Netflow_traffic_is_sent_to_an_authorized_collector" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">(L1) Ensure Virtual Disributed Switch Netflow traffic is sent to an authorized collector</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The vSphere VDS can export Netflow information about traffic crossing the VDS. These exports are not encrypted and can contain information about the virtual network making it easier for  a Man in the Middle attack to be executed successfully.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If Netflow export is required, verify that all VDS Netflow target systems are approved collectors by confirming the IP's are set correctly.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">http://pubs.vmware.com/vsphere-67/topic/com.vmware.vsphere.security.doc/GUID-FA661AE0-C0B5-4522-951D-A3790DBE70B4.html</xccdf:ident>
      <xccdf:ident system="URL">http://pubs.vmware.com/vsphere-67/topic/com.vmware.vsphere.networking.doc/GUID-55FCEC92-74B9-4E5F-ACC0-4EA1C36F397A.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Using the vSphere Web Client</xhtml:p>
            <xhtml:ol>
              <xhtml:li>For each distributed switch</xhtml:li>
              <xhtml:li>Go to "Configure" -&gt; "Settings" -&gt; "NetFlow".</xhtml:li>
              <xhtml:li>Click "Edit"</xhtml:li>
              <xhtml:li>Set the "Collector IP address" and "Collector port" to the organization approved systems.</xhtml:li>
            </xhtml:ol>
            <xhtml:p>Additionally, the following PowerCLI command may be used</xhtml:p>
            <xhtml:code class="code_block">"# Disable Netfow for a VDPortgroup
$DPortgroup = &lt;name of portgroup&gt;
Get-VDPortgroup $DPortGroup | Disable-PGNetflow

#Function for  Disable-PGNetflow
#From: http://www.virtu-al.net/2013/07/23/disabling-netflow-with-powercli/

Function Disable-PGNetflow {
   [CmdletBinding()]
   Param (
      [Parameter(ValueFromPipeline=$true)]
      $DVPG
   )
   Process {
      Foreach ($PG in $DVPG) {
         $spec = New-Object VMware.Vim.DVPortgroupConfigSpec
         $spec.configversion = $PG.Extensiondata.Config.ConfigVersion
         $spec.defaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting
         $spec.defaultPortConfig.ipfixEnabled = New-Object VMware.Vim.BoolPolicy
         $spec.defaultPortConfig.ipfixEnabled.inherited = $false
         $spec.defaultPortConfig.ipfixEnabled.value = $false
 
         $PGView = Get-View -Id $PG.Id
         $PGView.ReconfigureDVPortgroup_Task($spec)
      }
   }
}
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Ensure_port-level_configuration_overrides_are_disabled." role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">(L1) Ensure port-level configuration overrides are disabled.</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Port-level configuration overrides are disabled by default. Once enabled, it allows for different security to be set ignoring what is set at the Port-Group level.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>There are cases where unique configurations are needed, but this should be monitored so it is only used when authorized.  If overrides are not monitored, anyone who gains access to a VM with a less secure VDS configuration could secretly exploit the broader access.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident system="URL">http://pubs.vmware.com/vsphere-67/topic/com.vmware.vsphere.security.doc/GUID-FA661AE0-C0B5-4522-951D-A3790DBE70B4.html</xccdf:ident>
      <xccdf:ident system="URL">http://pubs.vmware.com/vsphere-67/topic/com.vmware.vsphere.networking.doc/GUID-DDF5CD98-454A-471D-9053-03ABB8FE86D1.html</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Using the vSphere Web Client,</xhtml:p>
            <xhtml:ol>
              <xhtml:li>For each portgroup within each distributed switch</xhtml:li>
              <xhtml:li>Go to "Configure" -&gt; "Settings" -&gt; "Properties".</xhtml:li>
              <xhtml:li>Click "Edit"</xhtml:li>
              <xhtml:li>Go to "Advanced".</xhtml:li>
              <xhtml:li>Disable all "Override port policies".</xhtml:li>
            </xhtml:ol>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
        <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:878011"/>
      </check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8_Virtual_Machines">
    <xccdf:title xml:lang="en">Virtual Machines</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations for settings related to guest virtual machines.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8.1_Communication">
      <xccdf:title xml:lang="en">Communication</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.1.1_L1_Ensure_informational_messages_from_the_VM_to_the_VMX_file_are_limited" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure informational messages from the VM to the VMX file are limited</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Limit informational messages from the virtual machine (VM) to the virtual machine extensions (VMX) file to avoid filling the datastore. The configuration file containing these name-value pairs is limited to a size of 1 MB by default. This should be sufficient for most cases, but you can change this value if necessary, such as if large amounts of custom information are being stored in the configuration file.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Filling the datastore with informational messages from the VM to the VMX file could cause a denial of service.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-91BF834E-CB92-4014-8CF7-29CE40F3E8A3.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To limit informational messages to 1 MB, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "tools.setInfo.sizeLimit" -value 1048576
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813403" value-id="xccdf_org.cisecurity.benchmarks_value_813403_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813403"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.1.2_L2_Ensure_only_one_remote_console_connection_is_permitted_to_a_VM_at_any_time" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure only one remote console connection is permitted to a VM at any time</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>By default, remote console sessions can be connected to by more than one user at a time. Permit only one remote console connection to a VM at a time. Other attempts will be rejected until the first connection disconnects.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a non-administrator in the VM can connect to the console and observe the administrator's actions. Also, this could result in an administrator losing console access to a VM. For example, if a jump box is being used for an open console session, and the admin loses a connection to that box, the console session remains open. Allowing two console sessions permits debugging via a shared session. For highest security, only one remote console session at a time should be allowed.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide-policies-and-profile</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To permit only one remote console session at a time, run the following PowerCLI command for VMs that do not specify the setting:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "RemoteDisplay.maxConnections" -value 1
              </xhtml:code>
              <xhtml:p>Run the following PowerCLI command for VMs that specify the setting but have the wrong value for it:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "RemoteDisplay.maxConnections" -value 1 -Force
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813404" value-id="xccdf_org.cisecurity.benchmarks_value_813404_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813404"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8.2_Devices">
      <xccdf:title xml:lang="en">Devices</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.1_L1_Ensure_unnecessary_floppy_devices_are_disconnected" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure unnecessary floppy devices are disconnected</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that no floppy device is connected to a virtual machine unless required. For a floppy device to be disconnected, the floppyX.present parameter should either not be present or have a value of FALSE.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disconnect all floppy drives from VMs, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Remove all Floppy drives attached to VMs                <br/>
Get-VM | Get-FloppyDrive | Remove-FloppyDrive
              </xhtml:code>
              <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813405" value-id="xccdf_org.cisecurity.benchmarks_value_813405_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813405"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.2_L2_Ensure_unnecessary_CDDVD_devices_are_disconnected" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure unnecessary CD/DVD devices are disconnected</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that no CD/DVD device is connected to a virtual machine unless required. For a CD/DVD device to be disconnected, the ideX:Y.present parameter should either not be present or have a value of FALSE.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disconnect all CD/DVD drives from VMs, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Remove all CD/DVD Drives attached to VMs                <br/>
Get-VM | Get-CDDrive | Remove-CDDrive
              </xhtml:code>
              <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813406" value-id="xccdf_org.cisecurity.benchmarks_value_813406_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813406"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.3_L1_Ensure_unnecessary_parallel_ports_are_disconnected" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure unnecessary parallel ports are disconnected</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that no parallel port is connected to a virtual machine unless required. For a parallel port to be disconnected, the parallelX.present parameter should either not be present or have a value of FALSE.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in-powercli.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disconnect all parallel ports from VMs, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html                <br/>
# Remove all Parallel Ports attached to VMs                <br/>
Get-VM | Get-ParallelPort | Remove-ParallelPort
              </xhtml:code>
              <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:555571" value-id="xccdf_org.cisecurity.benchmarks_value_555571_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:555571"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.4_L1_Ensure_unnecessary_serial_ports_are_disconnected" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure unnecessary serial ports are disconnected</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that no serial port is connected to a virtual machine unless required. For a serial port to be disconnected, the serialX.present parameter should either not be present or have a value of FALSE.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in-powercli.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disconnect all serial ports from VMs, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html                <br/>
# Remove all Serial Ports attached to VMs                <br/>
Get-VM | Get-SerialPort | Remove-SerialPort
              </xhtml:code>
              <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:555572" value-id="xccdf_org.cisecurity.benchmarks_value_555572_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:555572"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.5_L1_Ensure_unnecessary_USB_devices_are_disconnected" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure unnecessary USB devices are disconnected</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that no USB device is connected to a virtual machine unless required. For a USB device to be disconnected, the usb.present parameter should either not be present or have a value of FALSE.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disconnect all USB devices from VMs, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Remove all USB Devices attached to VMs                <br/>
Get-VM | Get-USBDevice | Remove-USBDevice
              </xhtml:code>
              <xhtml:p>The VM will need to be powered off for this change to take effect.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813407" value-id="xccdf_org.cisecurity.benchmarks_value_813407_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813407"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.6_L1_Ensure_unauthorized_modification_and_disconnection_of_devices_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure unauthorized modification and disconnection of devices is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>In a virtual machine, users and processes without root or administrator privileges can disconnect devices, such as network adapters and CD-ROM drives, and modify device settings within the guest operating system. These actions should be prevented.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling unauthorized modification and disconnection of devices helps prevents unauthorized changes within the guest operating system, which could be used to gain unauthorized access, cause denial of service conditions, and otherwise negatively affect the security of the guest operating system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168-C62D9306DBD6.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To prevent unauthorized device modifications and disconnections, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.device.edit.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813408" value-id="xccdf_org.cisecurity.benchmarks_value_813408_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813408"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.7_L1_Ensure_unauthorized_connection_of_devices_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure unauthorized connection of devices is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>In a virtual machine, users and processes without root or administrator privileges can connect devices, such as network adapters and CD-ROM drives. This should be prevented.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling unauthorized connection of devices helps prevents unauthorized changes within the guest operating system, which could be used to gain unauthorized access, cause denial of service conditions, and otherwise negatively affect the security of the guest operating system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168-C62D9306DBD6.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To prevent unauthorized device connections, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.device.connectable.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813409" value-id="xccdf_org.cisecurity.benchmarks_value_813409_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813409"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.2.8_L1_Ensure_PCI_and_PCIe_device_passthrough_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure PCI and PCIe device passthrough is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Using the VMware DirectPath I/O feature to pass through a PCI or PCIe device to a virtual machine can result in a potential security vulnerability.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The vulnerability can be triggered by buggy or malicious code running in privileged mode in the guest OS, such as a device driver.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-E5CFB1FB-9216-4C1D-B49A-81AAAC414025.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using the vSphere Web Client:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Select each VM</xhtml:li>
                <xhtml:li>Click "Configure" -&gt; "Settings" -&gt; "Virtual Hardware" -&gt;</xhtml:li>
                <xhtml:li>Remove the PCI/PCIe passthrough device.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Additionally, the following PowerCLI command can be used:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "pciPassthru*.present" -value ""
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1033295" value-id="xccdf_org.cisecurity.benchmarks_value_1033295_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1033295"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8.3_Guest">
      <xccdf:title xml:lang="en">Guest</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.3.1_L1_Ensure_unnecessary_or_superfluous_functions_inside_VMs_are_disabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1) Ensure unnecessary or superfluous functions inside VMs are disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable all system components that are not needed to support the application or service running on the VM. VMs often don't require as many functions as ordinary physical servers, so when virtualizing, you should evaluate whether a particular function is truly needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>By disabling unnecessary system components, you reduce the number of potential attack vectors, which reduces the likelihood of compromise.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-6BFA8CA7-610F-4E6B-9FC6-D656917B7E7A.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable unneeded functions, perform whichever of the following steps are applicable:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Disable unused services in the operating system.</xhtml:li>
                <xhtml:li>Disconnect unused physical devices, such as CD/DVD drives, floppy drives, and USB adaptors.</xhtml:li>
                <xhtml:li>Turn off any screen savers.</xhtml:li>
                <xhtml:li>If using a Linux, BSD, or Solaris guest operating system, do not run the X Windows system unless it is necessary.</xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.3.2_L1_Ensure_use_of_the_VM_console_is_limited" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1) Ensure use of the VM console is limited</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The VM console enables you to connect to the console of a VM, in effect seeing what a monitor on a physical server would show. The VM console also provides power management and removable device connectivity controls. Instead of the VM console, use native remote management services, such as terminal services and ssh, to interact with VMs. Grant access to the VM console only when needed, and use custom roles to provide fine-grained permissions for those people who do need access. By default, the vCenter roles "Virtual Machine Power User" and "Virtual Machine Administrator" have the "Virtual Machine.Interaction.Console Interaction" privilege.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>You can set this privilege at different levels in the hierarchy. For example, if you set a privilege at the folder level, you can propagate the privilege to one or more objects within the folder. The object listed in the Required On column must have the privilege set, either directly or inherited.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The VM console could be misused to eavesdrop on VM activity, cause VM outages, and negatively affect the performance of the console, especially if many VM console sessions are open simultaneously.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-41E5E52E-A95B-4E81-9724-6AD6800BEF78.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-3D47149A-947D-4608-88B3-E5811129EFA8.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To properly limit use of the VM console, perform the following steps:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>From the vSphere Client, navigate to vCenter --&gt; Administration --&gt; Roles.</xhtml:li>
                <xhtml:li>Create a custom role and choose Edit to enable only the minimum needed effective privileges.</xhtml:li>
                <xhtml:li>Next, select an object in the inventory.</xhtml:li>
                <xhtml:li>Click the Permissions tab to view the user and role pair assignments for that object.</xhtml:li>
                <xhtml:li>Remove any default "Admin" or "Power User" roles, and assign the new custom role as needed.</xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.3.3_L1_Ensure_secure_protocols_are_used_for_virtual_serial_port_access" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1) Ensure secure protocols are used for virtual serial port access</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Serial ports are interfaces for connecting peripherals to the VM. They are often used on physical systems to provide a direct, low-level connection to the console of a server. Virtual serial ports allow VMs to communicate with serial ports over networks. If virtual serial ports are needed, they should be configured to use secure protocols.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>If virtual serial ports do not use secure protocols, the communications with those ports could be eavesdropped on, manipulated, or otherwise compromised, giving attackers sensitive information or control to unauthorized parties.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://code.vmware.com/apis/196/vsphere#/doc/vim.vm.device.VirtualSerialPort.URIBackingInfo.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.vm_admin.doc/GUID-462B8B04-29DF-406B-9585-12D2588A6A48.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To configure all virtual serial ports to use secure protocols, change any protocols that are not secure to one of the following:</xhtml:p>
              <xhtml:ul>
                <xhtml:li>ssl - the equivalent of TCP+SSL</xhtml:li>
                <xhtml:li>tcp+ssl - SSL over TCP over IPv4 or IPv6</xhtml:li>
                <xhtml:li>tcp4+ssl - SSL over TCP over IPv4</xhtml:li>
                <xhtml:li>tcp6+ssl - SSL over TCP over IPv6</xhtml:li>
                <xhtml:li>telnets - telnet over SSL over TCP</xhtml:li>
              </xhtml:ul>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.3.4_L1_Ensure_templates_are_used_whenever_possible_to_deploy_VMs" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1) Ensure templates are used whenever possible to deploy VMs</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use a hardened base operating system template image to create application-specific templates, and use the application-specific templates to deploy virtual machines.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>By capturing a hardened base operating system image (with no applications installed) in a template, you can ensure that all your virtual machines are created with a known baseline level of security. Manual installation of the OS and applications into a VM introduces the risk of misconfiguration due to human or process error.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.vm_admin.doc/GUID-8254CD05-CC06-491D-BA56-A773A32A8130.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-3399BC47-45E8-494B-9B57-E498DD294A47.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To change current practices so templates are used whenever possible to deploy VMs, perform whichever of the following steps is appropriate:</xhtml:p>
              <xhtml:ul>
                <xhtml:li>Create templates and configure them properly</xhtml:li>
                <xhtml:li>Alter standard procedures and processes to use the templates</xhtml:li>
              </xhtml:ul>
              <xhtml:p>Also, ensure that the applications do not depend on information specific to the VM to be deployed.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8.4_Monitor">
      <xccdf:title xml:lang="en">Monitor</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.1_L1_Ensure_access_to_VMs_through_the_dvfilter_network_APIs_is_configured_correctly" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1) Ensure access to VMs through the dvfilter network APIs is configured correctly</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>A VM must be configured explicitly to accept access by the dvfilter network API. Only VMs that need to be accessed by that API should be configured to accept such access.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>An attacker might compromise a VM by making use of the dvfilter API.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://kb.vmware.com/kb/1714</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821-ED17A77B0206.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To configure a VM to allow dvfilter access, perform the following steps:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Configure the following in the VMX file:                   <xhtml:span class="inline_block">ethernet0.filter1.name = dv-filter1</xhtml:span>
 where                   <xhtml:span class="inline_block">ethernet0</xhtml:span>
 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and                   <xhtml:span class="inline_block">dv-filter1</xhtml:span>
 is the name of the particular data path kernel module that is protecting the VM.                </xhtml:li>
                <xhtml:li>Set the name of the data path kernel correctly.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>To configure a VM to not allow dvfilter access, perform the following steps:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Remove the following from its VMX file:                   <xhtml:span class="inline_block">ethernet0.filter1.name = dv-filter1</xhtml:span>
.                </xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.2_L1_Ensure_VMsafe_Agent_Address_is_configured_correctly" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1) Ensure VMsafe Agent Address is configured correctly</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following:</xhtml:p>
          <xhtml:ol>
            <xhtml:li>Enable the API.</xhtml:li>
            <xhtml:li>Set the IP address used by the security virtual appliance on the introspection vSwitch.</xhtml:li>
            <xhtml:li>Set the port number for that IP address.</xhtml:li>
          </xhtml:ol>
          <xhtml:p>
The second parameter must be set correctly in the             <xhtml:span class="inline_block">vmsafe.agentAddress</xhtml:span>
 option in the virtual machine configuration file for any VMs that should be protected by the API.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>With vSphere 4 VMware came out with a restricted API called “VMsafe” which offered a CPU and Memory introspection API. This was a restricted API that was only available to VMware partners.</xhtml:p>
            <xhtml:p>For vSphere 5.5 onward, this VMsafe API is no longer supported.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>An attacker might compromise the VMs by making unauthorized use of the introspection channel provided by the API.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://kb.vmware.com/kb/1714</xccdf:ident>
        <xccdf:ident system="URL">https://www.vmware.com/security/hardening-guides.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To configure the VMsafe Agent Address correctly, perform the following steps:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
If the VM is not being protected by a VMsafe CPU/memory product, remove                   <xhtml:span class="inline_block">vmsafe.agentAddress</xhtml:span>
 from the virtual machine configuration file.                </xhtml:li>
                <xhtml:li>
If the VM is being protected by a VMsafe CPU/Memory product, set                   <xhtml:span class="inline_block">vmsafe.agentAddress</xhtml:span>
 to the correct value.                </xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.3_L1__Ensure_VMsafe_Agent_Port_is_configured_correctly" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1)  Ensure VMsafe Agent Port is configured correctly</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following:</xhtml:p>
          <xhtml:ol>
            <xhtml:li>Enable the API.</xhtml:li>
            <xhtml:li>Set the IP address used by the security virtual appliance on the introspection vSwitch.</xhtml:li>
            <xhtml:li>Set the port number for that IP address.</xhtml:li>
          </xhtml:ol>
          <xhtml:p>
The third parameter must be set correctly in the             <xhtml:span class="inline_block">vmsafe.agentPort</xhtml:span>
 option in the virtual machine configuration file for any VMs that should be protected by the API.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>An attacker might compromise the VMs by making unauthorized use of the introspection channel provided by the API.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://kb.vmware.com/kb/1714</xccdf:ident>
        <xccdf:ident system="URL">https://www.vmware.com/security/hardening-guides.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To configure the VMsafe Agent Port correctly, perform the following steps:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
If the VM is not being protected by a VMsafe CPU/memory product, remove                   <xhtml:span class="inline_block">vmsafe.agentPort</xhtml:span>
 from the virtual machine configuration file.                </xhtml:li>
                <xhtml:li>
If the VM is being protected by a VMsafe CPU/Memory product, set                   <xhtml:span class="inline_block">vmsafe.agentPort</xhtml:span>
 to the correct value.                </xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.4_L1_Ensure_VMsafe_Agent_is_configured_correctly" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L1) Ensure VMsafe Agent is configured correctly</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following:</xhtml:p>
          <xhtml:ol>
            <xhtml:li>Enable the API.</xhtml:li>
            <xhtml:li>Set the IP address used by the security virtual appliance on the introspection vSwitch.</xhtml:li>
            <xhtml:li>Set the port number for that IP address.</xhtml:li>
          </xhtml:ol>
          <xhtml:p>
The first parameter must be set correctly in the             <xhtml:span class="inline_block">vmsafe.enable</xhtml:span>
 option in the virtual machine configuration file for any VMs that should be protected by the API. For any VMs that should not be protected by the API, this option should not exist in the configuration file.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>An attacker might compromise the VMs by making unauthorized use of the introspection channel provided by the API.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://kb.vmware.com/kb/1714</xccdf:ident>
        <xccdf:ident system="URL">https://www.vmware.com/security/hardening-guides.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To configure the VMsafe Agent correctly, perform the following steps:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
If the VM is not being protected by a VMsafe CPU/memory product, remove                   <xhtml:span class="inline_block">vmsafe.enable</xhtml:span>
 from the virtual machine configuration file or set it to a value of FALSE.                </xhtml:li>
                <xhtml:li>
If the VM is being protected by a VMsafe CPU/Memory product, set                   <xhtml:span class="inline_block">vmsafe.enable</xhtml:span>
 to the correct value.                </xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:555573" value-id="xccdf_org.cisecurity.benchmarks_value_555573_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:555573"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.5_L2_Ensure_Autologon_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Autologon is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Autologon should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as autologon, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable autologon, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.ghi.autologon.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813410" value-id="xccdf_org.cisecurity.benchmarks_value_813410_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813410"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.6_L2_Ensure_BIOS_BBS_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure BIOS BBS is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>BIOS BBS should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as BIOS BBS, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable BIOS BBS, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.bios.bbs.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813413" value-id="xccdf_org.cisecurity.benchmarks_value_813413_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813413"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.7_L2_Ensure_Guest_Host_Interaction_Protocol_Handler_is_set_to_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Guest Host Interaction Protocol Handler is set to disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Guest Host Interaction Protocol Handle should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as Guest Host Interaction Protocol Handle, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable Guest Host Interaction Protocol Handle, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.ghi.protocolhandler.info.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813416" value-id="xccdf_org.cisecurity.benchmarks_value_813416_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813416"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.8_L2_Ensure_Unity_Taskbar_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Unity Taskbar is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Unity Taskbar feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Taskbar feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Unity Taskbar feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.unity.taskbar.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813417" value-id="xccdf_org.cisecurity.benchmarks_value_813417_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813417"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.9_L2_Ensure_Unity_Active_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Unity Active is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Unity Active feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Active feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-412EF981-D4F1-430B-9D09-A4679C2D04E7.html?hWord=N4IghgNiBcIMIHsB2AzAlgcwK4Cc1IwAIA1AWQHcwcBTQgFQQQgGcQBfIA</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Unity Active feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.unityActive.disable" -value $True
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813418" value-id="xccdf_org.cisecurity.benchmarks_value_813418_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813418"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.10_L2_Ensure_Unity_Window_Contents_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Unity Window Contents is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Unity Window Contents feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Window Contents feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Unity Window Contents feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.unity.windowContents.disable" -value $True
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813419" value-id="xccdf_org.cisecurity.benchmarks_value_813419_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813419"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.11_L2_Ensure_Unity_Push_Update_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Unity Push Update is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Unity Push Update feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Push Update feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Unity Push Update feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.unity.push.update.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813420" value-id="xccdf_org.cisecurity.benchmarks_value_813420_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813420"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.12_L2_Ensure_Drag_and_Drop_Version_Get_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Drag and Drop Version Get is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Drag and Drop Version Get feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Drag and Drop Version Get feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Drag and Drop Version Get feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.vmxDnDVersionGet.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813421" value-id="xccdf_org.cisecurity.benchmarks_value_813421_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813421"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.13_L2_Ensure_Drag_and_Drop_Version_Set_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Drag and Drop Version Set is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Drag and Drop Version Set feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Drag and Drop Version Set feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Drag and Drop Version Set feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.guestDnDVersionSet.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813422" value-id="xccdf_org.cisecurity.benchmarks_value_813422_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813422"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.14_L2_Ensure_Shell_Action_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Shell Action is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Shell Action feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Shell Action feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Shell Action feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.ghi.host.shellAction.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813423" value-id="xccdf_org.cisecurity.benchmarks_value_813423_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813423"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.15_L2_Ensure_Request_Disk_Topology_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Request Disk Topology is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Request Disk Topology feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Request Disk Topology feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Request Disk Topology feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.dispTopoRequest.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813424" value-id="xccdf_org.cisecurity.benchmarks_value_813424_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813424"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.16_L2_Ensure_Trash_Folder_State_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Trash Folder State is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Trash Folder State feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>Reference matches, but DOES NOT CONTAIN content.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Trash Folder State feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Trash Folder State feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.trashFolderState.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813425" value-id="xccdf_org.cisecurity.benchmarks_value_813425_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813425"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.17_L2_Ensure_Guest_Host_Interaction_Tray_Icon_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Guest Host Interaction Tray Icon is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Guest Host Interaction Tray Icon feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>Reference matches, but DOES NOT CONTAIN content.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Guest Host Interaction Tray Icon feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Guest Host Interaction Tray Icon feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.ghi.trayicon.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813426" value-id="xccdf_org.cisecurity.benchmarks_value_813426_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813426"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.18_L2_Ensure_Unity_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Unity is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Unity feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>Reference matches, but DOES NOT CONTAIN content.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Unity feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.unity.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:813427" value-id="xccdf_org.cisecurity.benchmarks_value_813427_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:813427"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.19_L2_Ensure_Unity_Interlock_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Unity Interlock is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Unity Interlock feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Interlock feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Unity Interlock feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.unityInterlockOperation.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816959" value-id="xccdf_org.cisecurity.benchmarks_value_816959_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816959"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.20_L2_Ensure_GetCreds_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure GetCreds is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The GetCreds feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the GetCreds feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the GetCreds feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.getCreds.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816960" value-id="xccdf_org.cisecurity.benchmarks_value_816960_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816960"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.21_L2_Ensure_Host_Guest_File_System_Server_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Host Guest File System Server is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Host Guest File System Server should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Certain automated operations such as automated tool upgrades use a component in the hypervisor called Host Guest File System (HGFS), and an attacker could potentially use this to transfer files inside the guest OS. These VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features, such as the Host Guest File System Server, are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Host Guest File System Server, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.hgfsServerSet.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>This will cause the VMX process to not respond to commands from the tools process. Setting isolation.tools.hgfsServerSet.disable to TRUE disables the registration of the guest's HGFS server with the host. APIs that use HGFS to transfer files to and from the guest operating system, such as some VIX commands or the VMware Tools auto-upgrade utility, will not function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816961" value-id="xccdf_org.cisecurity.benchmarks_value_816961_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816961"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.22_L2_Ensure_Guest_Host_Interaction_Launch_Menu_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure Guest Host Interaction Launch Menu is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Guest Host Interaction Launch Menu feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Guest Host Interaction Launch Menu feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the Guest Host Interaction Launch Menu feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.ghi.launchmenu.change" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816962" value-id="xccdf_org.cisecurity.benchmarks_value_816962_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816962"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.23_L2_Ensure_memSchedFakeSampleStats_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure memSchedFakeSampleStats is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The memSchedFakeSampleStats feature should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the memSchedFakeSampleStats feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D-83DEBB6872C2.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable the memSchedFakeSampleStats feature, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.memSchedFakeSampleStats.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some automated tools and processes may cease to function.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816963" value-id="xccdf_org.cisecurity.benchmarks_value_816963_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816963"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.24_L1_Ensure_VM_Console_Copy_operations_are_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure VM Console Copy operations are disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>VM console copy operations should be disabled.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>VM console copy operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05-85033136A667.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To explicitly disable VM console copy operations, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.copy.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816964" value-id="xccdf_org.cisecurity.benchmarks_value_816964_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816964"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.25_L1_Ensure_VM_Console_Drag_and_Drop_operations_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure VM Console Drag and Drop operations is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>VM console drag and drop operations should be disabled.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>Only reference for this element to be found was in the 5.0 documentation portal. It is not found in the 5.1 or 5.5 portal.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>VM console drag and drop operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335-CFBCE0DD2167.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To explicitly disable VM console drag and drop operations, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.dnd.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816965" value-id="xccdf_org.cisecurity.benchmarks_value_816965_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816965"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.26_L1_Ensure_VM_Console_GUI_Options_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure VM Console GUI Options is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>VM console and paste GUI options should be disabled.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>Only reference for this element to be found was in the 5.0 documentation portal. It is not found in the 5.1 or 5.5 portal.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>VM console and paste GUI options are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To explicitly disable VM console and paste GUI options, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.setGUIOptions.enable" -value $false
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:555574" value-id="xccdf_org.cisecurity.benchmarks_value_555574_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:555574"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.27_L1_Ensure_VM_Console_Paste_operations_are_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure VM Console Paste operations are disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>VM console paste operations should be disabled.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>VM console paste operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05-85033136A667.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To explicitly disable VM console paste operations, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.paste.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816966" value-id="xccdf_org.cisecurity.benchmarks_value_816966_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816966"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.28_L1_Ensure_access_to_VM_console_via_VNC_protocol_is_limited" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure access to VM console via VNC protocol is limited</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Minimize access to the Virtual Machine via VNC protocol.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>Kb.vmare link needs to be abridged.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The VM console enables you to connect to the console of a virtual machine, in effect seeing what a monitor on a physical server would show. This console is also available via the VNC protocol. Setting up this access also involves setting up firewall rules on each ESXi server the virtual machine will run on.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.vm_admin.doc/GUID-BB1F20D3-339F-46F3-B020-D19C9322C001.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "RemoteDisplay.vnc.enabled" -value $false
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Configuring VM settings and opening up the firewall means multiple steps to be configured and monitored.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816967" value-id="xccdf_org.cisecurity.benchmarks_value_816967_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816967"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.4.29_L2_Ensure_all_but_VGA_mode_on_virtual_machines_is_disabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L2) Ensure all but VGA mode on virtual machines is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable VGA Only mode for the Virtual Machine video card.</xhtml:p>
          <xhtml:p>Note:this setting should only be applied to those virtual machines for which a video card is not needed such as Windows Server Core and UNIX / Linux servers.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Many Server-class virtual machines need only a standard VGA console (typically a Unix/Linux server or Windows Server Core system). Enabling this setting removes additional unnecessary graphics functionality beyond disabling 3D. This reduces the potential attack surface available for malicious attacks.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Check that the virtual machine advanced setting of "svga.vgaonly" is set to TRUE.</xhtml:p>
              <xhtml:p>To modify the advanced settings of a virtual machine using the vSphere Client:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Ensure that the virtual machine has been shutdown and is powered off.</xhtml:li>
                <xhtml:li>Right-click on the virtual machine.</xhtml:li>
                <xhtml:li>Click Edit Settings... to open the Virtual Machine Properties window.</xhtml:li>
                <xhtml:li>Click the VM Options tab.</xhtml:li>
                <xhtml:li>From the list on the left, click Advanced.</xhtml:li>
                <xhtml:li>On the Configuration Parameters frame on the right, click Edit Configuration ...</xhtml:li>
                <xhtml:li>Click Add Parameter.</xhtml:li>
                <xhtml:li>On the new row, click under the Key column and specify the configuration option name.</xhtml:li>
                <xhtml:li>On the new row, click under the Value column and specify the configuration value.</xhtml:li>
                <xhtml:li>Start the virtual machine for the settings take effect.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Additionally, the following PowerCLI command may be used:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "svga.vgaOnly" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Configuring this setting to True will not allow any advanced graphics functions to work. Only character-cell console mode will be available. Use of this setting renders mks.enable3d moot. The mks.enable3d has no effect.</xhtml:p>
                <xhtml:p>
                  <xhtml:strong>Note:</xhtml:strong>
 this setting should only be applied to those virtual machines for which a video card is not needed such as Windows Server Core and UNIX / Linux servers.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8.5_Resources">
      <xccdf:title xml:lang="en">Resources</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.5.1_L2_Ensure_VM_limits_are_configured_correctly" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">(L2) Ensure VM limits are configured correctly</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>By default, all virtual machines on an ESXi host share the resources equally. By using the resource management capabilities of ESXi, such as limits with reservations, shares, and/or resource pools, you can control the server resources a virtual machine consumes.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Without resource management, one virtual machine could consume so much of the host's resources that other virtual machines on the same host could not perform their intended functions.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-E6262360-9300-4E10-ADE0-D4BED08DB5CA.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To configure VM limits correctly, do all of the following that are applicable:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Use shares or reservations to guarantee resources to critical VMs.</xhtml:li>
                <xhtml:li>Use limits to constrain resource consumption by VMs that have a greater risk of being exploited or attacked, or that run applications that are known to have the potential to greatly consume resources.</xhtml:li>
                <xhtml:li>Use resource pools to guarantee resources to a common group of critical VMs.</xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.5.2_L2_Ensure_hardware-based_3D_acceleration_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure hardware-based 3D acceleration is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Due to performance reasons, modern graphic rendering is done within a dedicated graphic processing unit (GPU). Virtual machines can use the host-based GPU for such operations as well. Such dedicated hardware is typically accessed by using complex APIs like OpenGL and DirectX. This hardware-based 3D acceleration should be disabled if it is not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Security flaws within APIs can lead to serious security breaches like memory corruption, denial of service, and remote code execution.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-15D965F3-05E3-4E59-9F08-B305FDE672DD.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable hardware-based 3D acceleration, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "mks.enable3d" -value $false
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:1033296" value-id="xccdf_org.cisecurity.benchmarks_value_1033296_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:1033296"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8.6_Storage">
      <xccdf:title xml:lang="en">Storage</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.6.1_L2_Ensure_nonpersistent_disks_are_limited" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure nonpersistent disks are limited</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>By default, VM disks use dependent mode, which means they are affected by snapshots. To avoid this, VM disks can use independent mode instead. Independent mode can be configured as persistent (data is written permanently to the disk) or nonpersistent (all changes made to disk are lost when the system is rebooted). Use of nonpersistent mode should be avoided unless the data is not needed (e.g., already duplicated elsewhere).</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>From a security standpoint, nonpersistent mode allows successful attackers to remove evidence of their actions or even their presence within a VM by performing a simple shutdown or reboot.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://code.vmware.com/apis/196/vsphere#/doc/vim.vm.device.VirtualDiskOption.DiskMode.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To limit the use of nonpersistent mode, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
#Add the parameters for the following cmdlet to set the VM Disk Type:                <br/>
Get-VM  | Get-HardDisk | Set-HardDisk
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816968" value-id="xccdf_org.cisecurity.benchmarks_value_816968_var"/>
            <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
            <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816968"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816969" value-id="xccdf_org.cisecurity.benchmarks_value_816969_var"/>
            <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
            <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816969"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.6.2_L1_Ensure_virtual_disk_shrinking_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure virtual disk shrinking is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>If Virtual disk shrinking is done repeatedly it will cause the virtual disk to become unavailable resulting in a denial of service. You can prevent virtual disk shrinking by disabling it.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes—that is, users and processes without root or administrator privileges—within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. This capability is available to nonadministrative users in the guest.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28-5B34FEB264B6.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To implement the recommended configuration state, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.diskShrink.disable" -value $true
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Inability to shrink virtual machine disks in the event that a datastore runs out of space.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816970" value-id="xccdf_org.cisecurity.benchmarks_value_816970_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816970"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.6.3_L1_Ensure_virtual_disk_wiping_is_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure virtual disk wiping is disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Wiping a virtual disk reclaims all unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. If virtual disk wiping is done repeatedly, it can cause the virtual disk to become unavailable while wiping occurs. In most datacenter environments, disk wiping is not needed, but normal users and processes--without administrative privileges--can issue disk wipes unless the feature is disabled.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Virtual disk wiping can effectively cause a denial of service.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28-5B34FEB264B6.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable virtual disk wiping, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.diskWiper.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816971" value-id="xccdf_org.cisecurity.benchmarks_value_816971_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816971"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_8.7_Tools">
      <xccdf:title xml:lang="en">Tools</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.7.1_L2_Ensure_VIX_messages_from_the_VM_are_disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure VIX messages from the VM are disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The VIX API is a library for writing scripts and programs to manipulate virtual machines. If you do not make use of custom VIX programming in your environment, then you should disable certain features, such as the ability to send messages from the VM to the host. Disabling that feature does not adversely affect the functioning of VIX operations that originate outside the guest, so certain VMware and third-party solutions that rely upon this capability should continue to work. This is a deprecated interface.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling unneeded features reduces the potential for vulnerabilities.</xhtml:p>
        </xccdf:rationale>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To disable VIX messages from the VM, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "isolation.tools.vixMessage.disable" -value $true
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816972" value-id="xccdf_org.cisecurity.benchmarks_value_816972_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816972"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.7.2_L1_Ensure_the_number_of_VM_log_files_is_configured_properly" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure the number of VM log files is configured properly</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1 MB. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Log files should be rotated to preserve log data in case of corruption or destruction of the current log file, and to avoid the likelihood of logging issues caused by an overly large log file.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-9142-18A9E7C592EA.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
To set the number of log files to be used to                 <xhtml:span class="inline_block">10</xhtml:span>
, run the following PowerCLI command:              </xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "log.keepOld" -value "10"
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:555575" value-id="xccdf_org.cisecurity.benchmarks_value_555575_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:555575"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.7.3_L2_Ensure_host_information_is_not_sent_to_guests" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L2) Ensure host information is not sent to guests</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Configure VMware Tools to disable host information from being sent to guests unless a particular VM requires this information for performance monitoring purposes.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>By enabling a VM to get detailed information about the physical host, an adversary could potentially use this information to inform further attacks on the host.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201-9AFB-A16A11951A2D.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To prevent host information from being sent to guests, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "tools.guestlib.enableHostInfo" -value $false
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816973" value-id="xccdf_org.cisecurity.benchmarks_value_816973_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816973"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_8.7.4_L1_Ensure_VM_log_file_size_is_limited" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">(L1) Ensure VM log file size is limited</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1 MB. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Virtual machine users and processes can abuse logging either on purpose or inadvertently so that large amounts of data flood the log file. Without restrictions on maximum log file size, over time a log file can consume enough file system space to cause a denial of service.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://kb.vmware.com/kb/8182749</xccdf:ident>
        <xccdf:ident system="URL">https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.monitoring.doc/GUID-2DD66869-52C7-42C5-8F5B-145EBD26BBA1.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To properly limit the maximum log file size, run the following PowerCLI command:</xhtml:p>
              <xhtml:code class="code_block">
# Add the setting to all VMs                <br/>
Get-VM | New-AdvancedSetting -Name "log.rotateSize" -value "1024000"
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.vmware_esxi_6:var:816974" value-id="xccdf_org.cisecurity.benchmarks_value_816974_var"/>
          <check-export export-name="oval:org.cisecurity.benchmarks:var:100000" value-id="xccdf_org.cisecurity.benchmarks_value_esxi.connection"/>
          <check-content-ref href="CIS_VMware_ESXi_6.7_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.vmware_esxi_6:def:816974"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>f3afeFM87PlkbF0e7i1SZJkKjZI=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
QkTG71vdYJVPyTp6c2rCL3zrABwBwLQgsHLCpyLgLDb4Gk3CZ5Z2xhg3yrsNGfnkH3ugvadkSMCc
tUF3K4LmBnoB55HdS2ePhqRgNB2feF9S3MrJD7Y1dQIA3p3DrIi+3TPMrnXsBTsMpu46YE51Lhvh
e0S+yXFyvfuCSESuJ/WXa/oEAm61ZuqDrJ1EyQ36gdyxq/z3KiT01YPbJMZTSCw32fg6CfD+AbB+
dw+q6BhE+7/4NZADOEqRN77y6+R+affa6GzJ2xmyCqr15h3gZy6Am2x48ipSNwgRCdPBhm2x6aNG
iEoHpQ3c/9UOMCXsD5ytbFjuramAiLRYjSlRDQ==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFRzCCBC+gAwIBAgIHTwpN/4tOfDANBgkqhkiG9w0BAQsFADCBtDELMAkGA1UEBhMCVVMxEDAO
BgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxGjAYBgNVBAoTEUdvRGFkZHkuY29t
LCBJbmMuMS0wKwYDVQQLEyRodHRwOi8vY2VydHMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8xMzAx
BgNVBAMTKkdvIERhZGR5IFNlY3VyZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkgLSBHMjAeFw0xNDA5
MTgxNDM0MjFaFw0xNzEwMjAxODU3NDRaMIGTMQswCQYDVQQGEwJVUzERMA8GA1UECBMITmV3IFlv
cmsxFzAVBgNVBAcTDkVhc3QgR3JlZW5idXNoMSswKQYDVQQKEyJDZW50ZXIgZm9yIEludGVybmV0
IFNlY3VyaXR5LCBJbmMuMSswKQYDVQQDEyJDZW50ZXIgZm9yIEludGVybmV0IFNlY3VyaXR5LCBJ
bmMuMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0MGnj6yX2QHklGadAfTBxssvP+2f
YegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzNgOhQx3HcclRwQB4xj/14hOoZSeQ3
haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WYFpSRjZ/Z7m5QKii0feJPxbf+wrZ+
UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKcUY2d3WZ4Zk+zawFcRUYslVIrOhMb
0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7enWCRfZrRWAlDHFaouLdtU/OmXc+
Um7cLwz8VQIDAQABo4IBezCCAXcwDAYDVR0TAQH/BAIwADATBgNVHSUEDDAKBggrBgEFBQcDAzAO
BgNVHQ8BAf8EBAMCB4AwNQYDVR0fBC4wLDAqoCigJoYkaHR0cDovL2NybC5nb2RhZGR5LmNvbS9n
ZGlnMnM1LTAuY3JsMFMGA1UdIARMMEowSAYLYIZIAYb9bQEHFwIwOTA3BggrBgEFBQcCARYraHR0
cDovL2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5LzB2BggrBgEFBQcBAQRqMGgw
JAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmdvZGFkZHkuY29tLzBABggrBgEFBQcwAoY0aHR0cDov
L2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkaWcyLmNydDAfBgNVHSMEGDAW
gBRAwr0njsw0gzCiM9f7bLPwtCyAzjAdBgNVHQ4EFgQU+3zn+CEg6a2xPqlBXvn64hUyoB4wDQYJ
KoZIhvcNAQELBQADggEBAEh76h1GtJ0pj04in+RUymB7fqPh6HFILkOLlTPnveyXCoHYT2M46DET
EA/NKYkoF2KA3QiZ1b+PMViuTYG2pDs71eFVPADuBCGf9IFufCDY9mPvjQiFDlLNMknXxACD8TjC
hqz+uZT2uLPw/YxkJIsCxrTQJ//ga/fHfZDrKgQfbVzxjD/4WKDe8HktjKcn+NWGPJNMgmO+IHrK
if6TB1xTo32W9QzwoXvBdLnziAUGZZghEulq6h3RCMzKPzpx5JiLlOz6JzqXHvrua+yUbr4A29Vy
vkwWgJWjyvJd2uq9MQ9l49kkrD84m41PSwpaHO99nEHRgRykopxIt8AHsIQ=
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>