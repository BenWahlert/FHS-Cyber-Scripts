<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_Apple_macOS_10.13_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
  <xccdf:status date="2020-10-15">draft</xccdf:status>
  <xccdf:title xml:lang="en">CIS Apple macOS 10.13 Benchmark</xccdf:title>
  <xccdf:description xml:lang="en">
    <xhtml:p>
This document, CIS Apple macOS 10.13 Benchmark, provides prescriptive guidance for establishing a secure configuration posture for Apple macOS 10.13. This guide was tested against Apple macOS 10.13. To obtain the latest version of this guide, please visit       <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>
. If you have questions, comments, or have identified ways to improve this guide, please write us at       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>
.    </xhtml:p>
  </xccdf:description>
  <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
  <xccdf:platform idref="cpe:2.3:o:apple:mac_os_x:10.13.0:*:*:*:*:*:*:*"/>
  <xccdf:version>1.1.0</xccdf:version>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
    <xccdf:title xml:lang="en">Level 1</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>Items in this profile intend to:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>be practical and prudent;</xhtml:li>
        <xhtml:li>provide a clear security benefit; and</xhtml:li>
        <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
      </xhtml:ul>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple-provided_software_is_current" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_updates_install" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_Enable_macOS_update_installs" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Show_Bluetooth_status_in_menu_bar" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Familiarize_users_with_screen_lock_tools_or_corner_to_Start_Screen_Saver" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.1_Enable_FileVault" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.2_Ensure_all_user_storage_APFS_volumes_are_encrypted" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.3_Ensure_all_user_storage_CoreStorage_volumes_are_encrypted" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Enable_Gatekeeper" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.3_Enable_Firewall" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Enable_Firewall_Stealth_Mode" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.5_Review_Application_Firewall_Rules" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.9_Review_Advertising_settings" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.2_Time_Machine_Volumes_Are_Encrypted" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_Disable_Wake_for_network_access_and_Power_Nap" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Pair_the_remote_control_infrared_receiver_if_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Enable_Secure_Keyboard_Entry_in_terminal.app" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_EFI_version_is_valid_and_being_regularly_checked" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Enable_security_auditing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Retain_install.log_for_365_or_more_days" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_security_auditing_retention" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Control_access_to_audit_records" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_is_configured_to_log" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_nfs_server_is_not_running" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Check_System_Wide_Applications_for_appropriate_permissions" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_folder_for_world_writable_files" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Password_Age" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Password_History" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Use_a_separate_timestamp_for_each_usertty_combo" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Require_an_administrator_password_to_access_system-wide_preferences" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.12_Disable_ability_to_login_to_another_users_active_and_locked_session" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_custom_message_for_the_Login_Screen" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.15_Do_not_enter_a_password-related_hint" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.19_System_Integrity_Protection_status" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Remove_Guest_home_folder" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_Repairing_permissions_is_no_longer_needed" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.12_Siri_on_macOS" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.13_Apple_Watch_features_with_macOS" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.15_Unified_logging" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.16_AirDrop_security_considerations" selected="true"/>
  </xccdf:Profile>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
    <xccdf:title xml:lang="en">Level 2</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
        <xhtml:li>acts as defense in depth measure</xhtml:li>
        <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
      </xhtml:ul>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple-provided_software_is_current" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_updates_install" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_Enable_macOS_update_installs" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Show_Bluetooth_status_in_menu_bar" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Secure_screen_saver_corners" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Familiarize_users_with_screen_lock_tools_or_corner_to_Start_Screen_Saver" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.10_Disable_Content_Caching" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.1_Enable_FileVault" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.2_Ensure_all_user_storage_APFS_volumes_are_encrypted" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1.3_Ensure_all_user_storage_CoreStorage_volumes_are_encrypted" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Enable_Gatekeeper" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.3_Enable_Firewall" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Enable_Firewall_Stealth_Mode" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.5_Review_Application_Firewall_Rules" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.6_Enable_Location_Services" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.7_Monitor_Location_Services_Access" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.8_Disable_sending_diagnostic_and_usage_data_to_Apple" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.9_Review_Advertising_settings" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.1_iCloud_configuration" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.2_iCloud_keychain" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.3_iCloud_Drive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6.4_iCloud_Drive_Document_and_Desktop_sync" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.1_Time_Machine_Auto-Backup" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7.2_Time_Machine_Volumes_Are_Encrypted" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_Disable_Wake_for_network_access_and_Power_Nap" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.9_Pair_the_remote_control_infrared_receiver_if_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.10_Enable_Secure_Keyboard_Entry_in_terminal.app" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.11_Java_6_is_not_the_default_Java_runtime" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.12_Securely_delete_files_as_needed" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_EFI_version_is_valid_and_being_regularly_checked" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Enable_security_auditing" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Configure_Security_Auditing_Flags_per_local_organizational_requirements" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Retain_install.log_for_365_or_more_days" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_security_auditing_retention" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Control_access_to_audit_records" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_is_configured_to_log" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_Disable_Bonjour_advertising_service" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_Create_network_specific_locations" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_nfs_server_is_not_running" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Check_System_Wide_Applications_for_appropriate_permissions" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_folder_for_world_writable_files" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_Library_folder_for_world_writable_files" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Special_Character" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Complex_passwords_must_uppercase_and_lowercase_letters" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Password_Age" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Password_History" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4_Automatically_lock_the_login_keychain_for_inactivity" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5_Use_a_separate_timestamp_for_each_usertty_combo" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_login_keychain_is_locked_when_the_computer_sleeps" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_system_is_set_to_hibernate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.11_Require_an_administrator_password_to_access_system-wide_preferences" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.12_Disable_ability_to_login_to_another_users_active_and_locked_session" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_custom_message_for_the_Login_Screen" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.14_Create_a_Login_window_banner" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.15_Do_not_enter_a_password-related_hint" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.16_Disable_Fast_User_Switching" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.17_Secure_individual_keychains_and_items" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.18_Create_specialized_keychains_for_different_purposes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.19_System_Integrity_Protection_status" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Remove_Guest_home_folder" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.4_Use_parental_controls_for_systems_that_are_not_centrally_managed" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_Wireless_technology_on_macOS" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_iSight_Camera_Privacy_and_Confidentiality_Concerns" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_Computer_Name_Considerations" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_Software_Inventory_Considerations" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_Firewall_Consideration" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_App_Store_Automatically_download_apps_purchased_on_other_Macs_Considerations" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_Extensible_Firmware_Interface_EFI_password" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_FileVault_and_Local_Account_Password_Reset_using_AppleID" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_Repairing_permissions_is_no_longer_needed" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.11_App_Store_Password_Settings" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.12_Siri_on_macOS" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.13_Apple_Watch_features_with_macOS" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.14_System_information_backup_to_remote_computers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.15_Unified_logging" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.16_AirDrop_security_considerations" selected="true"/>
  </xccdf:Profile>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1240476_var" operator="equals" type="string">
    <title>Ensure http server is not running</title>
    <description>This value is used in Rule: Ensure http server is not running</description>
    <value>httpd</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1240478_var" operator="equals" type="string">
    <title>Ensure nfs server is not running</title>
    <description>This value is used in Rule: Ensure nfs server is not running</description>
    <value>nfsd</value>
  </Value>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Install_Updates_Patches_and_Additional_Security_Software">
    <xccdf:title xml:lang="en">Install Updates, Patches and Additional Security Software</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>Install Updates, Patches and Additional Security Software</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_Verify_all_Apple-provided_software_is_current" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Verify all Apple-provided software is current</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Software vendors release security patches and software updates for their products when security vulnerabilities are discovered. There is no simple way to complete this action without a network connection to an Apple software repository. Please ensure appropriate access for this control. This check is only for what Apple provides through software update.</xhtml:p>
        <xhtml:p>
Software updates should be run at minimum every 30 days. To verify when software update was perviously ran, run the command           <xhtml:span class="inline_block">$ sudo defaults read /Library/Preferences/com.apple.SoftwareUpdate | grep -e LastFullSuccessfulDate</xhtml:span>
. The response should be in the last 30 days (          <xhtml:em>Example</xhtml:em>
):           <xhtml:span class="inline_block">LastFullSuccessfulDate = "2020-07-30 12:45:25 +0000";</xhtml:span>
        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>It is important that these updates be applied in a timely manner to prevent unauthorized persons from exploiting the identified vulnerabilities.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to install all available software updates:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Software Update</xhtml:li>
              <xhtml:li>Select Show Updates</xhtml:li>
              <xhtml:li>Select Update All</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to verify what packages need to be installed:</xhtml:p>
            <xhtml:code class="code_block">$ sudo softwareupdate -l 
</xhtml:code>
            <xhtml:p>
The output will include:
              <xhtml:span class="inline_block">Software Update found the following new or updated software:</xhtml:span>
            </xhtml:p>
            <xhtml:p>Run the following command to install all the packages that need to be updated:</xhtml:p>
            <xhtml:code class="code_block">$ sudo softwareupdate -i -a
</xhtml:code>
            <xhtml:p>Or run the following command to install individual packages:</xhtml:p>
            <xhtml:code class="code_block">$ sudo softwareupdate -i '&lt;package name&gt;'
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example:</xhtml:em>
            </xhtml:p>
            <xhtml:code class="code_block">
$ sudo softwareupdate -l               <br/>
Software Update Tool              <br/>
              <br/>
Finding available software              <br/>
Software Update found the following new or updated software:              <br/>
   * iTunesX-12.8.2              <br/>
	iTunes (12.8.2), 273614K [recommended]              <br/>
              <br/>
$ sudo softwareupdate -i 'iTunesX-12.8.2'              <br/>
Software Update Tool              <br/>
              <br/>
              <br/>
Downloaded iTunes              <br/>
Installing iTunes              <br/>
Done with iTunes              <br/>
Done.
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Missing patches can lead to more exploit opportunities.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sce/osx_softwareupdate.sh"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_Enable_Auto_Update" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Enable Auto Update</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Auto Update verifies that your system has the newest security patches and software updates. If "Automatically check for updates" is not selected background updates for new malware definition files from Apple for XProtect and Gatekeeper will not occur.</xhtml:p>
        <xhtml:p>http://macops.ca/os-x-admins-your-clients-are-not-getting-background-security-updates/</xhtml:p>
        <xhtml:p>https://derflounder.wordpress.com/2014/12/17/forcing-xprotect-blacklist-updates-on-mavericks-and-yosemite/</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>It is important that a system has the newest updates applied so as to prevent unauthorized persons from exploiting identified vulnerabilities.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable the system to automatically check for updates:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Software Update</xhtml:li>
              <xhtml:li>Select Automatically check for updates</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to enable auto update:</xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate AutomaticCheckEnabled -bool true  
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Without automatic update, updates may not be made in a timely manner and the system will be exposed to additional risk.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197750"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_Enable_app_update_installs" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Enable app update installs</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Ensure that application updates are installed after they are available from Apple. These updates do not require reboots or admin privileges for end users.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable App Store updates to install automatically:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select App Store</xhtml:li>
              <xhtml:li>Select Install app updates</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to turn on App Store auto updating:</xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.commerce AutoUpdate -bool TRUE
</xhtml:code>
            <xhtml:p>This remediation requires a log out and log in to show in the GUI.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Unpatched software may be exploited</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197751"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4_Enable_system_data_files_and_security_updates_install" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Enable system data files and security updates install</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Ensure that system and security updates are installed after they are available from Apple. This setting enables definition updates for XProtect and Gatekeeper, with this setting in place new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require reboots or end user admin rights.</xhtml:p>
        <xhtml:p>http://www.thesafemac.com/tag/xprotect/</xhtml:p>
        <xhtml:p>https://support.apple.com/en-us/HT202491</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable system data files and security updates to install automatically:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select App Store</xhtml:li>
              <xhtml:li>Select install system data files and security updates</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following commands to enable automatically checking of system data files and security updates:</xhtml:p>
            <xhtml:code class="code_block">
$ sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate ConfigDataInstall -bool true               <br/>
              <br/>
$ sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate CriticalUpdateInstall -bool true
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Unpatched software may be exploited</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197752"/>
        </check>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197753"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5_Enable_macOS_update_installs" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Enable macOS update installs</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Ensure that macOS updates are installed after they are available from Apple. This setting enables macOS updates to be automatically installed. Some environments will want to approve and test updates before they are delivered. It is best practice to test first where updates can and have caused disruptions to operations. Automatic updates should be turned off where changes are tightly controlled and there are mature testing and approval processes. Automatic updates should not be turned off so the admin can call the users first to let them know it's ok to install. A dependable repeatable process involving a patch agent or remote management tool should be in place before auto-updates are turned off.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Patches need to be applied in a timely manner to reduce the risk of vulnerabilities being exploited</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable macOS updates to run automatically:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select App Store</xhtml:li>
              <xhtml:li>Select Install macOS updates</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to to enable automatic checking and installing of macOS updates:</xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.commerce AutoUpdateRestartRequired -bool TRUE
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Unpatched software may be exploited</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197754"/>
      </check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_System_Preferences">
    <xccdf:title xml:lang="en">System Preferences</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>
This section contains recommendations related to configurable options in the         <xhtml:em>System Preferences</xhtml:em>
 panel.      </xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Bluetooth">
      <xccdf:title xml:lang="en">Bluetooth</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Bluetooth is a short-range, low-power wireless technology commonly integrated into portable computing and communication devices and peripherals. Bluetooth is best used in a secure environment where unauthorized users have no physical access near the Mac. If Bluetooth is used, it should be secured properly (see below).</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Turn_off_Bluetooth_if_no_paired_devices_exist" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Turn off Bluetooth, if no paired devices exist</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Bluetooth devices use a wireless communications system that replaces the cables used by other peripherals to connect to a system. It is by design a peer-to-peer network technology and typically lacks centralized administration and security enforcement infrastructure.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Bluetooth is particularly susceptible to a diverse set of security vulnerabilities involving identity detection, location tracking, denial of service, unintended control and access of data and voice channels, and unauthorized device control and data access.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable Bluetooth:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Bluetooth</xhtml:li>
                <xhtml:li>Select Turn Bluetooth Off</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable Bluetooth</xhtml:p>
              <xhtml:code class="code_block">
$ sudo defaults write /Library/Preferences/com.apple.Bluetooth ControllerPowerState -int 0                <br/>
                <br/>
$ sudo killall -HUP blued
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Note:</xhtml:strong>
 When using the terminal method to disable Bluetooth, the prescribed state will not be properly show in the GUI. Use the terminal method of the audit to verify if Bluetooth is enabled/disabled.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>There have been many Bluetooth exploits , while Bluetooth can be hardened it does create a local wireless network that can be attacked to compromise both devices and information. Apple has emphasized the ease of use in Bluetooth devices so it is generally expected that Bluetooth will be used. Turning off Bluetooth with this control will also disable the Bluetooth sharing capability that is more strongly recommended against in control 2.4.7.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197755"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Show_Bluetooth_status_in_menu_bar" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Show Bluetooth status in menu bar</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>By showing the Bluetooth status in the menu bar, a small Bluetooth icon is placed in the menu bar. This icon quickly shows the status of Bluetooth, and can allow the user to quickly turn Bluetooth on or off.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Enabling "Show Bluetooth status in menu bar" is a security awareness method that helps understand the current state of Bluetooth, including whether it is enabled, Discoverable, what paired devices exist and are currently active.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to enable Bluetooth status in the menu bar:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Bluetooth</xhtml:li>
                <xhtml:li>Select Show Bluetooth in menu bar</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>For each user, run the following command to enable Bluetooth status in the menu bar</xhtml:p>
              <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.systemuiserver menuExtras -array-add "/System/Library/CoreServices/Menu Extras/Bluetooth.menu"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo -u firstuser defaults write /Users/firstuser/Library/Preferences/com.apple.systemuiserver menuExtras -array-add "/System/Library/CoreServices/Menu Extras/Bluetooth.menu" 
</xhtml:code>
              <xhtml:p>
                <xhtml:strong>Note:</xhtml:strong>
 If the remediation is run multiple times multiple instances of the Bluetooth status will appear after rebooting the system. Command-click and drag the unwanted icons off the menu bar              </xhtml:p>
              <xhtml:p>
                <xhtml:a href="http://osxdaily.com/2012/01/05/remove-icons-menu-bar-mac-os-x/">http://osxdaily.com/2012/01/05/remove-icons-menu-bar-mac-os-x/</xhtml:a>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Bluetooth is a useful wireless tool that has been widely exploited when configured improperly. The user should have insight into the Bluetooth status.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197756"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2_Date__Time">
      <xccdf:title xml:lang="en">Date&amp;Time</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
This section contains recommendations related to the configurable items under the           <xhtml:em>Date &amp; Time</xhtml:em>
 panel.        </xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Enable_Set_time_and_date_automatically" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Enable "Set time and date automatically"</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries.</xhtml:p>
          <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
 If your organization has internal time servers, enter them here. Enterprise mobile devices may need to use a mix of internal and external time servers. If multiple servers are required use the Date &amp; Time System Preference with each server separated by a space.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to enable the date and time to be set automatically:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Date &amp; Time</xhtml:li>
                <xhtml:li>Verify that Set date and time automatically is selected</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following commands to enable the date and time setting automatically:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo systemsetup -setnetworktimeserver &lt;your.time.server&gt;                <br/>
                <br/>
setNetworkTimeServer: &lt;your.time.server&gt;                <br/>
                <br/>
$ sudo systemsetup -setusingnetworktime on                <br/>
                <br/>
setUsingNetworkTime: On
              </xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo systemsetup -setnetworktimeserver time.apple.com                <br/>
                <br/>
setNetworkTimeServer: time.apple.com                <br/>
                <br/>
$ sudo systemsetup -setusingnetworktime on                <br/>
                <br/>
setUsingNetworkTime: On
              </xhtml:code>
              <xhtml:p>Run the following commands if you have not set, or need to set, a new time zone:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo systemsetup -listtimezones                <br/>
                <br/>
$ sudo systemsetup -settimezone &lt;selected time zone&gt;                <br/>
              </xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo systemsetup -listtimezones                <br/>
                <br/>
Time Zones:                <br/>
 Africa/Abidjan                <br/>
 Africa/Accra                <br/>
 Africa/Addis_Ababa                <br/>
 Africa/Algiers                <br/>
 ...                <br/>
 Pacific/Truk                <br/>
 Pacific/Wake                <br/>
 Pacific/Wallis                <br/>
                <br/>
$ sudo systemsetup -settimezone America/New_York                <br/>
                <br/>
Set TimeZone: America/New_York
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Apple's automatic time update solution will enable an NTP server that is not controlled by the Application Firewall. Turning on "Set time and date automatically" allows other computers to connect to set their time and allows for exploit attempts against ntpd. It also allows for more accurate network detection and OS fingerprinting</xhtml:p>
                <xhtml:p>Current testing shows scanners can easily determine the MAC address and the OS vendor. More extensive OS fingerprinting may be possible.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197757"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_time_set_is_within_appropriate_limits" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure time set is within appropriate limits</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Correct date and time settings are required for authentication protocols, file creation, modification dates and log entries. Ensure that time on the computer is within acceptable limits. Truly accurate time is measured within milliseconds, for this audit a drift under four and a half minutes passes the control check. Since Kerberos is one of the important features of macOS integration into Directory systems the guidance here is to warn you before there could be an impact to operations. From the perspective of accurate time this check is not strict, it may be too great for your organization, adjust to a smaller offset value as needed.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>The associated check will fail if no network connection is available.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kerberos may not operate correctly if the time on the Mac is off by more than 5 minutes. This in turn can affect Apple's single sign-on feature, Active Directory logons, and other features. Audit check is for more than 4 minutes and 30 seconds ahead or behind.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following commands to ensure your time is set within an appropriate limit:</xhtml:p>
              <xhtml:code class="code_block">$ sudo systemsetup -getnetworktimeserver    
</xhtml:code>
              <xhtml:p>
The output will include                 <xhtml:span class="inline_block">Network Time Server: </xhtml:span>
 and the name of your time server
                <xhtml:em>example</xhtml:em>
:                 <xhtml:span class="inline_block">Network Time Server: time.apple.com</xhtml:span>
              </xhtml:p>
              <xhtml:code class="code_block">$ sudo ntpdate -sv &lt;your.time.server&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo sudo systemsetup -getnetworktimeserver                <br/>
                <br/>
Network Time Server: time.apple.com                <br/>
                <br/>
$ sudo ntpdate -sv time.apple.com
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Accurate time is required for many computer functions.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1197758"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.3_Desktop__Screen_Saver">
      <xccdf:title xml:lang="en">Desktop&amp;Screen Saver</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations related to the configurable items under the Desktop &amp; Screen Saver panel.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Set_an_inactivity_interval_of_20_minutes_or_less_for_the_screen_saver" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Set an inactivity interval of 20 minutes or less for the screen saver</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>A locking screensaver is one of the standard security controls to limit access to a computer and the current user's session when the computer is temporarily unused or unattended. In macOS the screensaver starts after a value selected in a drop down menu, 10 minutes and 20 minutes are both options and either is acceptable. Any value can be selected through the command line or script but a number that is not reflected in the GUI can be problematic. 20 minutes is the default for new accounts.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Setting an inactivity interval for the screensaver prevents unauthorized persons from viewing a system left unattended for an extensive period of time.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to set the screen saver to activate in 20 minutes of less:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Desktop &amp; Screen Saver</xhtml:li>
                <xhtml:li>Select Screen Saver</xhtml:li>
                <xhtml:li>Select on option for Start after that is 20 minutes of less (≤1200)</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to verify that the idle time of the screen saver to 20 minutes of less (≤1200)</xhtml:p>
              <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults -currentHost write com.apple.screensaver idleTime -int &lt;value ≤1200&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo defaults -currentHost write com.apple.screensaver idleTime -int 600
</xhtml:code>
              <xhtml:p>If there are multiple users out of compliance with the prescribed setting, run this command for each user to set their idle time:</xhtml:p>
              <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults -currentHost write com.apple.screensaver idleTime -int &lt;value ≤1200&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo -u seconduser defaults -currentHost write com.apple.screensaver idleTime -int 600                <br/>
                <br/>
$ sudo -u seconduser defaults -currentHost read com.apple.screensaver idleTime                <br/>
                <br/>
600
              </xhtml:code>
              <xhtml:p>Issues arise if the command line is used to make the setting something other than what is available in the GUI Menu. Choose either 1 (60), 2 (120), 5 (300), 10 (600), or 20 (120) minutes to avoid any issues.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>If the screensaver is not set users may leave the computer available for an unauthorized person to access information.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_inactivity_interval_screen_savor.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Secure_screen_saver_corners" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Secure screen saver corners</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Hot Corners can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Setting a hot corner to disable the screen saver poses a potential security risk since an unauthorized person could use this to bypass the login screen and gain access to the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable a Hot Corner set to Disable Screen Saver:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Desktop &amp; Screen Saver</xhtml:li>
                <xhtml:li>Select Screen Saver</xhtml:li>
                <xhtml:li>Select Hot Corners... and turn off any corner that is set to Disable Screen Saver</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to turn off Disable Screen Saver for a Hot Corner:</xhtml:p>
              <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write com.apple.dock &lt;corner that is set to '6'&gt; -int 0
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo -u seconduser defaults write com.apple.dock wvous-tl-corner -int 0                <br/>
                <br/>
$ sudo -u seconduser defaults read com.apple.dock wvous-tl-corner                <br/>
                <br/>
0
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207368"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Familiarize_users_with_screen_lock_tools_or_corner_to_Start_Screen_Saver" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Familiarize users with screen lock tools or corner to Start Screen Saver</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>In 10.13 Apple added a "Lock Screen" option to the Apple Menu. Prior to this the best quick lock options were to use either a lock screen option with the screen saver or the lock screen option from Keychain Access if status was made available in the menu bar. With 10.13 the menu bar option is no longer available.
The intent of this control is to resemble control-alt-delete on Windows Systems as a means of quickly locking the screen. If the user of the system is stepping away from the computer the best practice is to lock the screen and setting a hot corner is an appropriate method.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Ensuring the user has a quick method to lock their screen may reduce opportunity for individuals in close physical proximity of the device to see screen contents.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to set a Hot Corner to either Start Screen Saver or Put Display to Sleep:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Desktop &amp; Screen Saver</xhtml:li>
                <xhtml:li>Select Screen Saver</xhtml:li>
                <xhtml:li>Select Hot Corners... and turn on either/both Start Screen Saver or Put Display to Sleep</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>For all users, run the following commands to set Start Screen Saver or Put Display to Sleep as a Hot Corner:</xhtml:p>
              <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults read com.apple.dock &lt;corner&gt; -int &lt;5 or 10&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo -u seconduser defaults write com.apple.dock wvous-tl-corner -int 10                <br/>
                <br/>
$ sudo -u seconduser defaults read com.apple.dock wvous-tl-corner                <br/>
                <br/>
10                <br/>
                <br/>
$ sudo -u seconduser defaults write com.apple.dock wvous-bl-corner -int 5                <br/>
                <br/>
$ sudo -u seconduser defaults read com.apple.dock wvous-bl-corner                <br/>
                <br/>
10
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.4_Sharing">
      <xccdf:title xml:lang="en">Sharing</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
This section contains recommendations related to the configurable items under the           <xhtml:em>Sharing</xhtml:em>
 panel.        </xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Disable_Remote_Apple_Events" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Remote Apple Events</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apple Events is a technology that allows one program to communicate with other programs. Remote Apple Events allows a program on one computer to communicate with a program on a different computer.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling Remote Apple Events mitigates the risk of an unauthorized program gaining access to the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable Remote Apple Events:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Verify that Remote Apple Evens is not set</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following commands to set Remote Apple Events to Off:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo systemsetup -setremoteappleevents off                 <br/>
                <br/>
setremoteappleevents: Off
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>With remote Apple events turned on, an AppleScript program running on another Mac can interact with the local computer.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207759"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Disable_Internet_Sharing" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Internet Sharing</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Internet Sharing uses the open source             <xhtml:span class="inline_block">natd</xhtml:span>
 process to share an internet connection with other computers and devices on a local network. This allows the Mac to function as a router and share the connection to other, possibly unauthorized, devices.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling Internet Sharing reduces the remote attack surface of the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">STIGID AOSX-12-001270</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable Internet Sharing:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck Internet Sharing</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to turn off Internet Sharing:</xhtml:p>
              <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/SystemConfiguration/com.apple.nat NAT -dict Enabled -int 0
</xhtml:code>
              <xhtml:p>
                <xhtml:strong>Note:</xhtml:strong>
 Using the Terminal Method will not uncheck the setting in System Preferences&gt;Sharing but will disable the underlying service.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Internet sharing allows the computer to function as a router and other computers to use it for access. This can expose both the computer itself and the networks it is accessing to unacceptable access from unapproved devices.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207760"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207761"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Disable_Screen_Sharing" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Screen Sharing</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Screen sharing allows a computer to connect to another computer on a network and display the computer’s screen. While sharing the computer’s screen, the user can control what happens on that computer, such as opening documents or applications, opening, moving, or closing windows, and even shutting down the computer.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling screen sharing mitigates the risk of remote connections being made without the user of the console knowing that they are sharing the computer.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://support.apple.com/kb/ph11151</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable Screen Sharing:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck Screen Sharing</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to turn off Screen Sharing:</xhtml:p>
              <xhtml:code class="code_block">$ sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.screensharing.plist
</xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207762"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Disable_Printer_Sharing" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Printer Sharing</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>By enabling Printer sharing the computer is set up as a print server to accept print jobs from other computers. Dedicated print servers or direct IP printing should be used instead.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling Printer Sharing mitigates the risk of attackers attempting to exploit the print server to gain access to the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">http://support.apple.com/kb/PH11450</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable printer sharing:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck Printer Sharing</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable printer sharing:</xhtml:p>
              <xhtml:code class="code_block">$ sudo cupsctl --no-share-printers
</xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_printshare.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.5_Disable_Remote_Login" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Remote Login</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Remote Login allows an interactive terminal connection to a computer.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>
              <xhtml:span class="inline_block">man sshd_config</xhtml:span>
            </xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling Remote Login mitigates the risk of an unauthorized person gaining access to the system via Secure Shell (SSH). While SSH is an industry standard to connect to posix servers, the scope of the benchmark is for Apple macOS clients, not servers.</xhtml:p>
          <xhtml:p>macOS does have an IP based firewall available (pf, ipfw has been deprecated) that is not enabled or configured. There are more details and links in section 7.5. macOS no longer has TCP Wrappers support built-in and does not have strong Brute-Force password guessing mitigations, or frequent patching of openssh by Apple. Most macOS computers are mobile workstations, managing IP based firewall rules on mobile devices can be very resource intensive. All of these factors can be parts of running a hardened SSH server.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable remote login:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck Remote Login</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable remote login:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo systemsetup -setremotelogin off                <br/>
                <br/>
Do you really want to turn remote login off? If you do, you will lose this connection and can only turn it back on locally at the server (yes/no)?
              </xhtml:code>
              <xhtml:p>Entering yes will disable remote login.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The SSH server built-in to macOS should not be enabled on a standard user computer, particularly one that changes locations and IP addresses. A standard user that runs local applications including email, web browser and productivity tools should not use the same device as a server. There are Enterprise management tool-sets that do utilize SSH, if they are in use, the computer should be locked down to only respond to known trusted IP addresses and appropriate admin service accounts.</xhtml:p>
                <xhtml:p>For macOS computers that are being used for specialized functions there are several options to harden the SSH server to protect against unauthorized access including brute force attacks. There are some basic criteria that need to be considered:</xhtml:p>
                <xhtml:ul>
                  <xhtml:li>Do not open an SSH server to the internet without controls in place to mitigate SSH brute force attacks, this is particularly important for systems bound to Directory environments. It is great to have controls in place to protect the system but if they trigger after the user is already locked out of their account they are not optimal. If authorization happens after authentication directory accounts for users that don't even use the system can be locked out.</xhtml:li>
                  <xhtml:li>Do not use SSH key pairs when there is no insight to the security on the client system that will authenticate into the server with a private key. If an attacker gets access to the remote system and can find the key they may not need a password or a key logger to access the SSH server.</xhtml:li>
                  <xhtml:li>Detailed instructions on hardening an SSH server, if needed, are available in the CIS Linux Benchmarks but it is beyond the scope of this benchmark</xhtml:li>
                </xhtml:ul>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207763"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.6_Disable_DVD_or_CD_Sharing" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable DVD or CD Sharing</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>DVD or CD Sharing allows users to remotely access the system's optical drive.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling DVD or CD Sharing minimizes the risk of an attacker using the optical drive as a vector for attack and exposure of sensitive data.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable DVD or CD sharing:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck DVD or CD sharing</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable DVD or CD sharing:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.ODSAgent.plist                <br/>
                <br/>
/System/Library/LaunchDaemons/com.apple.ODSAgent.plist: Operation now in progress
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Note:</xhtml:strong>
 If using the Terminal method, the GUI will still show the service checked until after a reboot.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Many Apple devices are now sold without optical drives and drive sharing may be needed for legacy optical media.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_dvd_cd_share.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.7_Disable_Bluetooth_Sharing" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Bluetooth Sharing</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Bluetooth Sharing allows files to be exchanged with Bluetooth enabled devices.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling Bluetooth Sharing minimizes the risk of an attacker using Bluetooth to remotely attack the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable Bluetooth Sharing:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck Bluetooth Sharing</xhtml:li>
              </xhtml:ol>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Control 2.1.1 discusses disabling Bluetooth if no paired devices exist. There is a general expectation that Bluetooth peripherals will be used by most users in Apple's ecosystem, it is possible that sharing is required and Bluetooth peripherals are not. Bluetooth must be enabled if sharing is an acceptable use case.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207765"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.8_Disable_File_Sharing" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable File Sharing</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apple's File Sharing uses a combination of SMB (Windows sharing) and AFP (Mac sharing)</xhtml:p>
          <xhtml:p>Two common ways to share files using File Sharing are:</xhtml:p>
          <xhtml:ol>
            <xhtml:li>Apple File Protocol (AFP) AFP automatically uses encrypted logins, so this method of sharing files is fairly secure. The entire hard disk is shared to administrator user accounts. Individual home folders are shared to their respective user accounts. Users' "Public" folders (and the "Drop Box" folder inside) are shared to any user account that has sharing access to the computer (i.e. anyone in the "staff" group, including the guest account if it is enabled).</xhtml:li>
            <xhtml:li>Server Message Block (SMB), Common Internet File System (CIFS) When Windows (or possibly Linux) computers need to access file shared on a Mac, SMB/CIFS file sharing is commonly used. Apple warns that SMB sharing stores passwords is a less secure fashion than AFP sharing and anyone with system access can gain access to the password for that account. When sharing with SMB, each user that will access the Mac must have SMB enabled.</xhtml:li>
          </xhtml:ol>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>By disabling file sharing, the remote attack surface and risk of unauthorized access to files stored on the system is reduced.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable File Sharing:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck File Sharing</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable both AFP and SMB file sharing:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.AppleFileServer.plist                 <br/>
                <br/>
$ sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.smbd.plist
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>File Sharing can be used to share documents with other users but hardened servers should be used rather than user endpoints. Turning on file sharing increases the visibility and attack surface of a system unnecessarily.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_file_share.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.9_Disable_Remote_Management" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Remote Management</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Remote Management is the client portion of Apple Remote Desktop (ARD). Remote Management can be used by remote administrators to view the current Screen, install software, report on, and generally manage client Macs.</xhtml:p>
          <xhtml:p>The screen sharing options in Remote Management are identical to those in the Screen Sharing section. In fact, only one of the two can be configured. If Remote Management is used, refer to the Screen Sharing section above on issues regard screen sharing.</xhtml:p>
          <xhtml:p>Remote Management should only be enabled when a Directory is in place to manage the accounts with access. Computers will be available on port 5900 on a macOS System and could accept connections from untrusted hosts depending on the configuration, definitely a concern for mobile systems.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>
              <xhtml:span class="inline_block">/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -help</xhtml:span>
            </xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Remote management should only be enabled on trusted networks with strong user controls present in a Directory system. Mobile devices without strict controls are vulnerable to exploit and monitoring.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable remote management:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Sharing</xhtml:li>
                <xhtml:li>Uncheck Remote Management</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable remote management:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -stop                <br/>
                <br/>
Starting...                <br/>
Removed preference to start ARD after reboot.                <br/>
Done.
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Many organizations utilize ARD for client management.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_ardagent.sh"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.10_Disable_Content_Caching" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable Content Caching</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Starting with 10.13 (macOS High Sierra) Apple introduced a service to make it easier deploy data from Apple, including software updates, where there are bandwidth constraints to the Internet and fewer constraints and greater bandwidth on the local subnet. This capability can be very valuable for organizations that have throttled and possibly metered Internet connections. In heterogeneous enterprise networks with multiple subnets the effectiveness of this capability would be determined on how many Macs were on each subnet at the time new large updates were made available upstream.
This capability requires the use of mac OS clients as P2P nodes for updated Apple content. Unless there is a business requirement to manage operational Internet connectivity bandwidth user endpoints should not store content and act as a cluster to provision data.</xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://support.apple.com/en-us/HT204675">Content types supported by content caching in macOS</xhtml:a>
          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>
              <xhtml:a href="https://support.apple.com/guide/mac-help/about-content-caching-mchl9388ba1b/10.15/mac/10.15">About content caching</xhtml:a>
              <xhtml:a href="https://support.apple.com/en-us/HT204675">Content types supported by content caching</xhtml:a>
              <xhtml:a href="https://support.apple.com/guide/mac-help/set-up-content-caching-on-mac-mchl3b6c3720/10.15/mac/10.15">Set up content caching</xhtml:a>
            </xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The main use case for Mac computers is as mobile user endpoints. P2P sharing services should not be enabled on laptops that are using untrusted networks. Content Caching can allow a computer to be a server for local nodes on an untrusted network. While there are certainly logical controls that could be used to mitigate risk they add to the management complexity, since the value of the service is in specific use cases organizations with the use case described above can accept risk as necessary.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable content caching:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Sharing</xhtml:li>
                <xhtml:li>Uncheck Content Caching</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command in to disable content caching:</xhtml:p>
              <xhtml:code class="code_block">$ sudo AssetCacheManagerUtil deactivate
</xhtml:code>
              <xhtml:p>
The output will include                 <xhtml:span class="inline_block">Content caching deactivated</xhtml:span>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>This setting will adversely affect bandwidth usage between local subnets and the Internet.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207769"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5_Security__Privacy">
      <xccdf:title xml:lang="en">Security&amp;Privacy</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
This section contains recommendations for configurable options under the           <xhtml:em>Security &amp; Privacy</xhtml:em>
 panel.        </xhtml:p>
        <xhtml:p>
          <xhtml:a href="https://support.apple.com/guide/mac-help/privacy-preferences-mh32356/10.13/mac/10.13">Additional privacy preference information form Apple</xhtml:a>
        </xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5.1_Encryption">
        <xccdf:title xml:lang="en">Encryption</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apple has created simple easy to use encryption capabilities built-in to macOS. In order to protect data and privacy those tools need to be utilized to protect information processed by macOS computers</xhtml:p>
        </xccdf:description>
        <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1.1_Enable_FileVault" role="full" selected="false" weight="1.0">
          <xccdf:title xml:lang="en">Enable FileVault</xccdf:title>
          <xccdf:description xml:lang="en">
            <xhtml:p>FileVault secures a system's data by automatically encrypting its boot volume and requiring a password or recovery key to access it.</xhtml:p>
            <xhtml:p>
Filevault may also be enabled using command line using the               <xhtml:span class="inline_block">fdesetup</xhtml:span>
 command. To use this functionality, consult the Der Flounder blog for more details:            </xhtml:p>
            <xhtml:p>
              <xhtml:a href="https://derflounder.wordpress.com/2015/02/02/managing-yosemites-filevault-2-with-fdesetup/">https://derflounder.wordpress.com/2015/02/02/managing-yosemites-filevault-2-with-fdesetup/</xhtml:a>
              <xhtml:a href="https://derflounder.wordpress.com/2019/01/15/unlock-or-decrypt-your-filevault-encrypted-boot-drive-from-the-command-line-on-macos-mojave/">https://derflounder.wordpress.com/2019/01/15/unlock-or-decrypt-your-filevault-encrypted-boot-drive-from-the-command-line-on-macos-mojave/</xhtml:a>
            </xhtml:p>
          </xccdf:description>
          <xccdf:metadata>
            <notes:notes xml:lang="en">
              <xhtml:p>FileVault may not be desirable on a virtual OS. As long as the hypervisor and file storage are encrypted the virtual OS does not need to be. Rather than checking if the OS is virtual and passing the control regardless of the encryption of the host system the normal check will be run. Security officials can evaluate the comprehensive controls outside of the OS being tested.</xhtml:p>
            </notes:notes>
          </xccdf:metadata>
          <xccdf:rationale xml:lang="en">
            <xhtml:p>Encrypting sensitive data minimizes the likelihood of unauthorized users gaining access to it.</xhtml:p>
          </xccdf:rationale>
          <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
          <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
          <xccdf:fixtext xml:lang="en">
            <xhtml:div>
              <xhtml:p>
                <xhtml:p>Perform the following to enable FileVault:</xhtml:p>
                <xhtml:p>
                  <xhtml:em>Graphical Method:</xhtml:em>
                </xhtml:p>
                <xhtml:ol>
                  <xhtml:li>Open System Preferences</xhtml:li>
                  <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                  <xhtml:li>Select FileVault</xhtml:li>
                  <xhtml:li>Select Turn on FileVault</xhtml:li>
                </xhtml:ol>
                <xhtml:p class="bold">Impact:</xhtml:p>
                <xhtml:p>
                  <xhtml:p>Mounting a FileVaulted volume from an alternate boot source will require a valid password to decrypt it.</xhtml:p>
                </xhtml:p>
              </xhtml:p>
            </xhtml:div>
          </xccdf:fixtext>
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_fdesetup_status.sh"/>
          </check>
        </xccdf:Rule>
        <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1.2_Ensure_all_user_storage_APFS_volumes_are_encrypted" role="unscored" selected="false" weight="0.0">
          <xccdf:title xml:lang="en">Ensure all user storage APFS volumes are encrypted</xccdf:title>
          <xccdf:description xml:lang="en">
            <xhtml:p>Apple developed a new file system that was first made available in 10.12 and then became the default in 10.13. The file system is optimized for Flash and Solid State storage and encryption.
https://en.wikipedia.org/wiki/Apple_File_System
macOS computers generally have several volumes created as part of APFS formatting including Preboot, Recovery and Virtual Memory (VM) as well as traditional user disks.</xhtml:p>
            <xhtml:p>All APFS volumes that do not have specific roles that do not require encryption should be encrypted. "Role" disks include Preboot, Recovery and VM. User disks are labelled with "(No specific role)" by default.</xhtml:p>
          </xccdf:description>
          <xccdf:rationale xml:lang="en">
            <xhtml:p>In order to protect user data from loss or tampering volumes carrying data should be encrypted</xhtml:p>
          </xccdf:rationale>
          <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
          <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
          <xccdf:fixtext xml:lang="en">
            <xhtml:div>
              <xhtml:p>
                <xhtml:p>Use Disk Utility to erase a user disk and format as APFS (Encrypted)</xhtml:p>
                <xhtml:p>
                  <xhtml:strong>Note:</xhtml:strong>
 APFS Encrypted disks will be described as "FileVault" whether they are the boot volume or not in the ap list                </xhtml:p>
                <xhtml:p class="bold">Impact:</xhtml:p>
                <xhtml:p>
                  <xhtml:p>While FileVault protects the boot volume data may be copied to other attached storage and reduce the protection afforded by FileVault. Ensure all user volumes are encrypted to protect data.</xhtml:p>
                </xhtml:p>
              </xhtml:p>
            </xhtml:div>
          </xccdf:fixtext>
        </xccdf:Rule>
        <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1.3_Ensure_all_user_storage_CoreStorage_volumes_are_encrypted" role="unscored" selected="false" weight="0.0">
          <xccdf:title xml:lang="en">Ensure all user storage CoreStorage volumes are encrypted</xccdf:title>
          <xccdf:description xml:lang="en">
            <xhtml:p>Apple introduced Core Storage with 10.7. It is used as the default for formatting on macOS volumes prior to 10.13.</xhtml:p>
            <xhtml:p>All HFS and Core Storage Volumes should be encrypted</xhtml:p>
          </xccdf:description>
          <xccdf:rationale xml:lang="en">
            <xhtml:p>In order to protect user data from loss or tampering volumes carrying data should be encrypted</xhtml:p>
          </xccdf:rationale>
          <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
          <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
          <xccdf:fixtext xml:lang="en">
            <xhtml:div>
              <xhtml:p>
                <xhtml:p>Use Disk Utility to erase a disk and format as macOS Extended (Journaled, Encrypted)</xhtml:p>
                <xhtml:p class="bold">Impact:</xhtml:p>
                <xhtml:p>
                  <xhtml:p>While FileVault protects the boot volume data may be copied to other attached storage and reduce the protection afforded by FileVault. Ensure all user volumes are encrypted to protect data.</xhtml:p>
                </xhtml:p>
              </xhtml:p>
            </xhtml:div>
          </xccdf:fixtext>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Enable_Gatekeeper" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Enable Gatekeeper</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Gatekeeper is Apple's application white-listing control that restricts downloaded applications from launching. It functions as a control to limit applications from unverified sources from running without authorization.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disallowing unsigned software will reduce the risk of unauthorized or malicious applications from running on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to implement the prescribed state:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select General</xhtml:li>
                <xhtml:li>Set Allow apps downloaded from to Mac App Store and identified developers</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to enable Gatekeeper to allow applications from App Store and identified developers:</xhtml:p>
              <xhtml:code class="code_block">$ sudo spctl --master-enable
</xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207771"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.3_Enable_Firewall" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Enable Firewall</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.</xhtml:p>
          <xhtml:p>
            <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>
              <xhtml:a href="http://docs.info.apple.com/article.html?artnum=306938">http://docs.info.apple.com/article.html?artnum=306938</xhtml:a>
            </xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A firewall minimizes the threat of unauthorized users from gaining access to your system while connected to a network or the Internet.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to turn the firewall on:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select Firewall</xhtml:li>
                <xhtml:li>Select Turn On Firewall</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to enable the firewall:</xhtml:p>
              <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.alf globalstate -int &lt;value&gt;
</xhtml:code>
              <xhtml:p>
For the                 <xhtml:span class="inline_block">&lt;value&gt;</xhtml:span>
, use either                 <xhtml:span class="inline_block">1</xhtml:span>
, specific services, or                 <xhtml:span class="inline_block">2</xhtml:span>
, essential services only.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The firewall may block legitimate traffic. Applications that are unsigned will require special handling.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207772"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207773"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Enable_Firewall_Stealth_Mode" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Enable Firewall Stealth Mode</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>While in Stealth mode the computer will not respond to unsolicited probes, dropping that traffic.</xhtml:p>
          <xhtml:p>
            <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>
              <xhtml:a href="http://docs.info.apple.com/article.html?artnum=306938">http://docs.info.apple.com/article.html?artnum=306938</xhtml:a>
            </xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Stealth mode on the firewall minimizes the threat of system discovery tools while connected to a network or the Internet.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to enable stealth mode:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select Firewall Options</xhtml:li>
                <xhtml:li>Turn on Enable stealth mode</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to enable stealth mode:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode on                <br/>
                <br/>
Stealth mode enabled
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Traditional network discovery tools like ping will not succeed. Other network tools that measure activity and approved applications will work as expected.</xhtml:p>
                <xhtml:p>This control aligns with the primary macOS use case of a laptop that is often connected to untrusted networks where host segregation may be non-existent. In that use case hiding from the other inmates is likely more than desirable. In use cases where use is only on trusted LANs with static IP addresses stealth mode may not be desirable.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207774"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.5_Review_Application_Firewall_Rules" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Review Application Firewall Rules</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>A firewall is a piece of software that blocks unwanted incoming connections to a system. Apple has posted general documentation about the application firewall.</xhtml:p>
          <xhtml:p>
            <xhtml:a href="http://support.apple.com/en-us/HT201642">http://support.apple.com/en-us/HT201642</xhtml:a>
          </xhtml:p>
          <xhtml:p>A computer should have a limited number of applications open to incoming connectivity.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A firewall minimizes the threat of unauthorized users from gaining access to your system while connected to a network or the Internet. Which applications are allowed access to accept incoming connections through the firewall is important to understand.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to remove unnecessary firewall rules:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select Firewall Options</xhtml:li>
                <xhtml:li>Select unneeded rule(s)</xhtml:li>
                <xhtml:li>Select the minus sign below to delete them</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to remove specific applications:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo /usr/libexec/ApplicationFirewall/socketfilterfw --remove &lt;/path/application name&gt;                <br/>
                <br/>
Application at path ( &lt;/path/application name&gt; ) removed from firewall
              </xhtml:code>
              <xhtml:p>
The                 <xhtml:span class="inline_block">&lt;/path/application name&gt;</xhtml:span>
 is the one to be removed from the previous listing              </xhtml:p>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo /usr/libexec/ApplicationFirewall/socketfilterfw --listapps                   <br/>
ALF: total number of apps = 3                 <br/>
                <br/>
1 :  /System/Library/CoreServices/RemoteManagement/ARDAgent.app                 <br/>
 	 ( Allow incoming connections )                 <br/>
                <br/>
2 :  /Applications/Chess.app                 <br/>
 	 ( Allow incoming connections )                 <br/>
                <br/>
3 :  /Applications/Contacts.app                 <br/>
 	 ( Block incoming connections )                 <br/>
                <br/>
$ sudo /usr/libexec/ApplicationFirewall/socketfilterfw --remove /Applications/Chess.app                <br/>
                <br/>
Application at path ( /Applications/Chess.app ) removed from firewall 
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_firewall_rule_10_or_less.sh"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.6_Enable_Location_Services" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Enable Location Services</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>macOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. Users do not need to change the time or the time zone, the computer will do it for them. They do not need to specify their location for weather or travel times and even get alerts on travel times to meetings and appointment where location information is supplied.</xhtml:p>
          <xhtml:p>For the purpose of asset management and time and log management with mobile computers location services simplify some processes.</xhtml:p>
          <xhtml:p>There are some use cases where it is important that the computer not be able to report it's exact location. While the general use case is to enable Location Services, it should not be allowed if the physical location of the computer and the user should not be public knowledge.</xhtml:p>
          <xhtml:p>https://support.apple.com/en-us/HT204690</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Location services are helpful in most use cases and can simplify log and time management where computers change time zones.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to enable location services:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select Privacy</xhtml:li>
                <xhtml:li>Select Enable Location Services</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to enable location services</xhtml:p>
              <xhtml:code class="code_block">$ sudo launchctl load /System/Library/LaunchDaemons/com.apple.locationd.plist
</xhtml:code>
              <xhtml:p>
                <xhtml:strong>Note:</xhtml:strong>
 In some use cases organizations may not want Location Services running. To disable location services, System Integrity Protection must be disabled.              </xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_locservice.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.7_Monitor_Location_Services_Access" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Monitor Location Services Access</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>macOS uses location information gathered through local Wi-Fi networks to enable applications to supply relevant information to users. While location services may be very useful it may not be desirable to allow all applications that can use location services to use your location for Internet queries to provide tailored content based on your current location.</xhtml:p>
          <xhtml:p>Ensure that the applications that can use Location Services are authorized to use that information and provide that information where the application interacts with external systems. Apple provides feedback within System Preferences and may be enabled to provide information on the menu bar when Location Services are used.</xhtml:p>
          <xhtml:p>Safari can deny access from websites or prompt for access.</xhtml:p>
          <xhtml:p>Applications that support Location Services can be individually controlled in the Privacy tab in Security &amp; Privacy under System Preferences.</xhtml:p>
          <xhtml:p>Access should be evaluated to ensure that privacy controls are as expected.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Privacy controls should be monitored for appropriate settings</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable unnecessary applications from accessing location services:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select Privacy</xhtml:li>
                <xhtml:li>Select Location Services</xhtml:li>
                <xhtml:li>Uncheck applications that are not approved for access to location service information</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Perform the following to set websites to ask for permission to access location services:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open Safari</xhtml:li>
                <xhtml:li>Select Safari from the menu bar</xhtml:li>
                <xhtml:li>Select Websites</xhtml:li>
                <xhtml:li>Select Location</xhtml:li>
                <xhtml:li>Set When visiting other websites to Ask or Deny</xhtml:li>
              </xhtml:ol>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Many macOS services rely on location services for tailored services. Users expect their time zone and weather to be relevant to where they are without manual intervention. Find my Mac does need to know where your Mac actually is. Where possible the tolerance between location privacy and convenience may be best left to the user when the location itself is not sensitive. If facility locations are not public location information should be tightly controlled</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.8_Disable_sending_diagnostic_and_usage_data_to_Apple" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable sending diagnostic and usage data to Apple</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apple provides a mechanism to send diagnostic and analytics data back to Apple to help them improve the platform. Information sent to Apple may contain internal organizational information that should be controlled and not available for processing by Apple.
Turn off all Analytics and Improvements sharing.</xhtml:p>
          <xhtml:p>Share Mac Analytics (Share with App Developers dependent on Mac Analytic sharing)</xhtml:p>
          <xhtml:ul>
            <xhtml:li>Includes diagnostics, usage and location data</xhtml:li>
          </xhtml:ul>
          <xhtml:p>Share iCloud Analytics</xhtml:p>
          <xhtml:ul>
            <xhtml:li>Includes iCloud data and usage information</xhtml:li>
          </xhtml:ul>
          <xhtml:p>
            <xhtml:a href="https://support.apple.com/guide/mac-help/share-analytics-information-with-apple-mh27990/10.13/mac/10.13">Share analytics information from your Mac with Apple</xhtml:a>
          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Organizations should have knowledge of what is shared with the vendor and the setting automatically forwards information to Apple.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable diagnostic data being sent to Apple:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select Privacy</xhtml:li>
                <xhtml:li>Select Analytics &amp; Improvements</xhtml:li>
                <xhtml:li>Uncheck "Share Mac Analytics"</xhtml:li>
                <xhtml:li>Uncheck "Share iCloud Analytics"</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo defaults write /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist AutoSubmit -bool false                <br/>
                <br/>
$ sudo chmod 644 /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist                <br/>
                <br/>
$ sudo chgrp admin /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist
              </xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_senddiagnostics.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.9_Review_Advertising_settings" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Review Advertising settings</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apple provides a framework that allows advertisers to target Apple users and end users to tailor their tolerance for what is shared with advertisers and what amount of targeting they will accept. While many people prefer that when they see advertising it is relevant to them and their interests the detailed information that is available with data mining collected information available in repositories to advertisers is often disconcerting.</xhtml:p>
          <xhtml:p>Organizations may prefer to manage advertising settings on managed computers rather than allow users to configure the settings.</xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://support.apple.com/en-us/HT205223">Apple Information</xhtml:a>
          </xhtml:p>
          <xhtml:p>On macOS one suggested control is to limit ad tracking.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Organizations should manage user provacy settings on managed devices to align with organizational policies and user data protection requirements.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to set limited ad tracking:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Security &amp; Privacy</xhtml:li>
                <xhtml:li>Select Privacy</xhtml:li>
                <xhtml:li>Select Advertising</xhtml:li>
                <xhtml:li>Set Limit Ad Tracking</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>For each needed user, run the following command to enable limited ad tracking:</xhtml:p>
              <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults -currentHost write /Users/&lt;username&gt;/Library/Preferences/com.apple.Adlib.plist forceLimitAdTracking -bool true
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo -u seconduser defaults -currentHost write /Users/seconduser/Library/Preferences/com.apple.Adlib.plist forceLimitAdTracking -bool true
</xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1246172"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.6_iCloud">
      <xccdf:title xml:lang="en">iCloud</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>iCloud is Apple's service for synchronizing, storing and backing up data from Apple applications in both macOS and iOS</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.1_iCloud_configuration" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">iCloud configuration</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apple's iCloud is a consumer oriented service that allows a user to store data as well as find, control and backup devices that are associated with their Apple ID (Apple account.) The use of iCloud on Enterprise devices should align with the acceptable use policy for devices that are managed as well as confidentiality requirements for data handled by the user. If iCloud is allowed the data that is copied to Apple servers will likely be duplicated on both personal as well as Enterprise devices.</xhtml:p>
          <xhtml:p>For many users the Enterprise email system may replace many of the available features in iCloud. If using either an Exchange or Google environment email, calendars, notes and contacts can sync to the official Enterprise repository and be available through multiple devices.</xhtml:p>
          <xhtml:p>Depending on workplace requirements it may not be appropriate to intermingle Enterprise and personal bookmarks, photos and documents. Since the service allows every device associated with the users ID to synchronize and have access to the cloud storage the concern is not just about having sensitive data on Apple's servers but having that same data on the phone of the teenage son or daughter of an employee. The use of family sharing options can reduce the risk.</xhtml:p>
          <xhtml:p>Apple's iCloud is just one of many cloud based solutions being used for data synchronization across multiple platforms and it should be controlled consistently with other cloud services in your environment. Work with your employees and configure the access to best enable data protection for your mission.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Organizations must make a risk decision on how their computers will interact with public cloud services.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable unapproved services</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select iCloud</xhtml:li>
                <xhtml:li>Uncheck any services that are not allowed for your organization</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Use a profile to disable services where organizationally required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>iCloud services are integrated deeply into macOS and in many cases are expected to be used by Mac users. iCloud is a public cloud and is not covered by organizational security plans. In many cases synchronizing user data from an organizational computers to an uncontrolled location, no matter who is the data owner, is unacceptable.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.2_iCloud_keychain" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">iCloud keychain</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The iCloud keychain is Apple's password manager that works with macOS and iOS. The capability allows users to store passwords in either iOS or macOS for use in Safari on both platforms and other iOS integrated applications. The most pervasive use is driven by iOS use rather than macOS. The passwords stored in a macOS keychain on an Enterprise managed computer could be stored in Apple's cloud and then be available on a personal computer using the same account. The stored passwords could be for organizational as well as for personal accounts.</xhtml:p>
          <xhtml:p>If passwords are no longer being used as organizational tokens they are not in scope for iCloud keychain storage.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Ensure that the iCloud keychain is used consistently with organizational requirements</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to set iCloud keychain sync based on your organization's requirements:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select iCloud</xhtml:li>
                <xhtml:li>Uncheck (or check) Keychain to meet your organization's requirements</xhtml:li>
              </xhtml:ol>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.3_iCloud_Drive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">iCloud Drive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>iCloud Drive is Apple's storage solution for applications on both macOS and iOS to use the same files that are resident in Apple's cloud storage. The iCloud Drive folder is available much like Dropbox, Microsoft OneDrive or Google Drive.</xhtml:p>
          <xhtml:p>One of the concerns in public cloud storage is that proprietary data may be inappropriately stored in an end user's personal repository. Organizations that need specific controls on information should ensure that this service is turned off or the user knows what information must be stored on services that are approved for storage of controlled information.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Organizations should review third party storage solutions pertaining to existing data confidentiality and integrity requirements.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to set iCloud Drive to your organization's requirements:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select iCloud</xhtml:li>
                <xhtml:li>Uncheck iCloud Drive if cloud storage is not allowed for your organization</xhtml:li>
              </xhtml:ol>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Users will not be able to use continuity on macOS to resume the use of newly composed but unsaved files</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207776"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6.4_iCloud_Drive_Document_and_Desktop_sync" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">iCloud Drive Document and Desktop sync</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>With macOS 10.12 Apple introduced the capability to have a user's Desktop and Documents folders automatically synchronize to the user's iCloud Drive, providing they have enough room purchased through Apple on their iCloud drive. This capability mirrors what Microsoft is doing with the use of OneDrive and Office 365. There are concerns with using this capability.</xhtml:p>
          <xhtml:p>The storage space that Apple provides for free is used by users with iCloud mail, all of a user's Photo Library created with the ever larger Multi-Pixel iPhone cameras and all of the iOS Backups. Adding a synchronization capability for users who have files going back a decade or more and storage may be tight without much larger Apple charges than the free 5GB. Users with multiple computers running 10.12 and above with unique content on each will have issues as well.</xhtml:p>
          <xhtml:p>Enterprise users may not be allowed to store Enterprise information in a third party public cloud. In previous implementations iCloud Drive or even DropBox the user selected what files were synchronized even if there were no other controls. The new feature synchronizes all files in a folder widely used to put working files.</xhtml:p>
          <xhtml:p>The automatic synchronization of all files in a user's Desktop and Documents folders should be disabled.</xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://derflounder.wordpress.com/2016/09/23/icloud-desktop-and-documents-in-macos-sierra-the-good-the-bad-and-the-ugly/">https://derflounder.wordpress.com/2016/09/23/icloud-desktop-and-documents-in-macos-sierra-the-good-the-bad-and-the-ugly/</xhtml:a>
          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Automated Document synchronization should be planned and controlled to approved storage.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable iCloud Desktop and Document syncing:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select iCloud</xhtml:li>
                <xhtml:li>Select iCloud Drive</xhtml:li>
                <xhtml:li>Select Options next to iCloud Drive</xhtml:li>
                <xhtml:li>Uncheck Desktop &amp; Documents Folders</xhtml:li>
              </xhtml:ol>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Users will not be able to use iCloud for the automatic sync of the Desktop and Documents folders.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207777"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207778"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.7_Time_Machine">
      <xccdf:title xml:lang="en">Time Machine</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>One of the most important IT Operational concerns is to ensure that information is protected against loss or tampering. The purpose of the IT devices is to process the data after all. At one time the cost of IT equipment and the volume of the data might make the protection of the equipment itself more important, at this point the vast size of data archives and the lower cost of end user equipment makes data protection central to operational planning. Backup strategies are generally focused on ensuring that there are multiple copies of relevant versions of user files. The plan is that no single hardware or software loss or failure will result in major data loss.</xhtml:p>
        <xhtml:p>Apple introduced Time Machine in 2007 as a simple to use built-in mechanism for users to ensure that their machine was backed up and if there was a mistake or loss information could be easily recovered. There are other solutions to ensure information is protected including several Enterprise solutions and simple drive or directory cloning.</xhtml:p>
        <xhtml:p>The controls in this section are specifically about Time Machine. The general ideas are applicable to any data backup solution.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7.1_Time_Machine_Auto-Backup" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Time Machine Auto-Backup</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Backup solutions are only effective if the backups run on a regular basis. The time to check for backups is before the hard drive fails or the computer goes missing. In order to simplify the user experience so that backups are more likely to occur Time Machine should be on and set to Back Up Automatically whenever the target volume is available.</xhtml:p>
          <xhtml:p>Operational staff should ensure that backups complete on a regular basis and the backups are tested to ensure that file restoration from backup is possible when needed.</xhtml:p>
          <xhtml:p>Backup dates are available even when the target volume is not available in the Time Machine plist.</xhtml:p>
          <xhtml:p>SnapshotDates = (</xhtml:p>
          <xhtml:p>"2012-08-20 12:10:22 +0000",</xhtml:p>
          <xhtml:p>"2013-02-03 23:43:22 +0000",</xhtml:p>
          <xhtml:p>"2014-02-19 21:37:21 +0000",</xhtml:p>
          <xhtml:p>"2015-02-22 13:07:25 +0000",</xhtml:p>
          <xhtml:p>"2016-08-20 14:07:14 +0000"</xhtml:p>
          <xhtml:p>When the backup volume is connected to the computer more extensive information is available through tmutil. See man tmutil</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Backups should automatically run whenever the backup drive is available</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to enable TimeMachine:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Time Machine</xhtml:li>
                <xhtml:li>Select Back Up Automatically</xhtml:li>
                <xhtml:li>Select the drive to use for TimeMachine</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following enable TimeMachine:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo sudo tmutil setdestination -a /Volumes/&lt;volumename&gt;                <br/>
                <br/>
$ sudo tmutil enable
              </xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo tmutil setdestination -a /Volumes/TimeMachineDrive/                <br/>
                <br/>
$ sudo tmutil enable
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The backup will run periodically in the background and could have user impact while running.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_timemachine_autobackup.sh"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7.2_Time_Machine_Volumes_Are_Encrypted" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Time Machine Volumes Are Encrypted</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>One of the most important security tools for data protection on macOS is FileVault. With encryption in place it makes it difficult for an outside party to access your data if they get physical possession of the computer. One very large weakness in data protection with FileVault is the level of protection on backup volumes. If the internal drive is encrypted but the external backup volume that goes home in the same laptop bag is not it is self-defeating. Apple tries to make this mistake easily avoided by providing a checkbox to enable encryption when setting-up a time machine backup. Using this option does require some password management, particularly if a large drive is used with multiple computers. A unique complex password to unlock the drive can be stored in keychains on multiple systems for ease of use.</xhtml:p>
          <xhtml:p>While some portable drives may contain non-sensitive data and encryption may make interoperability with other systems difficult backup volumes should be protected just like boot volumes.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Backup volumes need to be encrypted</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/10/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to enable encryption on the TimeMachine drive:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Time Machine</xhtml:li>
                <xhtml:li>Select Select Disk...</xhtml:li>
                <xhtml:li>Select the existing TimeMachine backup drive from the Available Drive list</xhtml:li>
                <xhtml:li>Set Encrypt backups</xhtml:li>
                <xhtml:li>Select Use Disk</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:strong>Note</xhtml:strong>
: You can set encryption through Disk Utility or                 <xhtml:span class="inline_block">diskutil</xhtml:span>
 in terminal.              </xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_timemachine_encrypted.sh"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8_Disable_Wake_for_network_access_and_Power_Nap" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Disable "Wake for network access" and "Power Nap"</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>These two features allow the computer to take action when the user is not present and the computer is in energy saving mode. These tools require FileVault to remain unlocked and fully rejoin known networks. These macOS features are meant to allow the computer to resume activity as needed regardless of physical security controls.</xhtml:p>
        <xhtml:p>
          <xhtml:strong>Wake for network access</xhtml:strong>

This feature allows other users to be able to access your computer’s shared resources, such as shared printers or iTunes playlists, even when your computer is in sleep mode. In a closed network when only authorized devices could wake a computer it could be valuable to wake computers in order to do management push activity. Where mobile workstations and agents exist the device will more likely check in to receive updates when already awake. Mobile devices should not be listening for signals on unmanaged network where untrusted devices could send wake signals.        </xhtml:p>
        <xhtml:p>
          <xhtml:strong>Power Nap</xhtml:strong>

Power Nap allows the system to stay in low power mode, especially while on battery power and periodically connect to previously named networks with stored credentials for user applications to phone home and get updates. This capability requires FileVault to remain unlocked and the use of previously joined networks to be risk accepted based on the SSID without user input        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">man pmset</xhtml:span>
          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Disabling this feature mitigates the risk of an attacker remotely waking the system and gaining access.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following disable Wake for network access or Power Nap:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Energy Saver</xhtml:li>
              <xhtml:li>Uncheck Wake for network access</xhtml:li>
              <xhtml:li>Uncheck Enable Power Nap</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to disable Wake for network access:</xhtml:p>
            <xhtml:code class="code_block">$ sudo pmset -a womp 0  
</xhtml:code>
            <xhtml:p>Run the following command to disable Power Nap:</xhtml:p>
            <xhtml:code class="code_block">$ sudo pmset -a powernap 0
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Management programs like Apple Remote Desktop Administrator use wake-on-LAN to connect with computers. If turned off, such management programs will not be able to wake a computer over the LAN. If the wake-on-LAN feature is needed, do not turn off this feature.</xhtml:p>
              <xhtml:p>Power Nap exists for unattended user application updates like email and social media clients. if the computer must always be updated with the latest client information it can be left on, plugged in and the display dimmed. If AC power is not available the use case correlates with possibly compromised physical and logical security. The user should be able to decrypt FileVault and have the applications download what is required when the computer is actively used.</xhtml:p>
              <xhtml:p>The control to prevent computer sleep has been retired for this version of the Benchmark. Forcing the computer to stay on and use energy in case a management push is needed is contrary to most current management processes. Only keep computers unslept if after hours pushes are required on closed LANs.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_wakenap.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.9_Pair_the_remote_control_infrared_receiver_if_enabled" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Pair the remote control infrared receiver if enabled</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>An infrared receiver is a piece of hardware that sends information from an infrared remote control to another device by receiving and decoding signals. If a remote is used with a computer, a specific remote, or "pair", can be set-up to work with the computer. This will allow only the paired remote to work on that computer. If a remote is needed the receiver should only be accessible by a paired device. Many models do not have infrared hardware. The audit check looks for the hardware first.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>An infrared remote can be used from a distance to circumvent physical security controls. A remote could also be used to page through a document or presentation, thus revealing sensitive information.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">http://support.apple.com/kb/PH11060</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to disable the IR receiver:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Security &amp; Privacy</xhtml:li>
              <xhtml:li>Select General</xhtml:li>
              <xhtml:li>Select Advanced</xhtml:li>
              <xhtml:li>Check Disable remote control infrared receiver</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to disable the IR receiver:</xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled -bool false
</xhtml:code>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 If the computer does not have an onboard IR port the graphical method will not be available. The terminal method should still be ran so that any external IR receivers that allow system control cannot be connected and be enabled.            </xhtml:p>
            <xhtml:p>If you need the IR receiver to be active, perform the following to pair a remote control infrared receiver:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Holding the remote close to the computer, point the remote at the front of the computer.</xhtml:li>
              <xhtml:li>Pair the Apple Remote.</xhtml:li>
            </xhtml:ol>
            <xhtml:ul>
              <xhtml:li>If you have an Apple Remote with seven buttons, press and hold both the Right and Menu buttons on the remote until the paired-remote icon appears on your screen</xhtml:li>
              <xhtml:li>If you have an Apple Remote with six buttons, press and hold both the Next and Menu buttons on the remote until the paired-remote icon appears on your screen</xhtml:li>
            </xhtml:ul>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="OR">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207780"/>
        </check>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207781"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207782"/>
          </check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.10_Enable_Secure_Keyboard_Entry_in_terminal.app" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Enable Secure Keyboard Entry in terminal.app</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Secure Keyboard Entry prevents other applications on the system and/or network from detecting and recording what is typed into Terminal.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:a href="http://docs.info.apple.com/article.html?path=Terminal/2.1/en/5386.html">http://docs.info.apple.com/article.html?path=Terminal/2.1/en/5386.html</xhtml:a>
          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Enabling Secure Keyboard Entry minimizes the risk of a key logger from detecting what is entered in Terminal.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable secure keyboard entries in Terminal:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open Terminal</xhtml:li>
              <xhtml:li>Select Terminal</xhtml:li>
              <xhtml:li>Select Secure Keyboard Entry</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write -app Terminal SecureKeyboardEntry -bool true
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u firstuser defaults write -app Terminal SecureKeyboardEntry -bool true
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207783"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.11_Java_6_is_not_the_default_Java_runtime" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Java 6 is not the default Java runtime</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Apple had made Java part of the core Operating System for macOS. Apple is no longer providing Java updates for macOS and updated JREs and JDK are made available by Oracle. The latest version of Java 6 made available by Apple has many unpatched vulnerabilities and should not be the default runtime for Java applets that request one from the Operating System</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Java has been one of the most exploited environments and Java 6, which was provided as an OS component by Apple, is no longer maintained by Apple or Oracle. The old versions provided by Apple are both unsupported and missing the more modern security controls that have limited current exploits. The EOL version may still be installed and should be removed from the computer or not be in the default path.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Java 6 can be removed completely or, if required Java applications will only work with Java 6, a custom path can be used. Apple is likely to deprecate Java 6 in upcoming macOS versions, so any applications that still require Java 6 will soon be incompatible.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Old applications may rely on either an Apple supplied version of Java 6 or an updated JDK.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sce/osx_java6.sh"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.12_Securely_delete_files_as_needed" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Securely delete files as needed</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>In previous versions of macOS Apple included a capability to securely empty the trash that included overwrites of the existing data. With the wider use of FileVault and other encryption methods and the growing use of Solid State Drives the requirements have changed and the "Secure Empty Trash" capability has been removed from the GUI. For systems that are not using encryption and continue to use platter-based hard drives there is residual risk that deleted files can still be recovered from the file system.</xhtml:p>
        <xhtml:p>In previous versions of the Benchmark srm was mentioned as an alternative to the removal of "Secure Empty Trash." With the release of macOS 10.12 srm has been removed. There is still an option to erase free space from the command line but Apple has warned that encryption is a better solution</xhtml:p>
        <xhtml:p>From manual entry for diskutil</xhtml:p>
        <xhtml:p>
          <xhtml:strong>Note:</xhtml:strong>
 This kind of secure erase is no longer considered safe because modern devices have wear-leveling, block-sparing, and possibly-persistent cache hardware. The modern solution for quickly and securely erasing your data is strong encryption, with which mere destruction of the key more or less instantly renders your data irretrievable in practical terms.        </xhtml:p>
        <xhtml:p>To erase free space on the boot volume</xhtml:p>
        <xhtml:code class="code_block">$ sudo diskutil secureErase freespace 0 / 
</xhtml:code>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Securely removing files mitigates the risk of an admin user on the system recovering sensitive files that the user has deleted. It is possible for anyone with physical access to the device to get access if FileVault is not used, or to recover deleted data if the FileVault volume is already mounted. Users and admins of computers containing sensitive information should be screened appropriately or additional security controls should be in place to prevent unauthorized access to sensitive information.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Securely deleting files can take a long time, with FileVault in place the protection is erasing data within an already encrypted volume.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.13_Ensure_EFI_version_is_valid_and_being_regularly_checked" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Ensure EFI version is valid and being regularly checked</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>In order to mitigate firmware attacks Apple has created a automated Firmware check to ensure that the EFI version running is a known good version from Apple. There is also an automated process to check it every seven days.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If the Firmware of a computer has been compromised the Operating System that the Firmware loads cannot be trusted either.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>If EFI does not pass the integrity check you may send a report to Apple. Backing up files and clean installing a known good Operating System and Firmware is recommended.</xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sce/osx_efi_valid.sh"/>
      </check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Logging_and_Auditing">
    <xccdf:title xml:lang="en">Logging and Auditing</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section provide guidance on configuring the logging and auditing facilities available in macOS</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_Enable_security_auditing" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Enable security auditing</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
macOS's audit facility,           <xhtml:span class="inline_block">auditd</xhtml:span>
, receives notifications from the kernel when certain system calls, such as           <xhtml:span class="inline_block">open</xhtml:span>
,           <xhtml:span class="inline_block">fork</xhtml:span>
, and           <xhtml:span class="inline_block">exit</xhtml:span>
, are made. These notifications are captured and written to an audit log.        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>
Logs generated by           <xhtml:span class="inline_block">auditd</xhtml:span>
 may be useful when investigating a security incident as they may help reveal the vulnerable application and the actions taken by a malicious actor.        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable security auditing:</xhtml:p>
            <xhtml:p>Run the following command to load auditd:</xhtml:p>
            <xhtml:code class="code_block">$ sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist
</xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_security_audit.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Configure_Security_Auditing_Flags_per_local_organizational_requirements" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Configure Security Auditing Flags per local organizational requirements</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Auditing is the capture and maintenance of information about security-related events. Auditable events often depend on differing organizational requirements.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:a href="https://derflounder.wordpress.com/2012/01/30/openbsm-auditing-on-mac-os-x/">OpenBSM auditing on Mac OS X</xhtml:a>
          </xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://csrc.nist.gov/CSRC/media/Publications/sp/800-179/rev-1/draft/documents/sp800-179r1-draft.pdf">Guide to Securing macOS 10.12 Systems for IT Professionals Section 6.4</xhtml:a>
          </xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://meliot.me/2017/07/02/mac-os-real-time-auditing/">Real-time auditing on macOS with OpenBSM</xhtml:a>
          </xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://www.scip.ch/en/?labs.20150108">AUDIT IN A OS X SYSTEM</xhtml:a>
          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, have begun, or are about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.</xhtml:p>
        <xhtml:p>Depending on the governing authority organizations can have vastly different auditing requirements. In order to make a specific decision on which flags to check for a single standard on flags would have to exist for the uses of this Benchmark. At this point I don't see one. Some have suggested the use of an "any" flag, which would have to be an alternate check. It appears that many or statements would have to be used to make this a successfully scored control, and even this some will be dissatisfied. URL references to audit flag discussions are under references. Please follow best practices and organizational compliance requirements.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to set the require Security Auditing Flags:</xhtml:p>
            <xhtml:p>
Edit the               <xhtml:span class="inline_block">/etc/security/audit_control</xhtml:span>
 file and add               <xhtml:span class="inline_block">lo</xhtml:span>
,               <xhtml:span class="inline_block">ad</xhtml:span>
,               <xhtml:span class="inline_block">fd</xhtml:span>
,               <xhtml:span class="inline_block">fm</xhtml:span>
,               <xhtml:span class="inline_block">-all</xhtml:span>
 to               <xhtml:span class="inline_block">flags</xhtml:span>
.            </xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_audit_flags.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Retain_install.log_for_365_or_more_days" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Retain install.log for 365 or more days</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
macOS writes information pertaining to system-related events to the file           <xhtml:span class="inline_block">/var/log/install.log</xhtml:span>
 and has a configurable retention policy for this file. The default logging setting limits the file size of the logs and the maximum size for all logs. The default allows for an errant application to fill the log files and does not enforce sufficient log retention. The Benchmark recommends a value based on standard use cases. The value should align with local requirements within the organization.        </xhtml:p>
        <xhtml:p>The default value has an "all_max" file limitation, no reference to a minimum retention and a less precise rotation argument.</xhtml:p>
        <xhtml:ul>
          <xhtml:li>The maximum file size limitation string should be removed "all_max="</xhtml:li>
          <xhtml:li>An organization appropriate retention should be added "ttl="</xhtml:li>
          <xhtml:li>The rotation should be set with time stamps "rotate=utc" or "rotate=local"</xhtml:li>
        </xhtml:ul>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>
Archiving and retaining           <xhtml:span class="inline_block">install.log</xhtml:span>
 for at least a year is beneficial in the event of an incident as it will allow the user to view the various changes to the system along with the date and time they occurred.        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to ensure that install logs are retained for at least 365 days:</xhtml:p>
            <xhtml:p>
Edit the               <xhtml:span class="inline_block">/etc/asl/com.apple.install</xhtml:span>
 file and add or modify the               <xhtml:span class="inline_block">ttl</xhtml:span>
 value to               <xhtml:span class="inline_block">365</xhtml:span>
 or greater on the               <xhtml:span class="inline_block">file</xhtml:span>
.            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Without log files system maintenance and security forensics cannot be properly performed.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sce/osx_365_install_log.sh"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_security_auditing_retention" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Ensure security auditing retention</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The macOS audit capability contains important information to investigate security or operational issues. This resource is only completely useful if it is retained long enough to allow technical staff to find the root cause of anomalies in the records.</xhtml:p>
        <xhtml:p>Retention can be set to respect both size and longevity. To retain as much as possible under a certain size the recommendation is to use:</xhtml:p>
        <xhtml:p>expire-after:60d OR 1G</xhtml:p>
        <xhtml:p>More info in the man page
man audit_control</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>The audit records need to be retained long enough to be reviewed as necessary.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to set the audit retention length:</xhtml:p>
            <xhtml:p>
Edit the               <xhtml:span class="inline_block">/etc/security/audit_control</xhtml:span>
 file so that               <xhtml:span class="inline_block">expire-after:</xhtml:span>
 is at least               <xhtml:span class="inline_block">60d OR 1G</xhtml:span>
            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The recommendation is that at least 60 days or 1 gigabyte of audit records are retained. Systems that very little remaining disk space may have issues retaining sufficient data.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sce/osx_audit_control.sh"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Control_access_to_audit_records" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Control access to audit records</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The audit system on macOS writes important operational and security information that can be both useful for an attacker and a place for an attacker to attempt to obfuscate unwanted changes that were recorded. As part of defense-in-depth the /etc/security/audit_control configuration and the files in /var/audit should be owned only by root with group wheel with read only rights and no other access allowed. macOS ACLs should not be used for these files.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>From ls man page</xhtml:p>
          <xhtml:code class="code_block">
-e      Print the Access Control List (ACL) associated with the file, if            <br/>
             present, in long (-l) output.
          </xhtml:code>
          <xhtml:p>More info:</xhtml:p>
          <xhtml:p>https://www.techrepublic.com/blog/apple-in-the-enterprise/introduction-to-os-x-access-control-lists-acls/</xhtml:p>
          <xhtml:p>http://ahaack.net/technology/OS-X-Access-Control-Lists-ACL.html</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Audit records should never be changed except by the system daemon posting events. Records may be viewed or extracts manipulated but the authoritative files should be protected from unauthorized changes.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following to commands to set the audit records to the root user and wheel group</xhtml:p>
            <xhtml:code class="code_block">
$ sudo chown -R root:wheel /etc/security/audit_control              <br/>
              <br/>
$ sudo chown -R root:wheel /var/audit/
            </xhtml:code>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 It is recommended to do a through verification process on why the audit logs have been changed before following the remediation steps. If the system has different access controls on the audit logs, and the changes cannot be traced, a new install may be prudent. Check for signs of file tampering as well as unapproved OS changes.            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>This control is only checking the default configuration to ensure that unwanted access to audit records is not available.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_audit_record_access.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_Firewall_is_configured_to_log" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Ensure Firewall is configured to log</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The socketfilter firewall is what is used when the firewall is turned on in the Security PreferencePane. In order to appropriately monitor what access is allowed and denied logging must be enabled.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>More info
http://krypted.com/tag/socketfilterfw/</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>In order to troubleshoot the successes and failures of a firewall logging should be enabled.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to enable logging of the firewall</xhtml:p>
            <xhtml:code class="code_block">
$ sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on              <br/>
              <br/>
Turning on log mode
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Detailed logging may result in excessive storage.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1207791"/>
      </check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Network_Configurations">
    <xccdf:title xml:lang="en">Network Configurations</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains guidance on configuring the networking related aspects of macOS.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_Disable_Bonjour_advertising_service" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Disable Bonjour advertising service</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Bonjour is an auto-discovery mechanism for TCP/IP devices which enumerate devices and services within a local subnet. DNS on macOS is integrated with Bonjour and should not be turned off, but the Bonjour advertising service can be disabled.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>Anything Bonjour discovers is already available on the network and probably discoverable with network scanning tools. The security benefit of disabling Bonjour for that reason is minimal.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Bonjour can simplify device discovery from an internal rogue or compromised host. An attacker could use Bonjour's multicast DNS feature to discover a vulnerable or poorly-configured service or additional information to aid a targeted attack. Implementing this control disables the continuous broadcasting of "I'm here!" messages. Typical end-user endpoints should not have to advertise services to other computers. This setting does not stop the computer from sending out service discovery messages when looking for services on an internal subnet, if the computer is looking for a printer or server and using service discovery. To block all Bonjour traffic except to approved devices the pf or other firewall would be needed.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to disable Bonjour Advertising services:</xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool true
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>
Some applications, like Final Cut Studio and AirPort Base Station management, may not operate properly if the                 <xhtml:span class="inline_block">mDNSResponder</xhtml:span>
 is turned off.              </xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240474"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_Show_Wi-Fi_status_in_menu_bar" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Enable "Show Wi-Fi status in menu bar"</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The Wi-Fi status in the menu bar indicates if the system's wireless internet capabilities are enabled. If so, the system will scan for available wireless networks to connect to. At the time of this revision all computers Apple builds have wireless network capability, which has not always been the case. This control only pertains to systems that have a wireless NIC available. Operating systems running in a virtual environment may not score as expected either.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>AirPort is Apple’s marketing name for its 802.11b, g, and n wireless interfaces.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Enabling "Show Wi-Fi status in menu bar" is a security awareness method that helps mitigate public area wireless exploits by making the user aware of their wireless connectivity status.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/15/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/15/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following enable Wi-Fi status in the menu bar:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Network</xhtml:li>
              <xhtml:li>Select Wi-Fi</xhtml:li>
              <xhtml:li>Set Show Wi-Fi status in menu bar</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>For each user, run the following to turn the Wi-Fi status on in the menu bar</xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.systemuiserver menuExtras -array-add "/System/Library/CoreServices/Menu Extras/AirPort.menu"
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u firstuser defaults write /Users/firstuser/Library/Preferences/com.apple.systemuiserver.plist menuExtras -array-add "/System/Library/CoreServices/Menu Extras/AirPort.menu"
</xhtml:code>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 If the remediation is run multiple times, multiple instances of the Wi-Fi status will appear after rebooting the system. Command-click and drag the unwanted icons off the menu bar            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The user of the system should have a quick check on their wireless network status available</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240475"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_Create_network_specific_locations" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Create network specific locations</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The network location feature of the Mac is very powerful tool to manage network security. By creating different network locations, a user can easily (and without administrative privileges) change the network settings on the Mac. By only using the network interfaces needed at any specific time, exposure to network attacks is limited.</xhtml:p>
        <xhtml:p>A little understanding of how the Network System Preferences pane works is required.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>Deleting the Automatic location cannot be undone.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Network locations allow the computer to have specific configurations ready for network access when required. Locations can be used to manage which network interfaces are available for specialized network access</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/15/subcontrol/10" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following actions to create and edit multiple network locations as needed.</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Network</xhtml:li>
              <xhtml:li>Select Location</xhtml:li>
              <xhtml:li>Select Edit Locations from the Locations popup menu</xhtml:li>
              <xhtml:li>Select any unneeded network locations</xhtml:li>
              <xhtml:li>Click the minus button for any unneeded locations</xhtml:li>
              <xhtml:li>Select Done</xhtml:li>
              <xhtml:li>Select any remaining network locations</xhtml:li>
              <xhtml:li>Select any unneeded network interfaces</xhtml:li>
              <xhtml:li>Select the minus button to remove them</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 Delete the Automatic location for any device that does not use multiple network services set for DHCP or dynamic addressing. If network services like FireWire, VPN, AirPort or Ethernet are not used by a specific device class those services should be deleted.            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Unneeded network interfaces increases the attack surface and could lead to a successful exploit.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4_Ensure_http_server_is_not_running" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Ensure http server is not running</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>macOS used to have a graphical front-end to the embedded Apache web server in the Operating System. Personal web sharing could be enabled to allow someone on another computer to download files or information from the user's computer. Personal web sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. Apache however is still part of the Operating System and can be easily turned on to share files and provide remote connectivity to an end user computer. Web sharing should only be done through hardened web servers and appropriate cloud services.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Web serving should not be done from a user desktop. Dedicated webservers or appropriate cloud storage should be used. Open ports make it easier to exploit the computer.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">STIGID AOSX-12-001275</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to disable the http server services:</xhtml:p>
            <xhtml:code class="code_block">$ sudo apachectl stop
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The web server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1240476_var"/>
          <check-content-ref href="sce/osx_process_not_running.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5_Ensure_nfs_server_is_not_running" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Ensure nfs server is not running</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>macOS can act as an NFS fileserver. NFS sharing could be enabled to allow someone on another computer to mount shares and gain access to information from the user's computer. File sharing from a user endpoint has long been considered questionable and Apple has removed that capability from the GUI. NFSD is still part of the Operating System and can be easily turned on to export shares and provide remote connectivity to an end user computer.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>File serving should not be done from a user desktop, dedicated servers should be used. Open ports make it easier to exploit the computer.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to disable the nfsd fileserver services:</xhtml:p>
            <xhtml:code class="code_block">$ sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.nfsd.plist
</xhtml:code>
            <xhtml:p>Remove the exported Directory listing</xhtml:p>
            <xhtml:code class="code_block">$ sudo rm /etc/exports
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The nfs server is both a point of attack for the system and a means for unauthorized file transfers.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240477"/>
        </check>
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_1240478_var"/>
          <check-content-ref href="sce/osx_process_not_running.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_System_Access_Authentication_and_Authorization">
    <xccdf:title xml:lang="en">System Access, Authentication and Authorization</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>System Access, Authentication and Authorization</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_File_System_Permissions_and_Access_Controls">
      <xccdf:title xml:lang="en">File System Permissions and Access Controls</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>File system permissions have always been part of computer security. There are several principles that are part of best practices for a posix based system that are contained in this section, This section does not contain a complete list of every permission on a macOS System that might be problematic. Developers and use cases differ and what some admins long in the profession might consider a travesty a risk assessor steeped in BYOD trends may not give a second glance at. We are documenting here controls that should point out truly bad practices or anomalies that should be looked at and considered closely. Many of the controls are to mitigate the risk of privilege escalation attacks and data exposure to unauthorized parties.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Secure_Home_Folders" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Secure Home Folders</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>By default macOS allows all valid users into the top level of every other users home folder, and restricts access to the Apple default folders within. Another user on the same system can see you have a "Documents" folder but cannot see inside it. This configuration does work for personal file sharing but can expose user files to standard accounts on the system.</xhtml:p>
          <xhtml:p>The best parallel for Enterprise environments is that everyone who has a Dropbox account can see everything that is at the top level but can't see your pictures, in the parallel with macOS they can see into every new Directory that is created because of the default permissions.</xhtml:p>
          <xhtml:p>Home folders should be restricted to access only by the user. Sharing should be used on dedicated servers or cloud instances that are managing access controls. Some environments may encounter problems if execute rights are removed as well as read and write. Either no access or execute only for group or others is acceptable</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Allowing all users to view the top level of all networked user's home folder may not be desirable since it may lead to the revelation of sensitive information.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>For each user, run the following command to secure all home folders:</xhtml:p>
              <xhtml:code class="code_block">$ sudo chmod -R og-rwx /Users/&lt;username&gt;
</xhtml:code>
              <xhtml:p>Alternately, run the following command if there needs to be executable access for a home folder:</xhtml:p>
              <xhtml:code class="code_block">$ sudo chmod -R og-rw /Users/&lt;username&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo chmod -R og-rw /Users/thirduser/                <br/>
                <br/>
$ sudo chmod -R og-rwx /Users/fourthuser/                <br/>
                <br/>
# ls -l /Users/                 <br/>
                <br/>
total 0                <br/>
drwxr-xr-x+ 12 Guest       _guest  384 24 Jul 13:42 Guest                <br/>
drwxrwxrwt   4 root        wheel   128 22 Jul 11:00 Shared                <br/>
drwx--x--x+ 18 firstuser   staff   576 10 Aug 14:36 firstuser                <br/>
drwx--x--x+ 15 seconduser  staff   480 10 Aug 09:16 seconduser                <br/>
drwx--x--x+ 11 thirduser   staff   352 10 Aug 14:53 thirduser                <br/>
drwx------+ 11 fourthuser  staff   352 10 Aug 14:53 fourthuser
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>If implemented, users will not be able to use the "Public" folders in other users' home folders. "Public" folders with appropriate permissions would need to be set up in the /Shared folder.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_secure_home_folders.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Check_System_Wide_Applications_for_appropriate_permissions" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Check System Wide Applications for appropriate permissions</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Applications in the System Applications Directory (/Applications) should be world executable since that is their reason to be on the system. They should not be world writable and allow any process or user to alter them for other processes or users to then execute modified versions</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Unauthorized modifications of applications could lead to the execution of malicious code.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to change the permissions for each application that does not meet the requirements:</xhtml:p>
              <xhtml:code class="code_block">$ sudo chmod -R o-w /Applications/&lt;applicationname&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">
$ sudo chmod -R o-w /Applications/Google\ Chrome.app/                <br/>
                <br/>
$ sudo find /Applications -iname "*.app" -type d -perm -2 -ls                <br/>
                <br/>
922602        0 drwxr-xrwx    3 seconduser       admin                  96  8 Aug 04:32 /Applications/Google Chrome copy.app
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Applications changed will no longer be world writable</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_application_permission.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Check_System_folder_for_world_writable_files" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Check System folder for world writable files</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Software sometimes insists on being installed in the /System Directory and have inappropriate world writable permissions.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Folders in /System should not be world writable. The audit check excludes the "Drop Box" folder that is part of Apple's default user template.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to set permissions so that folders are not world writable in the /System folder:</xhtml:p>
              <xhtml:code class="code_block">$ sudo chmod -R o-w /Path/&lt;baddirectory&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo chmod -R o-w /System/Library/baddir
</xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_system_world_write.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Check_Library_folder_for_world_writable_files" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Check Library folder for world writable files</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Software sometimes insists on being installed in the             <xhtml:span class="inline_block">/Library Directory</xhtml:span>
 and have inappropriate world writable permissions.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Folders in             <xhtml:span class="inline_block">/Library</xhtml:span>
 should not be world writable. The audit check excludes the             <xhtml:span class="inline_block">/Library/Caches</xhtml:span>
 folder where the sticky bit is set.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Run the following command to set permissions so that folders are not world writable in the                 <xhtml:span class="inline_block">/Library</xhtml:span>
 folder:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo chmod -R o-w /Library/&lt;baddirectory&gt;
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo chmod -R o-w /Library/baddir
</xhtml:code>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_library_world_write.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Password_Management">
      <xccdf:title xml:lang="en">Password Management</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Password security is an important part of general IT security where passwords are in use. For macOS passwords are still much more widely used than other methods for account access. While there are other authentication and authorization methods for access from a macOS computer to organizational services, console access to the Mac is probably done using a password. This section contains password controls.</xhtml:p>
        <xhtml:p>Recent updates based on research by NIST in SP800-63 call in to question traditional password complexity and rotation requirements. Sticky notes are not a password management program and password vault APIs are under increasing attack and ideally the user will remember their important passwords. The new understanding has informed changes to the previous password recommendations.</xhtml:p>
        <xhtml:p>Length, Threshold and a yearly rotation requirement are the only scored controls below. Other controls will remain as unscored options. Passwords used for macOS are likely to also function as encryption keys for FileVault and depending on the information confidentiality on FileVault volumes stronger passwords may be required than are necessary to pass the controls in this Benchmark.</xhtml:p>
        <xhtml:p>Apple supported solutions for managing local passwords on macOS are to use either an XML file that contains password rules that are imported with pwpolicy or through the use of a profile. In either case the controls in this section can be implemented with organizationally approved password policy.</xhtml:p>
        <xhtml:p>Content is available where security hardening content is available and is native to Management suites and MDM tools.</xhtml:p>
        <xhtml:p>
Content also available here:           <xhtml:a href="https://github.com/ronc-LAemigre/macos-sec-config">https://github.com/ronc-LAemigre/macos-sec-config</xhtml:a>
        </xhtml:p>
        <xhtml:p>NIST guidance on passwords starting at 5.1.1.1</xhtml:p>
        <xhtml:p>https://pages.nist.gov/800-63-3/sp800-63b.html</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Configure_account_lockout_threshold" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Configure account lockout threshold</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The account lockout threshold specifies the amount of times a user can enter an incorrect password before a lockout will occur.</xhtml:p>
          <xhtml:p>Ensure that a lockout threshold is part of the password policy on the computer</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The account lockout feature mitigates brute-force password attacks on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">STIGID AOSX-12-001324</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to set the maximum number of failed login attempts to less than or equal to 5:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "maxFailedLoginAttempts=&lt;value≤5&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a firstuser -setglobalpolicy "maxFailedLoginAttempts=5"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The number of incorrect log on attempts should be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user log on.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwmaxfail.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Set_a_minimum_password_length" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Set a minimum password length</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>A minimum password length is the fewest number of characters a password can contain to meet a system's requirements.</xhtml:p>
          <xhtml:p>Ensure that a minimum of a 15 character password is part of the password policy on the computer.</xhtml:p>
          <xhtml:p>Where the confidentiality of encrypted information in FileVault is more of a concern requiring a longer password or passphrase may be sufficient rather than imposing additional complexity requirements that may be self-defeating.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Information systems that are not protected with strong password schemes including passwords of minimum length provide a greater opportunity for attackers to crack the password and gain access to the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to set the password length to greater than or equal to 15:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "minChars=&lt;value≥15&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a firstuser -setglobalpolicy "minChars=15"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Short passwords can be easily attacked.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwminlength.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Complex_passwords_must_contain_an_Alphabetic_Character" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Complex passwords must contain an Alphabetic Character</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
          <xhtml:p>Ensure that an Alphabetic character is part of the password policy on the computer</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to set the that passwords must contain at least one letter:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "requiresAlpha=&lt;value≤5&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a firstuser -setglobalpolicy "requiresAlpha=1"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwminalpha.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Complex_passwords_must_contain_a_Numeric_Character" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Complex passwords must contain a Numeric Character</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
          <xhtml:p>Ensure that a number or numeric value is part of the password policy on the computer.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to set passwords to require at least one number:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "requiresNumeric=&lt;value≥1&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a test -setglobalpolicy "requiresNumeric=2"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwminnum.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Complex_passwords_must_contain_a_Special_Character" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Complex passwords must contain a Special Character</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Ensure that a special character is part of the password policy on the computer</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to set passwords to require at least one special character:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "requiresSymbol=&lt;value≥1&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a test -setglobalpolicy "requiresSymbol=1"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwspecialchar.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Complex_passwords_must_uppercase_and_lowercase_letters" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Complex passwords must uppercase and lowercase letters</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Complex passwords contain one character from each of the following classes: English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.</xhtml:p>
          <xhtml:p>Ensure that both uppercase and lowercase letters are part of the password policy on the computer</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The more complex a password the more resistant it will be against persons seeking unauthorized access to a system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to set passwords to require at upper and lower case letter:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "requiresMixedCase=&lt;value≥1&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a test -setglobalpolicy "requiresMixedCase=1"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Password policy should be in effect to reduce the risk of exposed services being compromised easily through dictionary attacks or other social engineering attempts.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwmcomplex.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Password_Age" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Password Age</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Over time passwords can be captured by third parties through mistakes, phishing attacks, third party breaches or merely brute force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed) users should reset passwords periodically.
This control uses 365 days as the acceptable value, some organizations may be more or less restrictive. This control mainly exists to mitigate against password reuse of the macOS account password in other realms that may be more prone to compromise. Attackers take advantage of exposed information to attack other accounts.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Passwords should be changed periodically to reduce exposure</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to require that passwords expire after at most 365 days:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "maxMinutesUntilChangePassword=&lt;value≤525600&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a firstuser -setglobalpolicy "maxMinutesUntilChangePassword=43200"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Required password changes will lead to some locked computers requiring admin assistance</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwdayexpire.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Password_History" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Password History</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Over time passwords can be captured by third parties through mistakes, phishing attacks, third party breaches or merely brute force attacks. To reduce the risk of exposure and to decrease the incentives of password reuse (passwords that are not forced to be changed periodically generally are not ever changed) users must reset passwords periodically. This control ensures that previous passwords are not reused immediately by keeping a history of previous passwords hashes. Ensure that password history checks are part of the password policy on the computer. This control checks whether a new password is different than the previous 15.
The latest NIST guidance based on exploit research referenced in this section details how one of the greatest risks is password exposure rather than password cracking. Passwords should be changed to a new unique value whenever a password might have been exposed to anyone other than the account holder. Attackers have maintained persistent control based on predictable password change patterns and substantially different patterns should be used in case of a leak.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Old passwords should not be reused</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to require that the passwords must to be different from at least the last 15 passwords:</xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a &lt;administratoraccount&gt; -setaccountpolicies "usingHistory=&lt;value≥15&gt;"
</xhtml:code>
              <xhtml:p>
                <xhtml:em>example</xhtml:em>
:              </xhtml:p>
              <xhtml:code class="code_block">$ sudo pwpolicy -a firstuser -setglobalpolicy "usingHistory=15"
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Required password changes will lead to some locked computers requiring admin assistance</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_pwhistory.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_Reduce_the_sudo_timeout_period" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Reduce the sudo timeout period</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
The           <xhtml:span class="inline_block">sudo</xhtml:span>
 command allows the user to run programs as the root user. Working as the root user allows the user an extremely high level of configurability within the system.        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:code class="code_block">
#            <br/>
# Sample /etc/sudoers file.            <br/>
#            <br/>
# This file MUST be edited with the 'visudo' command as root.            <br/>
#            <br/>
# See the sudoers man page for the details on how to write a sudoers file.            <br/>
            <br/>
##            <br/>
# Override built-in defaults            <br/>
##            <br/>
Defaults        env_reset            <br/>
Defaults        env_keep += "BLOCKSIZE"            <br/>
Defaults        env_keep += "COLORFGBG COLORTERM"            <br/>
Defaults        env_keep += "__CF_USER_TEXT_ENCODING"            <br/>
Defaults        env_keep += "CHARSET LANG LANGUAGE LC_ALL LC_COLLATE LC_CTYPE"            <br/>
Defaults        env_keep += "LC_MESSAGES LC_MONETARY LC_NUMERIC LC_TIME"            <br/>
Defaults        env_keep += "LINES COLUMNS"            <br/>
Defaults        env_keep += "LSCOLORS"            <br/>
Defaults        env_keep += "SSH_AUTH_SOCK"            <br/>
Defaults        env_keep += "TZ"            <br/>
Defaults        env_keep += "DISPLAY XAUTHORIZATION XAUTHORITY"            <br/>
Defaults        env_keep += "EDITOR VISUAL"            <br/>
Defaults        env_keep += "HOME MAIL"            <br/>
            <br/>
Defaults        lecture_file = "/etc/sudo_lecture"            <br/>
Defaults timestamp_timeout=0            <br/>
            <br/>
##            <br/>
# User alias specification            <br/>
##            <br/>
# User_Alias    FULLTIMERS = millert, mikef, dowdy            <br/>
            <br/>
##            <br/>
# Runas alias specification            <br/>
##            <br/>
# Runas_Alias   OP = root, operator            <br/>
            <br/>
##            <br/>
# Host alias specification            <br/>
##            <br/>
# Host_Alias    CUNETS = 128.138.0.0/255.255.0.0            <br/>
# Host_Alias    CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0            <br/>
# Host_Alias    SERVERS = master, mail, www, ns            <br/>
# Host_Alias    CDROM = orion, perseus, hercules            <br/>
            <br/>
##            <br/>
# Cmnd alias specification            <br/>
##            <br/>
# Cmnd_Alias    PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less            <br/>
            <br/>
##            <br/>
# User specification            <br/>
##            <br/>
            <br/>
# root and users in group wheel can run anything on any machine as any user            <br/>
root            ALL = (ALL) ALL            <br/>
%admin          ALL = (ALL) ALL            <br/>
            <br/>
## Read drop-in files from /private/etc/sudoers.d            <br/>
## (the '#' here does not indicate a comment)            <br/>
#includedir /private/etc/sudoers.d
          </xhtml:code>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>
The           <xhtml:span class="inline_block">sudo</xhtml:span>
 command stays logged in as the root user for five minutes before timing out and re-requesting a password. This five minute window should be eliminated since it leaves the system extremely vulnerable. This is especially true if an exploit were to gain access to the system, since they would be able to make changes as a root user.        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to edit the sudo settings:</xhtml:p>
            <xhtml:code class="code_block">$ sudo visudo  
</xhtml:code>
            <xhtml:p>
Add the line               <xhtml:span class="inline_block">Defaults timestamp_timeout=0</xhtml:span>
 in the               <xhtml:span class="inline_block">Override built-in defaults</xhtml:span>
 section.            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Users with sudo rights will have to enter their password after every sudo command with no grace period allowed.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sce/osx_sudo_timeout.sh"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4_Automatically_lock_the_login_keychain_for_inactivity" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Automatically lock the login keychain for inactivity</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The login keychain is a secure database store for passwords and certificates and is created for each user account on macOS. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. Application access to the login keychain does not keep it unlocked. If you set Apple Mail to check for email every 10 minutes using the keychain for credentials and the keychain to lock every 15 minutes if inactive it will still cause the keychain to lock. The approach recommended here is that the login keychain be set to periodically lock when inactive to reduce the risk of password exposure or unauthorized use of credentials by a third party. The time period that an organization uses will depend on how great the use is of keychain aware applications. Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>While logged in, the keychain does not prompt the user for passwords for various systems and/or programs. This can be exploited by unauthorized users to gain access to password protected programs and/or systems in the absence of the user. Timing out the keychain can reduce the exploitation window.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>
Perform the following to set the               <xhtml:span class="inline_block">login</xhtml:span>
 keychain inactivity time lock:            </xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open Keychain Access</xhtml:li>
              <xhtml:li>Select login</xhtml:li>
              <xhtml:li>Select Edit</xhtml:li>
              <xhtml:li>
Select Change Settings for keychain                 <xhtml:span class="inline_block">login</xhtml:span>
              </xhtml:li>
              <xhtml:li>Authenticate, if requested.</xhtml:li>
              <xhtml:li>Change the Lock after # minutes of inactivity setting for the Login Keychain to a value that is ≤ 6 hour (360 minutes)</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>
For each user, run the following command to set the lock value for the               <xhtml:span class="inline_block">login</xhtml:span>
 keychain:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; security  set-keychain-settings -t 21600 /Users/&lt;username&gt;/Library/Keychains/login.keychain
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u seconduser security  set-keychain-settings -t 21600 /Users/seconduser/Library/Keychains/login.keychain
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>If the timeout is set too low on heavily used items the user will be annoyed and may use workarounds.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5_Use_a_separate_timestamp_for_each_usertty_combo" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Use a separate timestamp for each user/tty combo</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Using tty tickets ensures that a user must enter the sudo password in each Terminal session.</xhtml:p>
        <xhtml:p>With sudo versions 1.8 and higher, introduced in 10.12, the default value is to have tty tickets for each interface so that root access is limited to a specific terminal. The default configuration can be overwritten or not configured correctly on earlier versions of macOS.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>https://github.com/jorangreef/sudo-prompt/issues/33</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>In combination with removing the sudo timeout grace period a further mitigation should be in place to reduce the possibility of a background process using elevated rights when a user elevates to root in an explicit context or tty.</xhtml:p>
        <xhtml:p>Additional mitigation should be in place to reduce the risk of privilege escalation of background processes.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>
Edit the               <xhtml:span class="inline_block">/etc/sudoers</xhtml:span>
 file with               <xhtml:span class="inline_block">visudo</xhtml:span>
 and remove               <xhtml:span class="inline_block">!tty_tickets</xhtml:span>
 from any Defaults line.            </xhtml:p>
            <xhtml:p>
If there is a file in the               <xhtml:span class="inline_block">/etc/sudoers.d/</xhtml:span>
 folder that contains               <xhtml:span class="inline_block">Defaults !tty_tickets</xhtml:span>
, edit the file and remove               <xhtml:span class="inline_block">!tty_tickets</xhtml:span>
 from any Defaults line.            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>This control should have no user impact. Developers or installers may have issues if background processes are spawned with different interfaces than where sudo was executed.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240485"/>
        </check>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240486"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_login_keychain_is_locked_when_the_computer_sleeps" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure login keychain is locked when the computer sleeps</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The login keychain is a secure database store for passwords and certificates and is created for each user account on macOS. The system software itself uses keychains for secure storage. Anyone with physical access to an unlocked keychain where the screen is also unlocked can copy all passwords in that keychain. The approach recommended here is that the login keychain be set to lock when when the computer sleeps to reduce the risk of password exposure. Organizations that use Firefox and Thunderbird will have a much different tolerance than those organization using keychain aware applications extensively.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>While logged in, the keychain does not prompt the user for passwords for various systems and/or programs. This can be exploited by unauthorized users to gain access to password protected programs and/or systems in the absence of the user.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to set the login keychain to lock on sleep:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open Keychain Access</xhtml:li>
              <xhtml:li>Select the login keychain</xhtml:li>
              <xhtml:li>Select Edit</xhtml:li>
              <xhtml:li>
Select Change Settings for keychain                 <xhtml:span class="inline_block">login</xhtml:span>
              </xhtml:li>
              <xhtml:li>Set Lock when sleeping</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>For each user, run the following command to set the login keychain to sleep on lock:</xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; security  set-keychain-settings -l /Users/&lt;username&gt;/Library/Keychains/login.keychain
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u firstuser security set-keychain-settings -l /Users/firstuser/Library/Keychains/login.keychain
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The user may experience multiple prompts to unlock the keychain when waking from sleep.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7_Do_not_enable_the_root_account" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Do not enable the "root" account</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The root account is a superuser account that has access privileges to perform any actions and read/write to any file on the computer. With some Linux distros the system administrator may commonly uses the root account to perform administrative functions.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>
Enabling and using the root account puts the system at risk since any successful exploit or mistake while the root account is in use could have unlimited access privileges within the system. Using the           <xhtml:span class="inline_block">sudo</xhtml:span>
 command allows users to perform functions as a root user while limiting and password protecting the access privileges. By default the root account is not enabled on a macOS computer. An administrator can escalate privileges using the           <xhtml:span class="inline_block">sudo</xhtml:span>
 command (use           <xhtml:span class="inline_block">-s</xhtml:span>
 or           <xhtml:span class="inline_block">-i</xhtml:span>
 to get a root shell).        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to ensure that the root user is disabled:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open Directory Utility</xhtml:li>
              <xhtml:li>Click the lock icon to unlock the service</xhtml:li>
              <xhtml:li>Click Edit</xhtml:li>
              <xhtml:li>Click Disable Root User</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to disable the root user:</xhtml:p>
            <xhtml:code class="code_block">
$ sudo dsenableroot -d              <br/>
              <br/>
username = root              <br/>
user password:
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Some legacy posix software might expect an available root account.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sce/osx_root.sh"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8_Disable_automatic_login" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Disable automatic login</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The automatic login feature saves a user's system access credentials and bypasses the login screen, instead the system automatically loads to the user's desktop screen.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Disabling automatic login decreases the likelihood of an unauthorized person gaining access to a system.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to set automatic login to off:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Users &amp; Groups</xhtml:li>
              <xhtml:li>Click the lock to authenticate</xhtml:li>
              <xhtml:li>Select Login Options</xhtml:li>
              <xhtml:li>Select Automatic login and set it to Off</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to disable automatic login:</xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults delete /Library/Preferences/com.apple.loginwindow autoLoginUser
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>If Automatic login is not disabled an unauthorized user could login without supplying a user password or credential.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_disable_automatic_login.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9_Require_a_password_to_wake_the_computer_from_sleep_or_screen_saver" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Require a password to wake the computer from sleep or screen saver</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Sleep and screensaver modes are low power modes that reduces electrical consumption while the system is not in use.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>This only protects the system when the screen saver is running.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Prompting for a password when waking from sleep or screensaver mode mitigates the threat of an unauthorized person gaining access to a system in the user's absence.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following enable a password for unlock after a screen saver begins:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Security &amp; Privacy</xhtml:li>
              <xhtml:li>Select General</xhtml:li>
              <xhtml:li>Set Require password after or screensaver begins with a time of ≤5 minutes (immediately or 5 seconds is recommended)</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 The command line check in previous versions of the Benchmark does not work as expected here. The use of a profile is recommended for both implementation and auditing on a 10.13 system.            </xhtml:p>
            <xhtml:p>
Issue
              <xhtml:a href="https://blog.kolide.com/screensaver-security-on-macos-10-13-is-broken-a385726e2ae2">https://blog.kolide.com/screensaver-security-on-macos-10-13-is-broken-a385726e2ae2</xhtml:a>
            </xhtml:p>
            <xhtml:p>
Profile to control screensaver
              <xhtml:a href="https://github.com/rtrouton/profiles/blob/master/SetDefaultScreensaver/SetDefaultScreensaver.mobileconfig">https://github.com/rtrouton/profiles/blob/master/SetDefaultScreensaver/SetDefaultScreensaver.mobileconfig</xhtml:a>
            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Without a screenlock in place anyone with physical access to the computer would be logged in and able to use the active users session.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240489"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10_Ensure_system_is_set_to_hibernate" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Ensure system is set to hibernate</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>In order to use a computer with Full Disk Encryption (FDE) macOS must keep encryption keys in memory to allow the use of the disk that has been FileVault protected. The storage volume has been unlocked and acts as if it was not encrypted. When the system is not in use the volume is protected through encryption. When the system is sleeping and available to quickly resume the encryption keys remain in memory.</xhtml:p>
        <xhtml:p>If an unauthorized party has possession of the computer and the computer is only slept there are known attack vectors that can be attempted against the RAM that has the encryption keys or the running operating system that is protected by a login screen. Network attacks if network interfaces are on as well as USB or other open device ports are possible. Most of these attacks require knowledge of unpatched vulnerabilities or a high level of sophistication if all the other controls function as intended.</xhtml:p>
        <xhtml:p>There is little impact on hibernating the system rather than sleeping after an appropriate time period to remediate the risk of OS level attacks. Hibernation writes the keys to desk and requires FileVault to be unlocked prior to the OS being available. In the case of unauthorized personnel with access to the computer encryption would have to be broken prior to attacking the operating system in order to recover data from the system.</xhtml:p>
        <xhtml:p>
          <xhtml:a href="https://www.helpnetsecurity.com/2018/08/20/laptop-sleep-security/">https://www.helpnetsecurity.com/2018/08/20/laptop-sleep-security/</xhtml:a>
        </xhtml:p>
        <xhtml:p>Mac systems should be set to hibernate after sleeping for a risk acceptable time period. The default value for "standbydelay" is three hours (10800 seconds). This value is likely appropriate for most Desktops. If Mac desktops are deployed in unmonitored less physically secure areas with confidential data this value might be adjusted. The desktop or would have to retain power so that the running OS or physical RAM could be attacked however.</xhtml:p>
        <xhtml:p>MacBooks should be set so that the standbydelay is 15 minutes (900 seconds) or less. This setting should allow laptop users in most cases to stay within physically secured areas while going to a conference room, auditorium or other internal location without having to unlock the encryption. When the user goes home at night the laptop will auto-hibernate after 15 minutes and require the FileVault password to unlock prior to logging back into system when it resumes.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>There are several good references to the concerns about ensuring hibernation rather than sleep is in place. A selection below:</xhtml:p>
          <xhtml:p>
            <xhtml:a href="http://mattwashchuk.com/articles/2016/01/08/maximizing-filevault-security">http://mattwashchuk.com/articles/2016/01/08/maximizing-filevault-security</xhtml:a>
          </xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://www.zdziarski.com/blog/?p=6705">https://www.zdziarski.com/blog/?p=6705</xhtml:a>
          </xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://www.howtogeek.com/260478/how-to-choose-when-your-mac-hibernates-or-enters-standby/">https://www.howtogeek.com/260478/how-to-choose-when-your-mac-hibernates-or-enters-standby/</xhtml:a>
          </xhtml:p>
          <xhtml:p>
            <xhtml:a href="https://www.lifewire.com/change-mac-sleep-settings-2260804">https://www.lifewire.com/change-mac-sleep-settings-2260804</xhtml:a>
          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>To mitigate the risk of data loss the system should power down and lock the encrypted drive after a specified time. Laptops should hibernate 15 minutes or less after sleeping.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to set the hibernate delay:</xhtml:p>
            <xhtml:code class="code_block">$ sudo pmset -a standbydelay 900 
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The laptop will take additional time to resume normal operation then if only sleeping rather than hibernating</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_standbydelay_1013_earlier.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.11_Require_an_administrator_password_to_access_system-wide_preferences" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Require an administrator password to access system-wide preferences</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>System Preferences controls system and user settings on a macOS Computer. System Preferences allows the user to tailor their experience on the computer as well as allowing the System Administrator to configure global security settings. Some of the settings should only be altered by the person responsible for the computer.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>By requiring a password to unlock System-wide System Preferences the risk is mitigated of a user changing configurations that affect the entire system and requires an admin user to re-authenticate to make changes</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to verify that an administrator password is required to access system-wide preferences:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Security &amp; Privacy</xhtml:li>
              <xhtml:li>Select General</xhtml:li>
              <xhtml:li>Select Advanced...</xhtml:li>
              <xhtml:li>Set Require an administrator password to access system-wide preferences</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>The authorizationdb settings cannot be written to directly, so the plist must be exported out to temporary file. Changes can be made to the temporary plist, then imported back into the authorizationdb settings.</xhtml:p>
            <xhtml:p>Run the following commands to enable that an administrator password is required to access system-wide preferences:</xhtml:p>
            <xhtml:code class="code_block">
$ sudo security authorizationdb read system.preferences &gt; /tmp/system.preferences.plist              <br/>
              <br/>
YES (0)              <br/>
              <br/>
$ sudo defaults write /tmp/system.preferences.plist shared -bool false              <br/>
              <br/>
$ sudo security authorizationdb write system.preferences &lt; /tmp/system.preferences.plist              <br/>
              <br/>
YES (0)
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>If Automatic login is not disabled an unauthorized user could login without supplying a user password or credential.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_admin_password_required.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.12_Disable_ability_to_login_to_another_users_active_and_locked_session" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Disable ability to login to another user's active and locked session</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to disable a user logging into another user's active and/or locked session:</xhtml:p>
            <xhtml:code class="code_block">
$ sudo security authorizationdb write system.login.screensaver use-login-window-ui              <br/>
              <br/>
YES (0)
            </xhtml:code>
            <xhtml:p>References</xhtml:p>
            <xhtml:p>
              <xhtml:a href="https://derflounder.wordpress.com/2014/02/16/managing-the-authorization-database-in-os-x-mavericks/">https://derflounder.wordpress.com/2014/02/16/managing-the-authorization-database-in-os-x-mavericks/</xhtml:a>
            </xhtml:p>
            <xhtml:p>
              <xhtml:a href="https://www.jamf.com/jamf-nation/discussions/18195/system-login-screensaver">https://www.jamf.com/jamf-nation/discussions/18195/system-login-screensaver</xhtml:a>
            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>While Fast user switching is a workaround for some lab environments especially where there is even less of an expectation of privacy this setting change may impact some maintenance workflows</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240491"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.13_Create_a_custom_message_for_the_Login_Screen" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Create a custom message for the Login Screen</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>An access warning informs the user that the system is reserved for authorized use only, and that the use of the system may be monitored.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Run the following command to enable a custom login screen message:</xhtml:p>
            <xhtml:code class="code_block">
$ sudo defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText "&lt;custom.message&gt;"              <br/>
            </xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText "Center for Internet Security Test Message"
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>If users are not informed of their responsibilities there may be unapproved activity. Users that are not approved for access may take the lack of a warning banner as implied consent to access.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240492"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.14_Create_a_Login_window_banner" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Create a Login window banner</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
A Login window banner warning informs the user that the system is reserved for authorized use only. It enforces an acknowledgment by the user that they have been informed of the use policy in the banner if required. The system recognizes either the           <xhtml:span class="inline_block">.txt</xhtml:span>
 and the           <xhtml:span class="inline_block">.rtf</xhtml:span>
 formats.        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>An access warning may reduce a casual attacker's tendency to target the system. Access warnings may also aid in the prosecution of an attacker by evincing the attacker's knowledge of the system's private status, acceptable use policy, and authorization requirements.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>
Edit (or create) a               <xhtml:span class="inline_block">PolicyBanner.txt</xhtml:span>
 or               <xhtml:span class="inline_block">PolicyBanner.rtf</xhtml:span>
 file, in the               <xhtml:span class="inline_block">/Library/Security/</xhtml:span>
 folder, to include the required login window banner text.            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Users will have to click on the window with the Login text before logging into the computer</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_login_banner_window.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.15_Do_not_enter_a_password-related_hint" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Do not enter a password-related hint</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Password hints help the user recall their passwords for various systems and/or accounts. In most cases, password hints are simple and closely related to the user's password.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>Organizations might consider entering an organizational help desk phone number or other text (such as a warning to the user). A help desk number is only appropriate for organizations with trained help desk personnel that are validating user identities for password resets.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Password hints that are closely related to the user's password are a security vulnerability, especially in the social media age. Unauthorized users are more likely to guess a user's password if there is a password hint. The password hint is very susceptible to social engineering attacks and information exposure on social media networks</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to remove users' password hint:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Users &amp; Groups</xhtml:li>
              <xhtml:li>Select the Current User</xhtml:li>
              <xhtml:li>Select Change Password</xhtml:li>
              <xhtml:li>Change the password and ensure that no text is entered in the Password hint box</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to remove a user's password hint:</xhtml:p>
            <xhtml:code class="code_block">$ sudo dscl . -delete /Users/&lt;username&gt; hint
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">
$ sudo dscl . -delete /Users/firstuser hint              <br/>
              <br/>
$ sudo dscl . -delete /Users/seconduser hint
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_pwhint.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.16_Disable_Fast_User_Switching" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Disable Fast User Switching</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Fast user switching allows a person to quickly log in to the computer with a different account. While only a minimal security risk, when a second user is logged in, that user might be able to see what processes the first user is using, or possibly gain other information about the first user. In a large directory environment where it is difficult to limit login access many valid users can login to other user's assigned computers.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>macOS is a multi-user operating system, and there are other similar methods that might provide the same kind of risk. The Remote Login service that can be turned on in the Sharing System Preferences pane is another.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Fast user switching allows multiple users to run applications simultaneously at console. There can be information disclosed about processes running under a different user. Without a specific configuration to save data and log out users can have unsaved data running in a background session that is not obvious.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to disable fast user switching:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Users &amp; Groups</xhtml:li>
              <xhtml:li>Select Login Options</xhtml:li>
              <xhtml:li>Uncheck "Show fast user switching menu as..."</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to turn fast user switching off:</xhtml:p>
            <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/.GlobalPreferences MultipleSessionEnabled -bool false
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Where support staff visit users computers consoles they will not be able to log in to their own session if there is an active and locked session.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1247605"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.17_Secure_individual_keychains_and_items" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Secure individual keychains and items</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>By default, the keychain for an account, especially a local account, have the same password as the account's logon password. It is possible to change the passwords on keychains to something different than the login password, and doing so would keep that keychain locked until needed after login. This is especially important when a smartcard is being used for console login. Keychains need to be protected by more than a pin in order to be secured and the default behavior with a smartcard will result in a pin for the login password. Individual keychain entries can have special ACLs to increase security as well.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Each keychain entry can have different access controls. It's possible to set the keychain item to require a keychain password every time an item is accessed, even if the keychain is unlocked. This level of security could be useful for bank passwords or other passwords that need extra security.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:ol>
              <xhtml:li>
Open                 <xhtml:span class="inline_block">Utilities</xhtml:span>
              </xhtml:li>
              <xhtml:li>
Select                 <xhtml:span class="inline_block">Keychain Access</xhtml:span>
              </xhtml:li>
              <xhtml:li>Double-click keychain</xhtml:li>
              <xhtml:li>
Select                 <xhtml:span class="inline_block">Access</xhtml:span>
                <xhtml:span class="inline_block">Control</xhtml:span>
              </xhtml:li>
              <xhtml:li>Check box next to "Ask for Keychain Password"</xhtml:li>
            </xhtml:ol>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Having to enter the keychain password for each access could become inconvenient and/or tedious for users.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.18_Create_specialized_keychains_for_different_purposes" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Create specialized keychains for different purposes</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>The keychain is a secure database store for passwords and certificates and is created for each user account on macOS. The system software itself uses keychains for secure storage. Users can create more than one keychain to protect various passwords separately.</xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>One useful separation of keychains might be in a business environment. Personal information might be stored in one keychain and business information in a different keychain.</xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>If the user can logically split password and other entries into different keychains with different passwords, a compromise of one password will have limited effect.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:ol>
              <xhtml:li>
Open                 <xhtml:span class="inline_block">Utilities</xhtml:span>
              </xhtml:li>
              <xhtml:li>
Select                 <xhtml:span class="inline_block">Keychain Access</xhtml:span>
              </xhtml:li>
              <xhtml:li>
Select                 <xhtml:span class="inline_block">File</xhtml:span>
              </xhtml:li>
              <xhtml:li>
Select                 <xhtml:span class="inline_block">New Keychain</xhtml:span>
              </xhtml:li>
              <xhtml:li>
Input name of new keychain next to                 <xhtml:span class="inline_block">Save As</xhtml:span>
              </xhtml:li>
              <xhtml:li>
Select                 <xhtml:span class="inline_block">Create</xhtml:span>
              </xhtml:li>
              <xhtml:li>Drag and drop desired keychain items into new keychain from login keychain</xhtml:li>
            </xhtml:ol>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Using multiple keychains can be inconvenient. It is also not necessarily possible for all kinds of data, such as Safari auto-fill information, to be stored in secondary keychains. Not all keychain-aware applications may provide an interface to choose secondary keychains.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.19_System_Integrity_Protection_status" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">System Integrity Protection status</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>System Integrity Protection is a security feature introduced in OS X 10.11 El Capitan. System Integrity Protection restricts access to System domain locations and restricts runtime attachment to system processes. Any attempt to attempt to inspect or attach to a system process will fail. Kernel Extensions are now restricted to /Library/Extensions and are required to be signed with a Developer ID.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Running without System Integrity Protection on a production system runs the risk of the modification of system binaries or code injection of system processes that would otherwise be protected by SIP.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable System Integrity Protection:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Reboot into the Recovery Partition (reboot and hold down Command (⌘) + R)</xhtml:li>
              <xhtml:li>Select Utilities</xhtml:li>
              <xhtml:li>Select Terminal</xhtml:li>
              <xhtml:li>Run the following command:</xhtml:li>
            </xhtml:ol>
            <xhtml:code class="code_block">
$ sudo /usr/bin/csrutil enable              <br/>
              <br/>
Successfully enabled System Integrity Protection. Please restart the machine for the changes to take effect.
            </xhtml:code>
            <xhtml:ol start="5">
              <xhtml:li>Reboot the computer</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:strong>Note:</xhtml:strong>
 You cannot enable System Integrity Protection from the booted operating system. If the remediation is attempted in the booted OS and not the Recovery Partition the output will give the error               <xhtml:span class="inline_block">csrutil: failed to modify system integrity configuration. This tool needs to be executed from the Recovery OS.</xhtml:span>
            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>System binaries and processes could become compromised</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://open-scap.org/page/SCE">
          <check-import import-name="stdout"/>
          <check-content-ref href="sce/osx_sip.sh"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_User_Accounts_and_Environment">
    <xccdf:title xml:lang="en">User Accounts and Environment</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>Account management is a central part of security for any computer system including macOS. General practices should be followed to ensure that all accounts on a system are still needed and that default accounts have been removed. Users with admin roles should have distinct accounts for Admin functions as well as day to day work where the passwords are different and known only by the user assigned to the account. Accounts with Elevated privileges should not be easily discerned from the account name from standard accounts.</xhtml:p>
      <xhtml:p>When any computer system is added to a Directory System there are additional controls available including user account management that are not available in a standalone computer. One of the drawbacks is the local computer is no longer in control of the accounts that can access or manage it if given permission. For macOS if the computer is connected to a Directory any standard user can now login to the computer at console which by default may be desirable or not depending on the use case. If an admin group is allowed to administer the local computer the membership of that group is controlled completely in the Directory.</xhtml:p>
      <xhtml:p>macOS computers connected to a Directory should be configured so that the risk is appropriate for the mission use of the computer. Only those accounts that require local authentication should be allowed, only required administrator accounts should be in the local administrator group. Authenticated Users for console access and Domain Admins for Administration may be too broad or too limited</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6.1_Accounts_Preferences_Action_Items">
      <xccdf:title xml:lang="en">Accounts Preferences Action Items</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Proper account management is critical to computer security. Many options and settings in the Account System Preference Pane can be used to increase the security of the Mac.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.1_Display_login_window_as_name_and_password" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Display login window as name and password</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The login window prompts a user for his/her credentials, verifies their authorization level and then allows or denies the user access to the system.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Prompting the user to enter both their username and password makes it twice as hard for unauthorized users to gain access to the system since they must discover two attributes.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to ensure the login window display name and password:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Users and Groups</xhtml:li>
                <xhtml:li>Select Login Options</xhtml:li>
                <xhtml:li>Set Name and Password</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to enable the login window to display name and password:</xhtml:p>
              <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.loginwindow SHOWFULLNAME -bool true
</xhtml:code>
              <xhtml:p>
                <xhtml:strong>Note:</xhtml:strong>
 The GUI will not display the updated setting until the current user(s) logs out              </xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240494"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.2_Disable_Show_password_hints" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable "Show password hints"</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Password hints are user created text displayed when an incorrect password is used for an account.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Password hints make it easier for unauthorized persons to gain access to systems by providing information to anyone that the user provided to assist remembering the password. This info could include the password itself or other information that might be readily discerned with basic knowledge of the end user.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the to disable password hints from being shown:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Users &amp; Groups</xhtml:li>
                <xhtml:li>Select Login Options</xhtml:li>
                <xhtml:li>Uncheck Show password hints</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable password hints:</xhtml:p>
              <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.loginwindow RetriesUntilHint -int 0
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The user can set the hint to any value including the password itself or clues that allow trivial social engineering attacks.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240495"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.3_Disable_guest_account_login" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable guest account login</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The guest account allows users access to the system without having to create an account or password. Guest users are unable to make setting changes, cannot remotely login to the system and all created files, caches, and passwords are deleted upon logging out.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <notes:notes xml:lang="en">
            <xhtml:p>By default, the guest account is enabled for access to sharing services, but is not allowed to log in to the computer.</xhtml:p>
            <xhtml:p>The guest account does not need a password when it is enabled to log in to the computer.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling the guest account mitigates the risk of an untrusted user doing basic reconnaissance and possibly using privilege escalation attacks to take control of the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to disable guest account availability:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Users &amp; Groups</xhtml:li>
                <xhtml:li>Select Guest User</xhtml:li>
                <xhtml:li>Uncheck Allow guests to log in to this computer</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following command to disable the guest account:</xhtml:p>
              <xhtml:code class="code_block">$ sudo defaults write /Library/Preferences/com.apple.loginwindow GuestEnabled -bool false
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>A guest user can use that access to find out additional information about the system and might be able to use privilege escalation vulnerabilities to establish greater access.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240496"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.4_Disable_Allow_guests_to_connect_to_shared_folders" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Disable "Allow guests to connect to shared folders"</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Not allowing guests to connect to shared folders mitigates the risk of an untrusted user doing basic reconnaissance and possibly use privilege escalation attacks to take control of the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Perform the following to no longer allow guest user access to shared folders:</xhtml:p>
              <xhtml:p>
                <xhtml:em>Graphical Method:</xhtml:em>
              </xhtml:p>
              <xhtml:ol>
                <xhtml:li>Open System Preferences</xhtml:li>
                <xhtml:li>Select Users &amp; Groups</xhtml:li>
                <xhtml:li>Select Guest User</xhtml:li>
                <xhtml:li>Uncheck Allow guests to connect to shared folders</xhtml:li>
              </xhtml:ol>
              <xhtml:p>
                <xhtml:em>Terminal Method:</xhtml:em>
              </xhtml:p>
              <xhtml:p>Run the following commands to verify that shared folders are not accessible to guest users:</xhtml:p>
              <xhtml:code class="code_block">
$ sudo defaults write /Library/Preferences/com.apple.AppleFileServer guestAccess -bool false                <br/>
                <br/>
$ sudo defaults write /Library/Preferences/SystemConfiguration/com.apple.smb.server AllowGuestAccess -bool false
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Unauthorized users could access shared files on the system.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240497"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240498"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1.5_Remove_Guest_home_folder" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Remove Guest home folder</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>In the previous two controls the guest account login has been disabled and sharing to guests has been disabled as well. There is no need for the legacy Guest home folder to remain in the file system. When normal user accounts are removed you have the option to archive it, leave it in place or delete. In the case of the guest folder the folder remains in place without a GUI option to remove it. If at some point in the future a Guest account is needed it will be re-created. The presence of the Guest home folder can cause automated audits to fail when looking for compliant settings within all User folders as well. Rather than ignoring the folders continued existence it is best removed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The Guest home folders are unneeded after the Guest account is disabled and could be used inappropriately.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command to remove the Guest user home folder:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>Run the following command in Terminal:</xhtml:li>
              </xhtml:ol>
              <xhtml:code class="code_block">$ sudo rm -R /Users/Guest 
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The Guest account should not be necessary after it is disabled and it will be automatically re-created if the Guest account is re-enabled</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-content-ref href="sce/osx_guest_home_folder.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_Turn_on_filename_extensions" role="full" selected="false" weight="1.0">
      <xccdf:title xml:lang="en">Turn on filename extensions</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>A filename extension is a suffix added to a base filename that indicates the base filename's file format.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Visible filename extensions allows the user to identify the file type and the application it is associated with which leads to quick identification of misrepresented malicious files.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to ensure file extensions are shown:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open Finder</xhtml:li>
              <xhtml:li>Select Finder in the Menu Bar</xhtml:li>
              <xhtml:li>Select Preferences</xhtml:li>
              <xhtml:li>Select Advanced</xhtml:li>
              <xhtml:li>Set Show all filename extensions</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to enable displaying of file extensions:</xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write /Users/&lt;username&gt;/Library/Preferences/.GlobalPreferences.plist AppleShowAllExtensions -bool true
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u seconduser defaults write /Users/secondname/Library/Preferences/.GlobalPreferences.plist AppleShowAllExtensions -bool true
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The user of the system can open files of unknown or unexpected filetypes if the extension is not visible.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1246154"/>
      </check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.3_Disable_the_automatic_run_of_safe_files_in_Safari" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Disable the automatic run of safe files in Safari</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Safari will automatically run or execute what it considers safe files. This can include installers and other files that execute on the operating system. Safari bases file safety by using a list of filetypes maintained by Apple. The list of files include text, image, video and archive formats that would be run in the context of the OS rather than the browser.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Hackers have taken advantage of this setting via drive-by attacks. These attacks occur when a user visits a legitimate website that has been corrupted. The user unknowingly downloads a malicious file either by closing an infected pop-up or hovering over a malicious banner. An attacker can create a malicious file that will fall within Safari's safe file list that will download and execute without user input.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to set safe files to not open after downloading in Safari:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open Safari</xhtml:li>
              <xhtml:li>Select Safari from the menu bar</xhtml:li>
              <xhtml:li>Select Preferences</xhtml:li>
              <xhtml:li>Select General</xhtml:li>
              <xhtml:li>Uncheck Open "safe" files after downloading</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to disable safe files from not opening in Safari:</xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads -bool false
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u firstuser defaults write /Users/firstuser/Library/Preferences/com.apple.Safari AutoOpenSafeDownloads -bool false
</xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Apple considers many files that the operating system itself auto-executes as "safe files." Many of these files could be malicious and could execute locally without the user even knowing that a file of a specific type had been download.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.4_Use_parental_controls_for_systems_that_are_not_centrally_managed" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Use parental controls for systems that are not centrally managed</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Many aspects and features of macOS can be restricted on a user-by-user basis via the Parental Controls feature. This includes computer usage time limits, application accessibility limitations, and website restrictions. Although this feature is called Parental Controls, these restrictions may be appropriate for corporate, government, or educational use.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Limiting usage and restricting features for managed users reduces the risk of the user and/or system being exposed to malicious and/or inappropriate content.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to enable parental controls:</xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select Users &amp; Groups</xhtml:li>
              <xhtml:li>Select the managed user</xhtml:li>
              <xhtml:li>Set Enable parental controls</xhtml:li>
              <xhtml:li>Select Open Parental Controls</xhtml:li>
              <xhtml:li>Set the required restricted items</xhtml:li>
            </xhtml:ol>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>The extensive use of parental controls adds to the configuration management burden and can limit legitimate user activity.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_Appendix_Additional_Considerations">
    <xccdf:title xml:lang="en">Appendix: Additional Considerations</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section is for guidance on topics for which the Benchmark does not include a prescribed state, and for security controls that were previously represented in macOS security guides.</xhtml:p>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_Wireless_technology_on_macOS" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Wireless technology on macOS</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Some organizations have comprehensive rules that cover the use of wireless technologies in order to implement operational security. There are specific policies governing the use of both Bluetooth and Wi-Fi (802.11) that often include disabling the wireless capability in either software or hardware or both.</xhtml:p>
        <xhtml:p>Wireless access is part of the feature set required for mobile computers and is considered essential for most users. The general use case for macOS is to use wireless connectivity, Apple provides a wireless network card and Bluetooth capability in almost every product they make. Bluetooth keyboards are now the default selection where a keyboard is not already integrated into the device.</xhtml:p>
        <xhtml:p>There are instructions on  how to remove parts of the operating system in order to remediate wireless connectivity but they are not recommended within the scope of this Benchmark.</xhtml:p>
        <xhtml:p>https://apple.stackexchange.com/questions/99686/how-to-easily-and-completely-disable-enable-wlan-so-it-cannot-be-turned-on-agai</xhtml:p>
        <xhtml:p>https://apple.stackexchange.com/questions/123326/disable-bluetooth-permanently</xhtml:p>
        <xhtml:p>macOS computers will not allow this if System Integrity Protection is enabled.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/15" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_iSight_Camera_Privacy_and_Confidentiality_Concerns" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">iSight Camera Privacy and Confidentiality Concerns</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>If the computer is present in an area where there are privacy concerns or sensitive images or actions are taking place the camera should be covered at those times. A permanent cover or alteration may be required when the computer is always located in a confidential area.</xhtml:p>
        <xhtml:p>Malware is continuously discovered that circumvents the privacy controls of the built-in camera. No computer has perfect security and it seems likely that even if all the drivers are disabled or removed that working drivers can be re-introduced by a determined attacker.</xhtml:p>
        <xhtml:p>At this point video chatting and other uses of the built-in camera are standard uses for a computer. It is contrary to a standard use case to permanently remove the camera. In cases where the camera is not allowed to be used at all or when the computer is located in private areas additional precautions are warranted. The General rule should be that if the camera can capture images that could cause embarrassment or an adverse impact the camera should be covered until it is appropriate to use.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_Computer_Name_Considerations" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Computer Name Considerations</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>If the computer is used in an organization that assigns host names, it is a good idea to change the computer name to the host name. This is more of a best practice than a security measure. If the host name and the computer name are the same, computer support may be able to track problems down more easily.</xhtml:p>
        <xhtml:p>With mobile devices using DHCP IP tracking has serious drawbacks, hostname or computer name tracking makes much more sense for those organizations that can implement it. If the computer is using different names for the "Computer Name" DNS and Directory environments it can be difficult to manage Macs in an Enterprise asset inventory.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.4_Software_Inventory_Considerations" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Software Inventory Considerations</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>With the introduction of Mac OS X 10.6.6, Apple added a new application, App Store, which resides in the Applications directory. This application allows a user with admin privileges and an Apple ID to browse Apple's online App Store, purchase (including no cost purchases), and install new applications, bypassing Enterprise software inventory controls. Any admin user can install software in the /Applications directory whether from internet downloads, thumb drives, optical media, cloud storage or even binaries through email. Even standard users can run executables if permitted. The source of the software is not nearly as important as a consistent audit of all installed software for patch compliance and appropriateness.</xhtml:p>
        <xhtml:p>A single user desktop where the user, administrator and the person approving software are all the same person probably does not need to audit software inventory to this extent. It is helpful in the case of stability problems or malware however.</xhtml:p>
        <xhtml:p>Scan systems on a monthly basis and determine the number of unauthorized pieces of software that are installed. Verify that if an unauthorized piece of software is found one month, it is removed from the system the next.</xhtml:p>
        <xhtml:p>Export System Information through the built-in System Information Application or other third-party tools on an organizationally defined timetable.</xhtml:p>
        <xhtml:p>Perform the following to access System Information through the GUI or the command line.</xhtml:p>
        <xhtml:p>
          <xhtml:em>Graphical Mode:</xhtml:em>
        </xhtml:p>
        <xhtml:ol>
          <xhtml:li>Select the Apple icon</xhtml:li>
          <xhtml:li>Select About this Mac</xhtml:li>
          <xhtml:li>Select System Report</xhtml:li>
          <xhtml:li>Select File</xhtml:li>
          <xhtml:li>Select Save</xhtml:li>
          <xhtml:li>Choose the name of the file and location to save the file to</xhtml:li>
        </xhtml:ol>
        <xhtml:p>
          <xhtml:em>Terminal Method:</xhtml:em>
        </xhtml:p>
        <xhtml:p>Run the following command to view all System Profiler details</xhtml:p>
        <xhtml:code class="code_block">$ sudo system_profiler
</xhtml:code>
        <xhtml:p>To find more detailed instructions on the use of the system_profiler command, run the following:</xhtml:p>
        <xhtml:code class="code_block">man system_profiler
</xhtml:code>
        <xhtml:p>
          <xhtml:a href="https://support.apple.com/en-us/HT203001">About System Information on your Mac</xhtml:a>
        </xhtml:p>
      </xccdf:description>
      <xccdf:metadata>
        <notes:notes xml:lang="en">
          <xhtml:p>
            <xhtml:a href="https://www.cisecurity.org/controls/inventory-and-control-of-software-assets/">Inventory and Control of Software Assets</xhtml:a>
          </xhtml:p>
        </notes:notes>
      </xccdf:metadata>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.5_Firewall_Consideration" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Firewall Consideration</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
In addition to the Application Layer Firewall (          <xhtml:span class="inline_block">alf</xhtml:span>
) mentioned in the benchmark, macOS also ships with packet filter, or           <xhtml:span class="inline_block">pf</xhtml:span>
. Leveraging           <xhtml:span class="inline_block">pf</xhtml:span>
 is beyond the scope of this Benchmark. For more information, please see:        </xhtml:p>
        <xhtml:ul>
          <xhtml:li>https://support.apple.com/kb/ht5519</xhtml:li>
          <xhtml:li>http://blog.scottlowe.org/2013/05/15/using-pf-on-os-x-mountain-lion/</xhtml:li>
        </xhtml:ul>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.6_Automatic_Actions_for_Optical_Media" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Automatic Actions for Optical Media</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Managing automatic actions, while useful in very few situations, is unlikely to increase security on the computer and does complicate the users experience and add additional complexity to the configuration. These settings are user controlled and can be changed without Administrator privileges unless controlled through MCX settings or Parental Controls. Unlike Windows Auto-run the optical media is accessed through Operating System applications, those same applications can open and access the media directly. If optical media is not allowed in the environment the optical media drive should be disabled in hardware and software</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>Setting automatic actions for optical media can mitigate malicious code from running automatically when optical media is inserted.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to set the optical media action setting:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open System Preferences</xhtml:li>
              <xhtml:li>Select CDs &amp; DVDs</xhtml:li>
              <xhtml:li>Set each option to meet your organizations requirements</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following command to set the optical media action:</xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write /Users/&lt;username&gt;/Library/Preferences/com.apple.digihub &lt;what type of media&gt; -dict action &lt;preferred action&gt;
</xhtml:code>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">$ sudo -u seconduser defaults write /Users/seconduser/Library/Preferences/com.apple.digihub com.apple.digihub.blank.dvd.appeared -dict action 1
</xhtml:code>
            <xhtml:p>
The five media types are               <xhtml:span class="inline_block">com.apple.digihub.blank.cd.appeared</xhtml:span>
(blank cd),               <xhtml:span class="inline_block">com.apple.digihub.blank.dvd.appeared</xhtml:span>
 (blank dvd),               <xhtml:span class="inline_block">com.apple.digihub.cd.music.appeared</xhtml:span>
 (music cd),               <xhtml:span class="inline_block">com.apple.digihub.cd.picture.appeared</xhtml:span>
 (picture cd), and               <xhtml:span class="inline_block">com.apple.digihub.dvd.video.appeared</xhtml:span>
 (DVD movie).            </xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240500"/>
        </check>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240501"/>
          </check>
          <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240502"/>
            </check>
            <xccdf:complex-check operator="AND">
              <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240503"/>
              </check>
              <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1240504"/>
              </check>
            </xccdf:complex-check>
          </xccdf:complex-check>
        </xccdf:complex-check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.7_App_Store_Automatically_download_apps_purchased_on_other_Macs_Considerations" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">App Store Automatically download apps purchased on other Macs Considerations</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>With 10.9 Apple expanded the capability of the App Store to automatically download macOS applications that were purchased in the App Store on another Mac. This feature can be very desirable for personal Macs or in a small business setting so that all purchased software through Apple's App Store is provisioned on all macOS Computers, just like iOS. This feature may not be desirable in Enterprise environments where the expectations of handling software licenses, tracking software inventory and personal software are different.</xhtml:p>
        <xhtml:p>Please evaluate your organizations expectations about the use of personal software and software license tracking to align with this setting.</xhtml:p>
        <xhtml:p>For those organizations that are using Enterprise Apple IDs for their employees the reverse is true. If the user has the username and password for their Apple ID and software is being purchased on that account the user could download the software on other computers they have access to.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.8_Extensible_Firmware_Interface_EFI_password" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Extensible Firmware Interface (EFI) password</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>EFI is the software link between the motherboard hardware and the software operating system. EFI determines which partition or disk to load macOS from, it also determines whether the user can enter single-user mode. The main reasons to set a firmware password have been protections against an alternative boot disk, protection against a passwordless root shell through single user mode and protection against firewire DMA attacks. In the past it was not difficult to reset the firmware password by removing RAM but it did make tampering slightly harder and having to remove RAM remediated memory scraping attacks through DMA. It has always been difficult to Manage the firmware password on macOS computers, though some tools did make it much easier.</xhtml:p>
        <xhtml:p>Apple patched OS X in 10.7 to mitigate the DMA attacks and the use of FileVault 2 Full-Disk Encryption mitigates the risk of damage to the boot volume if an unauthorized user uses a different boot volume or uses Single User Mode. Apple's reliance on the recovery partition and the additional features it provides make controls that do not allow the user to boot into the recovery partition less attractive.</xhtml:p>
        <xhtml:p>Starting in Late 2010 with the MacBook Air Apple has slowly updated the requirements to recover from a lost firmware password. Apple only supports taking the computer to an Apple authorized service provider. This change makes managing the firmware password effectively more critical if it is used.</xhtml:p>
        <xhtml:p>Setting the firmware password may be good practice in some environments. We cannot recommend it as a standard security practice at this time.</xhtml:p>
        <xhtml:p>http://support.apple.com/kb/ts3554</xhtml:p>
        <xhtml:p>https://jamfnation.jamfsoftware.com/article.html?id=58</xhtml:p>
        <xhtml:p>http://derflounder.wordpress.com/2012/02/05/protecting-yourself-against-firewire-dma-attacks-on-10-7-x/</xhtml:p>
        <xhtml:p>http://derflounder.wordpress.com/2013/04/26/booting-into-single-user-mode-on-a-filevault-2-encrypted-mac/</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.9_FileVault_and_Local_Account_Password_Reset_using_AppleID" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">FileVault and Local Account Password Reset using AppleID</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Apple has provided services for several years that allowed a user to reset a local account password on a computer using their Apple ID and a service to store the FileVault Master Password with Apple that would be controlled by access to an Apple ID. These distinct services have been more cleanly integrated starting in 10.12.</xhtml:p>
        <xhtml:p>This integrated service for password and decryption is a concern in Enterprise environments. Normal Enterprise management controls mitigate the risk of external control of organizational systems. The user of the system already has the ability to unlock the disk in order to log in and use it and some form of password recovery function is likely already in place for any approved accounts. In addition:</xhtml:p>
        <xhtml:ul>
          <xhtml:li>You cannot reset anything but a local account</xhtml:li>
          <xhtml:li>You need physical access to the computer on a network that can phone home to Apple</xhtml:li>
          <xhtml:li>Enterprise FileVault management precludes the use of Apple's personal encryption recovery tied to a User's Apple ID</xhtml:li>
          <xhtml:li>The current login keychain will have to be discarded unless the user remembers the old password</xhtml:li>
        </xhtml:ul>
        <xhtml:p>This service allows for organizational computer users to utilize AppleIDs for encryption key escrow and user account management. The use of Apple's services rather than Enterprise services may be considered inappropriate.</xhtml:p>
        <xhtml:p>
          <xhtml:a href="https://support.apple.com/en-us/HT204837">https://support.apple.com/en-us/HT204837</xhtml:a>
        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.10_Repairing_permissions_is_no_longer_needed" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Repairing permissions is no longer needed</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>With the introduction of System Integrity Protection (SIP) Apple has removed the necessity of repairing permissions. In earlier versions of the Operating System repair permissions checked the receipt files of installed software and ensured that the existing permissions in the file system matched what the receipts said it should. System integrity protection manages and blocks permission to certain directories continuously.</xhtml:p>
        <xhtml:p>
          <xhtml:a href="http://www.macissues.com/2015/10/02/about-os-x-10-11-el-capitan-and-permissions-fixes/">http://www.macissues.com/2015/10/02/about-os-x-10-11-el-capitan-and-permissions-fixes/</xhtml:a>
        </xhtml:p>
        <xhtml:p>
          <xhtml:a href="https://en.wikipedia.org/wiki/System_Integrity_Protection">https://en.wikipedia.org/wiki/System_Integrity_Protection</xhtml:a>
        </xhtml:p>
        <xhtml:p>
          <xhtml:a href="http://www.infoworld.com/article/2988096/mac-os-x/sorry-unix-fans-os-x-el-capitan-kills-root.html">http://www.infoworld.com/article/2988096/mac-os-x/sorry-unix-fans-os-x-el-capitan-kills-root.html</xhtml:a>
        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.11_App_Store_Password_Settings" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">App Store Password Settings</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>With OS X 10.11 Apple added settings for password storage for the App Store in macOS. These settings parallel the settings in iOS. As with iOS the choices are a requirement to provide a password after every purchase or to have a 15 minute grace period, and whether to require a password for free purchases. The response to this setting is stored in a cookie and processed by iCloud.</xhtml:p>
        <xhtml:p>There is plenty of risk information on the wisdom of this setting for parents with children buying games on iPhones and iPads. the most relevant information here is the likelihood that users that are not authorized to download software may have physical access to an unlocked computer where someone who is authorized recently made a purchase. If that is a concern a password should be required at all times for App Store access in the Password Settings controls</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.12_Siri_on_macOS" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Siri on macOS</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>With macOS 10.12 Sierra Apple has introduced Siri from iOS to macOS. While there are data spillage concerns with the use of data gathering personal assistant software, the risk here does not seem greater in sending queries to Apple through Siri than in sending search terms in a browser to Google or Microsoft. While it is possible that Siri will be used for local actions rather than Internet searches, Siri could, in theory, tell Apple about confidential Programs and Projects that should not be revealed. This appears be an edge use case.</xhtml:p>
        <xhtml:p>In cases where sensitive and protected data is processed and Siri could help a user navigate their machine and expose that information it should be disabled. Siri does need to phone home to Apple so it should not be available from air-gapped networks as part of its requirements.</xhtml:p>
        <xhtml:p>Most of the use case data published has shown that Siri is a tremendous time saver on iOS where multiple screens and menus need to be navigated through. Information like sports scores, weather, movie times and simple to-do items on existing calendars can be easily found with Siri. None of the standard use cases should be more risky than already approved activity. Where "normal" user activity is already limited Siri use should be controlled as well.</xhtml:p>
        <xhtml:p>
For information on Apple's privacy policy for Siri,           <xhtml:a href="https://support.apple.com/en-us/HT210657">click here</xhtml:a>
.        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>To enable or disable Siri:</xhtml:p>
            <xhtml:code class="code_block">
$ sudo -u &lt;username&gt; defaults write com.apple.assistant.support.plist 'Assistant Enabled' -int &lt;0,1&gt;              <br/>
$ sudo -u &lt;username&gt; defaults write com.apple.Siri.plist StatusMenuVisible -bool &lt;true/false&gt;              <br/>
$ sudo -u &lt;username&gt; defaults write com.apple.Siri UserHasDeclinedEnable -bool &lt;true/false. 
            </xhtml:code>
            <xhtml:p>The last command is recommended for updates to not ask the user to enable Siri if it has been disabled</xhtml:p>
            <xhtml:p>After running the default writes, the Windows Server needs to be restarted and the caches cleared</xhtml:p>
            <xhtml:code class="code_block">
$ sudo killall -HUP cfprefsd              <br/>
$ sudo killall SystemUIServer
            </xhtml:code>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1247604"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.13_Apple_Watch_features_with_macOS" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Apple Watch features with macOS</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>With the release of macOS 10.12 Apple introduced a feature where the owner of an Apple Watch can lock and unlock their screen simply by being within range of a 10.12 computer when both devices are using the same AppleID with iCloud active. The benefit of not leaving the computer unlocked while the user is out of sight and readying the computer to resume work when the user returns without having to type in a password or insert a smartcard does seem attractive to people who have the Apple Watch. It is a continuation of other features like hand-off and continuity for the multiple Apple products users who have grown to expect their devices to work together.</xhtml:p>
        <xhtml:p>For the screen unlock capability in particular it may not be attractive to organizations that are managing Apple devices and credentials. The capability allows a user to unlock their computer tied to an Enterprise account with a personal token that is not managed or controlled by the Enterprise. If the user loses their watch revoking the credential that can unlock the screen might be problematic.</xhtml:p>
        <xhtml:p>Unless Enterprise control of the watch as a token tied to a user identity can be achieved Apple Watches should not be used for screen unlocks. The risk of an auto-lock based on the user being out of proximity may still be acceptable if possible to do lock only.</xhtml:p>
        <xhtml:p>This functionality does require the computer to be logged in to iCloud. If iCloud is disabled the Apple watch lock and unlock will not be possible.</xhtml:p>
        <xhtml:p>A profile may be used to control unlock functionality.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.14_System_information_backup_to_remote_computers" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">System information backup to remote computers</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>It is best practice to ensure that local computers are not a single point of failure for logging and auditing records about activity on the computer itself. Whether end user activity or system process information a mechanism should be in place to transfer the logs to another system that is hardened to receive them. A hardened log host reduces the risk of failure or compromise, particularly with user end points. From an enterprise management standpoint those records should be reviewed to ensure that there is not a common exploitable vulnerability, system bug or even hardware issue that can affect other devices in the environment.</xhtml:p>
        <xhtml:p>With changes in Apple's logging methods in the last few years third party tools appear to be preferred to ensure logs and records are obtained appropriately. Aggressive retention likely requires more space than available on built-in SSDs even if offline Time Machine backups are large and pristine.</xhtml:p>
        <xhtml:p>Please ensure that solutions to capture and retain log and audit records are in place.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/10" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.15_Unified_logging" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Unified logging</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Starting with macOS 10.12 Apple introduced unified logging. This capability replaces the previous logging methodology with centralized system wide common controls. A full explanation of macOS logging behavior is beyond the scope of this Benchmark. These changes impact previous logging controls from macOS Benchmarks. At this point many of the syslog controls have been or are being removed since the old logging methods have been deprecated. Controls that still appear useful will be retained. Some legacy controls have been removed for this release.</xhtml:p>
        <xhtml:p>More info
https://developer.apple.com/documentation/os/logging
https://eclecticlight.co/2018/03/19/macos-unified-log-1-why-what-and-how/</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en"/>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p/>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.16_AirDrop_security_considerations" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">AirDrop security considerations</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>AirDrop is Apple's built-in on demand ad hoc file exchange system that is compatible with both macOS and iOS. It uses Bluetooth LE for discovery that limits connectivity to Mac or iOS users that are in close proximity. Depending on the setting it allows everyone or only Contacts to share files when they are nearby to each other.</xhtml:p>
        <xhtml:p>In many ways this technology is far superior to the alternatives. The file transfer is done over a TLS encrypted session, does not require any open ports that are required for file sharing, does not leave file copies on email servers or within cloud storage, and allows for the service to be mitigated so that only people already trusted and added to contacts can interact with you.</xhtml:p>
        <xhtml:p>Even with all of these positives some environments may wish to disable AirDrop. Organizations where Bluetooth and Wireless are not used will disable AirDrop by blocking its necessary interfaces. Organizations that have disabled USB and other pluggable storage mechanisms and have blocked all unmanaged cloud and transfer solutions for DLP may want to disable AirDrop as well.</xhtml:p>
        <xhtml:p>AirDrop should be used with Contacts only to limit attacks.</xhtml:p>
        <xhtml:p>More info
https://www.imore.com/how-apple-keeps-your-airdrop-files-private-and-secure
https://en.wikipedia.org/wiki/AirDrop</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>AirDrop can allow malicious files to be downloaded from unknown sources.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>Perform the following to set AirDrop to the prescribed setting:</xhtml:p>
            <xhtml:p>
              <xhtml:em>Graphical Method:</xhtml:em>
            </xhtml:p>
            <xhtml:ol>
              <xhtml:li>Open Finder</xhtml:li>
              <xhtml:li>Select Go</xhtml:li>
              <xhtml:li>Select AirDrop</xhtml:li>
              <xhtml:li>Set Allow me to be discovered by: to your organizations prescribed setting</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
              <xhtml:em>Terminal Method:</xhtml:em>
            </xhtml:p>
            <xhtml:p>Run the following commands to enabled or disabled AirDrop:</xhtml:p>
            <xhtml:code class="code_block">$ sudo -u &lt;username&gt; defaults write com.apple.NetworkBrowser DisableAirDrop -bool &lt;true/false&gt;
</xhtml:code>
            <xhtml:p>
The setting               <xhtml:span class="inline_block">true</xhtml:span>
 will disable AirDrop and the setting               <xhtml:span class="inline_block">false</xhtml:span>
 will enable it.            </xhtml:p>
            <xhtml:p>
              <xhtml:em>example</xhtml:em>
:            </xhtml:p>
            <xhtml:code class="code_block">
$ sudo -u firstuser defaults write com.apple.NetworkBrowser DisableAirDrop -bool false              <br/>
              <br/>
$ sudo -u seconduser defaults write com.apple.NetworkBrowser DisableAirDrop -bool true
            </xhtml:code>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Disabling AirDrop can limit the ability to move files quickly over the network without using file shares.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
      <xccdf:complex-check operator="AND">
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Apple_macOS_10.13_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.apple_mac_os_x_10:def:1246171"/>
        </check>
      </xccdf:complex-check>
    </xccdf:Rule>
  </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>ihYwHaQwpR83XhL+Ewoc6jdNkzk=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
AgeL6aYNN/ySHCI2AGl6izKj6Aj86cynvYwaF/pT6zJCr73kJDoqKtWijCmI54bufIty0yhpXLtP
YUTcrSgE5BYnGFXDBKlqI1BYTBynNx2EDf3wT5vyyCbX0DTaKRv2awLLFkxozYnWvdOKLEFtG+tT
sd05JbIArB7dd9W3BwOBrK80lnDzgUb+HLVu4YLphPMAlT8MDo5G9MW5wwb26o9/2Nn8eiDfJmdZ
6QIsHNrXqLpN+BYMAyGl+k/fgqbdiW/M6fmLtdN6V/2mvgjynFOgEb5bp9vgmwaV2YJTn+i/G82H
JVBOZbXj3ZvksM2JyKnWTGf1BQofiTydx+9RwA==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIPx+qZKptEY4wDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMjAw
OTA4MTMzOTM5WhcNMjMxMDI4MDAzMjA1WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS02LmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAT0XLw2vmuq6e58bkLDXdqKeGQjREDChLw2Mae9LI
JB93QgdA2OCLA1FwU2s7lawEDcma9wPiugxVGoaQNOfRw2/+cz0xmR3uaKQq6I24dWbHF20N2tSz
1RAAK1lRZKewA1fj+qqKWjzETA0LpqZlaFF+CKBpQcyfYyQRZxpHkB1vvKMf4kMIRKruvl4ixLjN
uAZrbQUWlXuq/MUkVP3FgdxWBPfmMGyngHs4hNMaSQGb1TEhBjj+PGoSunAyaOgO/P94XJPQQX3O
2oNDsPou6gKcNtbZrH+iYTJ8rcqQTontMwSP/HrYj8lgG3neG53vk05p0jCn2M5W0ukJ4LPEnA==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>